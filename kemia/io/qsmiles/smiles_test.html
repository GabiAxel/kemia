<!DOCTYPE html>
<!--TODO: License and copyright-->
<html>
<head>
<title>kemia unit test-smiles.js</title>
<script src="../../../third-party/closure/closure/goog/base.js"></script>
<script src="../../deps.js"></script>
<script>
	goog.require('goog.testing.jsunit');
	goog.require('kemia.io.mdl');
</script>
<script src="smiles.js"></script>
<script src="smiles_test_mols.js"></script>
<script src="CID_6540681.js"></script>
<script><!--
 	var rxn;
 	var mol;
  	function setUp() {
  	}

  	function testAtomCount() {
		var mol = kemia.io.smiles.parse('CCC');
		assertEquals(mol.countAtoms(), 3);
		mol = kemia.io.smiles.parse('C(=O)(c1c([NH2+])cccc1)c1c(C)cccc1');
		assertEquals(mol.countAtoms(), 16);
		var a = mol.getAtom(4);
		assertEquals(a.symbol, 'N');
		assertEquals(a.charge, 1);
		assertEquals(a.hydrogenCount(), 3);
	}

  	function testTimeParse() {
		for (var i in smiles) {
			kemia.io.smiles.parse(smiles[i]);
		}

	}
	
	function testCid6540681(){
		var smiles = "CC1C(C(C(C(O1)OCC2C(C(C(C(O2)OC3=C([O+]=C4C=C(C=C(C4=C3)OC5C(C(C(C(O5)CO)O)O)O)O)C6=CC(=C(C(=C6)OC)O)O)O)O)O)O)O)OC(=O)C=CC7=CC=C(C=C7)O";
        var mol1=kemia.io.smiles.parse(smiles);
        var rings1 = kemia.ring.RingFinder.findRings(mol1);
        var mol2 = kemia.io.mdl.readMolfile(cid_6540681);
        var rings2 = kemia.ring.RingFinder.findRings(mol2);
        assertEquals('should have same number of rings', rings1.length, rings2.length);
        assertEquals('should have same number of atoms', mol1.atoms.length, mol2.atoms.length);
        assertEquals('should have same number of bonds', mol1.bonds.length, mol2.bonds.length);
    }
--></script>
</head>
<body>
</body>
</html>
