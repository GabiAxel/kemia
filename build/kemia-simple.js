var a,COMPILED=true,goog=goog||{};goog.global=this;goog.DEBUG=true;goog.LOCALE="en";goog.evalWorksForGlobals_=null;goog.provide=function(d){if(!COMPILED){if(goog.getObjectByName(d)&&!goog.implicitNamespaces_[d])throw Error('Namespace "'+d+'" already declared.');for(var e=d;e=e.substring(0,e.lastIndexOf("."));)goog.implicitNamespaces_[e]=true}goog.exportPath_(d)};if(!COMPILED)goog.implicitNamespaces_={};
goog.exportPath_=function(d,e,f){d=d.split(".");f=f||goog.global;!(d[0]in f)&&f.execScript&&f.execScript("var "+d[0]);for(var g;d.length&&(g=d.shift());)if(!d.length&&goog.isDef(e))f[g]=e;else f=f[g]?f[g]:(f[g]={})};goog.getObjectByName=function(d,e){d=d.split(".");e=e||goog.global;for(var f;f=d.shift();)if(e[f])e=e[f];else return null;return e};goog.globalize=function(d,e){e=e||goog.global;for(var f in d)e[f]=d[f]};
goog.addDependency=function(d,e,f){if(!COMPILED){var g;d=d.replace(/\\/g,"/");for(var h=goog.dependencies_,j=0;g=e[j];j++){h.nameToPath[g]=d;d in h.pathToNames||(h.pathToNames[d]={});h.pathToNames[d][g]=true}for(g=0;e=f[g];g++){d in h.requires||(h.requires[d]={});h.requires[d][e]=true}}};
goog.require=function(d){if(!COMPILED)if(!goog.getObjectByName(d)){var e=goog.getPathFromDeps_(d);if(e){goog.included_[e]=true;goog.writeScripts_()}else{d="goog.require could not find: "+d;goog.global.console&&goog.global.console.error(d);throw Error(d);}}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(d){return d};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(d){d.getInstance=function(){return d.instance_||(d.instance_=new d)}};
if(!COMPILED){goog.included_={};goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}};goog.inHtmlDocument_=function(){var d=goog.global.document;return typeof d!="undefined"&&"write"in d};goog.findBasePath_=function(){if(goog.inHtmlDocument_()){var d=goog.global.document;if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else{d=d.getElementsByTagName("script");for(var e=d.length-1;e>=0;--e){var f=d[e].src,g=f.length;if(f.substr(g-7)=="base.js"){goog.basePath=
f.substr(0,g-7);return}}}}};goog.writeScriptTag_=function(d){if(goog.inHtmlDocument_()&&!goog.dependencies_.written[d]){goog.dependencies_.written[d]=true;goog.global.document.write('<script type="text/javascript" src="'+d+'"><\/script>')}};goog.writeScripts_=function(){function d(j){if(!(j in g.written)){if(!(j in g.visited)){g.visited[j]=true;if(j in g.requires)for(var l in g.requires[j])if(l in g.nameToPath)d(g.nameToPath[l]);else if(!goog.getObjectByName(l))throw Error("Undefined nameToPath for "+
l);}if(!(j in f)){f[j]=true;e.push(j)}}}var e=[],f={},g=goog.dependencies_;for(var h in goog.included_)g.written[h]||d(h);for(h=0;h<e.length;h++)if(e[h])goog.writeScriptTag_(goog.basePath+e[h]);else throw Error("Undefined script input");};goog.getPathFromDeps_=function(d){return d in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[d]:null};goog.findBasePath_();goog.global.CLOSURE_NO_DEPS||goog.writeScriptTag_(goog.basePath+"deps.js")}
goog.typeOf=function(d){var e=typeof d;if(e=="object")if(d){if(d instanceof Array||!(d instanceof Object)&&Object.prototype.toString.call(d)=="[object Array]"||typeof d.length=="number"&&typeof d.splice!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("splice"))return"array";if(!(d instanceof Object)&&(Object.prototype.toString.call(d)=="[object Function]"||typeof d.call!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("call")))return"function"}else return"null";
else if(e=="function"&&typeof d.call=="undefined")return"object";return e};goog.propertyIsEnumerableCustom_=function(d,e){if(e in d)for(var f in d)if(f==e&&Object.prototype.hasOwnProperty.call(d,e))return true;return false};goog.propertyIsEnumerable_=function(d,e){return d instanceof Object?Object.prototype.propertyIsEnumerable.call(d,e):goog.propertyIsEnumerableCustom_(d,e)};goog.isDef=function(d){return d!==undefined};goog.isNull=function(d){return d===null};
goog.isDefAndNotNull=function(d){return d!=null};goog.isArray=function(d){return goog.typeOf(d)=="array"};goog.isArrayLike=function(d){var e=goog.typeOf(d);return e=="array"||e=="object"&&typeof d.length=="number"};goog.isDateLike=function(d){return goog.isObject(d)&&typeof d.getFullYear=="function"};goog.isString=function(d){return typeof d=="string"};goog.isBoolean=function(d){return typeof d=="boolean"};goog.isNumber=function(d){return typeof d=="number"};
goog.isFunction=function(d){return goog.typeOf(d)=="function"};goog.isObject=function(d){d=goog.typeOf(d);return d=="object"||d=="array"||d=="function"};goog.getUid=function(d){if(d.hasOwnProperty&&d.hasOwnProperty(goog.UID_PROPERTY_))return d[goog.UID_PROPERTY_];d[goog.UID_PROPERTY_]||(d[goog.UID_PROPERTY_]=++goog.uidCounter_);return d[goog.UID_PROPERTY_]};goog.removeUid=function(d){"removeAttribute"in d&&d.removeAttribute(goog.UID_PROPERTY_);try{delete d[goog.UID_PROPERTY_]}catch(e){}};
goog.UID_PROPERTY_="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(d){var e=goog.typeOf(d);if(e=="object"||e=="array"){if(d.clone)return d.clone.call(d);e=e=="array"?[]:{};for(var f in d)e[f]=goog.cloneObject(d[f]);return e}return d};
goog.bind=function(d,e){var f=e||goog.global;if(arguments.length>2){var g=Array.prototype.slice.call(arguments,2);return function(){var h=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(h,g);return d.apply(f,h)}}else return function(){return d.apply(f,arguments)}};goog.partial=function(d){var e=Array.prototype.slice.call(arguments,1);return function(){var f=Array.prototype.slice.call(arguments);f.unshift.apply(f,e);return d.apply(this,f)}};
goog.mixin=function(d,e){for(var f in e)d[f]=e[f]};goog.now=Date.now||function(){return+new Date};
goog.globalEval=function(d){if(goog.global.execScript)goog.global.execScript(d,"JavaScript");else if(goog.global.eval){if(goog.evalWorksForGlobals_==null){goog.global.eval("var _et_ = 1;");if(typeof goog.global._et_!="undefined"){delete goog.global._et_;goog.evalWorksForGlobals_=true}else goog.evalWorksForGlobals_=false}if(goog.evalWorksForGlobals_)goog.global.eval(d);else{var e=goog.global.document,f=e.createElement("script");f.type="text/javascript";f.defer=false;f.appendChild(e.createTextNode(d));
e.body.appendChild(f);e.body.removeChild(f)}}else throw Error("goog.globalEval not available");};goog.typedef=true;goog.getCssName=function(d,e){d=d+(e?"-"+e:"");return goog.cssNameMapping_&&d in goog.cssNameMapping_?goog.cssNameMapping_[d]:d};goog.setCssNameMapping=function(d){goog.cssNameMapping_=d};goog.getMsg=function(d,e){e=e||{};for(var f in e)d=d.replace(new RegExp("\\{\\$"+f+"\\}","gi"),e[f]);return d};goog.exportSymbol=function(d,e,f){goog.exportPath_(d,e,f)};
goog.exportProperty=function(d,e,f){d[e]=f};goog.inherits=function(d,e){function f(){}f.prototype=e.prototype;d.superClass_=e.prototype;d.prototype=new f;d.prototype.constructor=d};
goog.base=function(d,e){var f=arguments.callee.caller;if(f.superClass_)return f.superClass_.constructor.apply(d,Array.prototype.slice.call(arguments,1));for(var g=Array.prototype.slice.call(arguments,2),h=false,j=d.constructor;j;j=j.superClass_&&j.superClass_.constructor)if(j.prototype[e]===f)h=true;else if(h)return j.prototype[e].apply(d,g);if(d[e]===f)return d.constructor.prototype[e].apply(d,g);else throw Error("goog.base called from a method of one name to a method of a different name");};var kemia={};kemia.query={};kemia.query.Query={};
(function(){kemia.query.IQuery=function(){throw Error("IQuery: Interface should never be constructed!");};kemia.query.IQueryAtom=function(){this.matches=function(){};this.getNeighbors=function(){}};kemia.query.IQueryBond=function(){this.matches=function(){}};kemia.query.IQueryCompiler={compile:function(){}};kemia.query.IMapper=function(){this.mapFirst=function(){};this.mapUnique=function(){};this.mapUniqueCallback=function(){}};kemia.query.Query=function(){this.atoms=[];this.bonds=[];this.isSSSRRequired=
false};kemia.query.Query.prototype.countAtoms=function(){return this.atoms.length};kemia.query.Query.prototype.indexOfAtom=function(d){return goog.array.indexOf(this.atoms,d)};kemia.query.Query.prototype.getAtom=function(d){return this.atoms[d]};kemia.query.Query.prototype.addAtom=function(d){this.atoms.push(d)};kemia.query.Query.prototype.addBond=function(d){d.source.neighbors.push(d.target);d.target.neighbors.push(d.source);this.bonds.push(d)};kemia.query.Query.prototype.findBond=function(d,e){for(var f=
0,g=this.bonds.length;f<g;f++){var h=this.bonds[f];if(d===h.source&&e===h.target||e===h.source&&d===h.target)return h}return null};kemia.query.QueryAtom=function(){this.symbols=[];this.valence=0;this.neighbors=[]};kemia.query.QueryAtom.prototype.matches=function(d){var e=true;if(this.symbols.length)if(goog.array.indexOf(this.symbols,d.symbol)===-1)e=false;d=this.valence<=d.countBonds();return e&&d};kemia.query.QueryAtom.prototype.getNeighbors=function(){return this.neighbors};kemia.query.QueryBond=
function(d,e){this.orders=[];this.source=d;this.target=e};kemia.query.QueryBond.prototype.matches=function(d){if(!this.orders.length)return true;if(goog.array.indexOf(this.orders,d.order)!==-1)return true;return false}})();goog.array={};goog.array.ArrayLike=goog.typedef;goog.array.peek=function(d){return d[d.length-1]};goog.array.ARRAY_PROTOTYPE_=Array.prototype;goog.array.indexOf=goog.array.ARRAY_PROTOTYPE_.indexOf?function(d,e,f){return goog.array.ARRAY_PROTOTYPE_.indexOf.call(d,e,f)}:function(d,e,f){f=f==null?0:f<0?Math.max(0,d.length+f):f;if(goog.isString(d)){if(!goog.isString(e)||e.length!=1)return-1;return d.indexOf(e,f)}for(f=f;f<d.length;f++)if(f in d&&d[f]===e)return f;return-1};
goog.array.lastIndexOf=goog.array.ARRAY_PROTOTYPE_.lastIndexOf?function(d,e,f){return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(d,e,f==null?d.length-1:f)}:function(d,e,f){f=f==null?d.length-1:f;if(f<0)f=Math.max(0,d.length+f);if(goog.isString(d)){if(!goog.isString(e)||e.length!=1)return-1;return d.lastIndexOf(e,f)}for(f=f;f>=0;f--)if(f in d&&d[f]===e)return f;return-1};
goog.array.forEach=goog.array.ARRAY_PROTOTYPE_.forEach?function(d,e,f){goog.array.ARRAY_PROTOTYPE_.forEach.call(d,e,f)}:function(d,e,f){for(var g=d.length,h=goog.isString(d)?d.split(""):d,j=0;j<g;j++)j in h&&e.call(f,h[j],j,d)};goog.array.forEachRight=function(d,e,f){var g=d.length,h=goog.isString(d)?d.split(""):d;for(g=g-1;g>=0;--g)g in h&&e.call(f,h[g],g,d)};
goog.array.filter=goog.array.ARRAY_PROTOTYPE_.filter?function(d,e,f){return goog.array.ARRAY_PROTOTYPE_.filter.call(d,e,f)}:function(d,e,f){for(var g=d.length,h=[],j=0,l=goog.isString(d)?d.split(""):d,q=0;q<g;q++)if(q in l){var x=l[q];if(e.call(f,x,q,d))h[j++]=x}return h};
goog.array.map=goog.array.ARRAY_PROTOTYPE_.map?function(d,e,f){return goog.array.ARRAY_PROTOTYPE_.map.call(d,e,f)}:function(d,e,f){for(var g=d.length,h=new Array(g),j=goog.isString(d)?d.split(""):d,l=0;l<g;l++)if(l in j)h[l]=e.call(f,j[l],l,d);return h};goog.array.reduce=function(d,e,f,g){if(d.reduce)return g?d.reduce(goog.bind(e,g),f):d.reduce(e,f);var h=f;goog.array.forEach(d,function(j,l){h=e.call(g,h,j,l,d)});return h};
goog.array.reduceRight=function(d,e,f,g){if(d.reduceRight)return g?d.reduceRight(goog.bind(e,g),f):d.reduceRight(e,f);var h=f;goog.array.forEachRight(d,function(j,l){h=e.call(g,h,j,l,d)});return h};goog.array.some=goog.array.ARRAY_PROTOTYPE_.some?function(d,e,f){return goog.array.ARRAY_PROTOTYPE_.some.call(d,e,f)}:function(d,e,f){for(var g=d.length,h=goog.isString(d)?d.split(""):d,j=0;j<g;j++)if(j in h&&e.call(f,h[j],j,d))return true;return false};
goog.array.every=goog.array.ARRAY_PROTOTYPE_.every?function(d,e,f){return goog.array.ARRAY_PROTOTYPE_.every.call(d,e,f)}:function(d,e,f){for(var g=d.length,h=goog.isString(d)?d.split(""):d,j=0;j<g;j++)if(j in h&&!e.call(f,h[j],j,d))return false;return true};goog.array.find=function(d,e,f){e=goog.array.findIndex(d,e,f);return e<0?null:goog.isString(d)?d.charAt(e):d[e]};
goog.array.findIndex=function(d,e,f){for(var g=d.length,h=goog.isString(d)?d.split(""):d,j=0;j<g;j++)if(j in h&&e.call(f,h[j],j,d))return j;return-1};goog.array.findRight=function(d,e,f){e=goog.array.findIndexRight(d,e,f);return e<0?null:goog.isString(d)?d.charAt(e):d[e]};goog.array.findIndexRight=function(d,e,f){var g=d.length,h=goog.isString(d)?d.split(""):d;for(g=g-1;g>=0;g--)if(g in h&&e.call(f,h[g],g,d))return g;return-1};goog.array.contains=function(d,e){return goog.array.indexOf(d,e)>=0};
goog.array.isEmpty=function(d){return d.length==0};goog.array.clear=function(d){if(!goog.isArray(d))for(var e=d.length-1;e>=0;e--)delete d[e];d.length=0};goog.array.insert=function(d,e){goog.array.contains(d,e)||d.push(e)};goog.array.insertAt=function(d,e,f){goog.array.splice(d,f,0,e)};goog.array.insertArrayAt=function(d,e,f){goog.partial(goog.array.splice,d,f,0).apply(null,e)};
goog.array.insertBefore=function(d,e,f){var g;arguments.length==2||(g=goog.array.indexOf(d,f))<0?d.push(e):goog.array.insertAt(d,e,g)};goog.array.remove=function(d,e){e=goog.array.indexOf(d,e);var f;if(f=e>=0)goog.array.removeAt(d,e);return f};goog.array.removeAt=function(d,e){return goog.array.ARRAY_PROTOTYPE_.splice.call(d,e,1).length==1};goog.array.removeIf=function(d,e,f){e=goog.array.findIndex(d,e,f);if(e>=0){goog.array.removeAt(d,e);return true}return false};
goog.array.concat=function(){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.clone=function(d){if(goog.isArray(d))return goog.array.concat(d);else{for(var e=[],f=0,g=d.length;f<g;f++)e[f]=d[f];return e}};goog.array.toArray=function(d){if(goog.isArray(d))return goog.array.concat(d);return goog.array.clone(d)};
goog.array.extend=function(d){for(var e=1;e<arguments.length;e++){var f=arguments[e],g;if(goog.isArray(f)||(g=goog.isArrayLike(f))&&f.hasOwnProperty("callee"))d.push.apply(d,f);else if(g)for(var h=d.length,j=f.length,l=0;l<j;l++)d[h+l]=f[l];else d.push(f)}};goog.array.splice=function(d){return goog.array.ARRAY_PROTOTYPE_.splice.apply(d,goog.array.slice(arguments,1))};
goog.array.slice=function(d,e,f){return arguments.length<=2?goog.array.ARRAY_PROTOTYPE_.slice.call(d,e):goog.array.ARRAY_PROTOTYPE_.slice.call(d,e,f)};goog.array.removeDuplicates=function(d,e){e=e||d;for(var f={},g=0,h=0;h<d.length;){var j=d[h++],l=goog.isObject(j)?goog.getUid(j):j;if(!Object.prototype.hasOwnProperty.call(f,l)){f[l]=true;e[g++]=j}}e.length=g};goog.array.binarySearch=function(d,e,f){return goog.array.binarySelect(d,goog.partial(f||goog.array.defaultCompare,e))};
goog.array.binarySelect=function(d,e,f){for(var g=0,h=d.length-1;g<=h;){var j=g+h>>1,l=e.call(f,d[j],j,d);if(l>0)g=j+1;else if(l<0)h=j-1;else return j}return-(g+1)};goog.array.sort=function(d,e){goog.array.ARRAY_PROTOTYPE_.sort.call(d,e||goog.array.defaultCompare)};goog.array.stableSort=function(d,e){function f(j,l){return h(j.value,l.value)||j.index-l.index}for(var g=0;g<d.length;g++)d[g]={index:g,value:d[g]};var h=e||goog.array.defaultCompare;goog.array.sort(d,f);for(g=0;g<d.length;g++)d[g]=d[g].value};
goog.array.sortObjectsByKey=function(d,e,f){var g=f||goog.array.defaultCompare;goog.array.sort(d,function(h,j){return g(h[e],j[e])})};goog.array.equals=function(d,e,f){if(!goog.isArrayLike(d)||!goog.isArrayLike(e)||d.length!=e.length)return false;var g=d.length;f=f||goog.array.defaultCompareEquality;for(var h=0;h<g;h++)if(!f(d[h],e[h]))return false;return true};goog.array.compare=function(d,e,f){return goog.array.equals(d,e,f)};goog.array.defaultCompare=function(d,e){return d>e?1:d<e?-1:0};
goog.array.defaultCompareEquality=function(d,e){return d===e};goog.array.binaryInsert=function(d,e,f){f=goog.array.binarySearch(d,e,f);if(f<0){goog.array.insertAt(d,e,-(f+1));return true}return false};goog.array.binaryRemove=function(d,e,f){e=goog.array.binarySearch(d,e,f);return e>=0?goog.array.removeAt(d,e):false};goog.array.bucket=function(d,e){for(var f={},g=0;g<d.length;g++){var h=d[g],j=e(h,g,d);if(goog.isDef(j))(f[j]||(f[j]=[])).push(h)}return f};
goog.array.repeat=function(d,e){for(var f=[],g=0;g<e;g++)f[g]=d;return f};goog.array.flatten=function(){for(var d=[],e=0;e<arguments.length;e++){var f=arguments[e];goog.isArray(f)?d.push.apply(d,goog.array.flatten.apply(null,f)):d.push(f)}return d};goog.array.rotate=function(d,e){if(d.length){e%=d.length;if(e>0)goog.array.ARRAY_PROTOTYPE_.unshift.apply(d,d.splice(-e,e));else e<0&&goog.array.ARRAY_PROTOTYPE_.push.apply(d,d.splice(0,-e))}return d};goog.object={};goog.object.forEach=function(d,e,f){for(var g in d)e.call(f,d[g],g,d)};goog.object.filter=function(d,e,f){var g={};for(var h in d)if(e.call(f,d[h],h,d))g[h]=d[h];return g};goog.object.map=function(d,e,f){var g={};for(var h in d)g[h]=e.call(f,d[h],h,d);return g};goog.object.some=function(d,e,f){for(var g in d)if(e.call(f,d[g],g,d))return true;return false};goog.object.every=function(d,e,f){for(var g in d)if(!e.call(f,d[g],g,d))return false;return true};
goog.object.getCount=function(d){var e=0;for(var f in d)e++;return e};goog.object.getAnyKey=function(d){for(var e in d)return e};goog.object.getAnyValue=function(d){for(var e in d)return d[e]};goog.object.contains=function(d,e){return goog.object.containsValue(d,e)};goog.object.getValues=function(d){var e=[],f=0;for(var g in d)e[f++]=d[g];return e};goog.object.getKeys=function(d){var e=[],f=0;for(var g in d)e[f++]=g;return e};goog.object.containsKey=function(d,e){return e in d};
goog.object.containsValue=function(d,e){for(var f in d)if(d[f]==e)return true;return false};goog.object.findKey=function(d,e,f){for(var g in d)if(e.call(f,d[g],g,d))return g};goog.object.findValue=function(d,e,f){return(e=goog.object.findKey(d,e,f))&&d[e]};goog.object.isEmpty=function(d){for(var e in d)return false;return true};goog.object.clear=function(d){for(var e=goog.object.getKeys(d),f=e.length-1;f>=0;f--)goog.object.remove(d,e[f])};
goog.object.remove=function(d,e){var f;if(f=e in d)delete d[e];return f};goog.object.add=function(d,e,f){if(e in d)throw Error('The object already contains the key "'+e+'"');goog.object.set(d,e,f)};goog.object.get=function(d,e,f){if(e in d)return d[e];return f};goog.object.set=function(d,e,f){d[e]=f};goog.object.setIfUndefined=function(d,e,f){return e in d?d[e]:(d[e]=f)};goog.object.clone=function(d){var e={};for(var f in d)e[f]=d[f];return e};
goog.object.transpose=function(d){var e={};for(var f in d)e[d[f]]=f;return e};goog.object.PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];goog.object.extend=function(d){for(var e,f,g=1;g<arguments.length;g++){f=arguments[g];for(e in f)d[e]=f[e];for(var h=0;h<goog.object.PROTOTYPE_FIELDS_.length;h++){e=goog.object.PROTOTYPE_FIELDS_[h];if(Object.prototype.hasOwnProperty.call(f,e))d[e]=f[e]}}};
goog.object.create=function(){var d=arguments.length;if(d==1&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(d%2)throw Error("Uneven number of arguments");for(var e={},f=0;f<d;f+=2)e[arguments[f]]=arguments[f+1];return e};goog.object.createSet=function(){var d=arguments.length;if(d==1&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var e={},f=0;f<d;f++)e[arguments[f]]=true;return e};goog.structs={};goog.structs.getCount=function(d){if(typeof d.getCount=="function")return d.getCount();if(goog.isArrayLike(d)||goog.isString(d))return d.length;return goog.object.getCount(d)};goog.structs.getValues=function(d){if(typeof d.getValues=="function")return d.getValues();if(goog.isString(d))return d.split("");if(goog.isArrayLike(d)){for(var e=[],f=d.length,g=0;g<f;g++)e.push(d[g]);return e}return goog.object.getValues(d)};
goog.structs.getKeys=function(d){if(typeof d.getKeys=="function")return d.getKeys();if(typeof d.getValues!="function"){if(goog.isArrayLike(d)||goog.isString(d)){var e=[];d=d.length;for(var f=0;f<d;f++)e.push(f);return e}return goog.object.getKeys(d)}};
goog.structs.contains=function(d,e){if(typeof d.contains=="function")return d.contains(e);if(typeof d.containsValue=="function")return d.containsValue(e);if(goog.isArrayLike(d)||goog.isString(d))return goog.array.contains(d,e);return goog.object.containsValue(d,e)};goog.structs.isEmpty=function(d){if(typeof d.isEmpty=="function")return d.isEmpty();if(goog.isArrayLike(d)||goog.isString(d))return goog.array.isEmpty(d);return goog.object.isEmpty(d)};
goog.structs.clear=function(d){if(typeof d.clear=="function")d.clear();else goog.isArrayLike(d)?goog.array.clear(d):goog.object.clear(d)};goog.structs.forEach=function(d,e,f){if(typeof d.forEach=="function")d.forEach(e,f);else if(goog.isArrayLike(d)||goog.isString(d))goog.array.forEach(d,e,f);else for(var g=goog.structs.getKeys(d),h=goog.structs.getValues(d),j=h.length,l=0;l<j;l++)e.call(f,h[l],g&&g[l],d)};
goog.structs.filter=function(d,e,f){if(typeof d.filter=="function")return d.filter(e,f);if(goog.isArrayLike(d)||goog.isString(d))return goog.array.filter(d,e,f);var g,h=goog.structs.getKeys(d),j=goog.structs.getValues(d),l=j.length;if(h){g={};for(var q=0;q<l;q++)if(e.call(f,j[q],h[q],d))g[h[q]]=j[q]}else{g=[];for(q=0;q<l;q++)e.call(f,j[q],undefined,d)&&g.push(j[q])}return g};
goog.structs.map=function(d,e,f){if(typeof d.map=="function")return d.map(e,f);if(goog.isArrayLike(d)||goog.isString(d))return goog.array.map(d,e,f);var g,h=goog.structs.getKeys(d),j=goog.structs.getValues(d),l=j.length;if(h){g={};for(var q=0;q<l;q++)g[h[q]]=e.call(f,j[q],h[q],d)}else{g=[];for(q=0;q<l;q++)g[q]=e.call(f,j[q],undefined,d)}return g};
goog.structs.some=function(d,e,f){if(typeof d.some=="function")return d.some(e,f);if(goog.isArrayLike(d)||goog.isString(d))return goog.array.some(d,e,f);for(var g=goog.structs.getKeys(d),h=goog.structs.getValues(d),j=h.length,l=0;l<j;l++)if(e.call(f,h[l],g&&g[l],d))return true;return false};
goog.structs.every=function(d,e,f){if(typeof d.every=="function")return d.every(e,f);if(goog.isArrayLike(d)||goog.isString(d))return goog.array.every(d,e,f);for(var g=goog.structs.getKeys(d),h=goog.structs.getValues(d),j=h.length,l=0;l<j;l++)if(!e.call(f,h[l],g&&g[l],d))return false;return true};goog.iter={};goog.iter.Iterable=goog.typedef;goog.iter.StopIteration="StopIteration"in goog.global?goog.global.StopIteration:Error("StopIteration");goog.iter.Iterator=function(){};goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration;};goog.iter.Iterator.prototype.__iterator__=function(){return this};
goog.iter.toIterator=function(d){if(d instanceof goog.iter.Iterator)return d;if(typeof d.__iterator__=="function")return d.__iterator__(false);if(goog.isArrayLike(d)){var e=0,f=new goog.iter.Iterator;f.next=function(){for(;;){if(e>=d.length)throw goog.iter.StopIteration;if(e in d)return d[e++];else e++}};return f}throw Error("Not implemented");};
goog.iter.forEach=function(d,e,f){if(goog.isArrayLike(d))try{goog.array.forEach(d,e,f)}catch(g){if(g!==goog.iter.StopIteration)throw g;}else{d=goog.iter.toIterator(d);try{for(;;)e.call(f,d.next(),undefined,d)}catch(h){if(h!==goog.iter.StopIteration)throw h;}}};goog.iter.filter=function(d,e,f){d=goog.iter.toIterator(d);var g=new goog.iter.Iterator;g.next=function(){for(;;){var h=d.next();if(e.call(f,h,undefined,d))return h}};return g};
goog.iter.range=function(d,e,f){var g=0,h=d,j=f||1;if(arguments.length>1){g=d;h=e}if(j==0)throw Error("Range step argument must not be zero");var l=new goog.iter.Iterator;l.next=function(){if(j>0&&g>=h||j<0&&g<=h)throw goog.iter.StopIteration;var q=g;g+=j;return q};return l};goog.iter.join=function(d,e){return goog.iter.toArray(d).join(e)};
goog.iter.map=function(d,e,f){d=goog.iter.toIterator(d);var g=new goog.iter.Iterator;g.next=function(){for(;;){var h=d.next();return e.call(f,h,undefined,d)}};return g};goog.iter.reduce=function(d,e,f,g){var h=f;goog.iter.forEach(d,function(j){h=e.call(g,h,j)});return h};goog.iter.some=function(d,e,f){d=goog.iter.toIterator(d);try{for(;;)if(e.call(f,d.next(),undefined,d))return true}catch(g){if(g!==goog.iter.StopIteration)throw g;}return false};
goog.iter.every=function(d,e,f){d=goog.iter.toIterator(d);try{for(;;)if(!e.call(f,d.next(),undefined,d))return false}catch(g){if(g!==goog.iter.StopIteration)throw g;}return true};goog.iter.chain=function(){var d=arguments,e=d.length,f=0,g=new goog.iter.Iterator;g.next=function(){try{if(f>=e)throw goog.iter.StopIteration;return goog.iter.toIterator(d[f]).next()}catch(h){if(h!==goog.iter.StopIteration||f>=e)throw h;else{f++;return this.next()}}};return g};
goog.iter.dropWhile=function(d,e,f){d=goog.iter.toIterator(d);var g=new goog.iter.Iterator,h=true;g.next=function(){for(;;){var j=d.next();if(!(h&&e.call(f,j,undefined,d))){h=false;return j}}};return g};goog.iter.takeWhile=function(d,e,f){d=goog.iter.toIterator(d);var g=new goog.iter.Iterator,h=true;g.next=function(){for(;;)if(h){var j=d.next();if(e.call(f,j,undefined,d))return j;else h=false}else throw goog.iter.StopIteration;};return g};
goog.iter.toArray=function(d){if(goog.isArrayLike(d))return goog.array.toArray(d);d=goog.iter.toIterator(d);var e=[];goog.iter.forEach(d,function(f){e.push(f)});return e};
goog.iter.equals=function(d,e){d=goog.iter.toIterator(d);e=goog.iter.toIterator(e);var f,g;try{for(;;){f=g=false;var h=d.next();f=true;var j=e.next();g=true;if(h!=j)return false}}catch(l){if(l!==goog.iter.StopIteration)throw l;else{if(f&&!g)return false;if(!g)try{e.next();return false}catch(q){if(q!==goog.iter.StopIteration)throw q;return true}}}return false};goog.iter.nextOrValue=function(d,e){try{return goog.iter.toIterator(d).next()}catch(f){if(f!=goog.iter.StopIteration)throw f;return e}};goog.structs.Map=function(d){this.map_={};this.keys_=[];var e=arguments.length;if(e>1){if(e%2)throw Error("Uneven number of arguments");for(var f=0;f<e;f+=2)this.set(arguments[f],arguments[f+1])}else d&&this.addAll(d)};a=goog.structs.Map.prototype;a.count_=0;a.version_=0;a.getCount=function(){return this.count_};a.getValues=function(){this.cleanupKeysArray_();for(var d=[],e=0;e<this.keys_.length;e++)d.push(this.map_[this.keys_[e]]);return d};a.getKeys=function(){this.cleanupKeysArray_();return this.keys_.concat()};
a.containsKey=function(d){return goog.structs.Map.hasKey_(this.map_,d)};a.containsValue=function(d){for(var e=0;e<this.keys_.length;e++){var f=this.keys_[e];if(goog.structs.Map.hasKey_(this.map_,f)&&this.map_[f]==d)return true}return false};a.equals=function(d,e){if(this===d)return true;if(this.count_!=d.getCount())return false;e=e||goog.structs.Map.defaultEquals;this.cleanupKeysArray_();for(var f,g=0;f=this.keys_[g];g++)if(!e(this.get(f),d.get(f)))return false;return true};
goog.structs.Map.defaultEquals=function(d,e){return d===e};a=goog.structs.Map.prototype;a.isEmpty=function(){return this.count_==0};a.clear=function(){this.map_={};this.version_=this.count_=this.keys_.length=0};a.remove=function(d){if(goog.structs.Map.hasKey_(this.map_,d)){delete this.map_[d];this.count_--;this.version_++;this.keys_.length>2*this.count_&&this.cleanupKeysArray_();return true}return false};
a.cleanupKeysArray_=function(){if(this.count_!=this.keys_.length){for(var d=0,e=0;d<this.keys_.length;){var f=this.keys_[d];if(goog.structs.Map.hasKey_(this.map_,f))this.keys_[e++]=f;d++}this.keys_.length=e}if(this.count_!=this.keys_.length){var g={};for(e=d=0;d<this.keys_.length;){f=this.keys_[d];if(!goog.structs.Map.hasKey_(g,f)){this.keys_[e++]=f;g[f]=1}d++}this.keys_.length=e}};a.get=function(d,e){if(goog.structs.Map.hasKey_(this.map_,d))return this.map_[d];return e};
a.set=function(d,e){if(!goog.structs.Map.hasKey_(this.map_,d)){this.count_++;this.keys_.push(d);this.version_++}this.map_[d]=e};a.addAll=function(d){var e;if(d instanceof goog.structs.Map){e=d.getKeys();d=d.getValues()}else{e=goog.object.getKeys(d);d=goog.object.getValues(d)}for(var f=0;f<e.length;f++)this.set(e[f],d[f])};a.clone=function(){return new goog.structs.Map(this)};a.transpose=function(){for(var d=new goog.structs.Map,e=0;e<this.keys_.length;e++){var f=this.keys_[e];d.set(this.map_[f],f)}return d};
a.getKeyIterator=function(){return this.__iterator__(true)};a.getValueIterator=function(){return this.__iterator__(false)};a.__iterator__=function(d){this.cleanupKeysArray_();var e=0,f=this.keys_,g=this.map_,h=this.version_,j=this,l=new goog.iter.Iterator;l.next=function(){for(;;){if(h!=j.version_)throw Error("The map has changed since the iterator was created");if(e>=f.length)throw goog.iter.StopIteration;var q=f[e++];return d?q:g[q]}};return l};
goog.structs.Map.hasKey_=function(d,e){return Object.prototype.hasOwnProperty.call(d,e)};goog.structs.Set=function(d){this.map_=new goog.structs.Map;d&&this.addAll(d)};goog.structs.Set.getKey_=function(d){var e=typeof d;return e=="object"&&d||e=="function"?"o"+goog.getUid(d):e.substr(0,1)+d};a=goog.structs.Set.prototype;a.getCount=function(){return this.map_.getCount()};a.add=function(d){this.map_.set(goog.structs.Set.getKey_(d),d)};a.addAll=function(d){d=goog.structs.getValues(d);for(var e=d.length,f=0;f<e;f++)this.add(d[f])};
a.removeAll=function(d){d=goog.structs.getValues(d);for(var e=d.length,f=0;f<e;f++)this.remove(d[f])};a.remove=function(d){return this.map_.remove(goog.structs.Set.getKey_(d))};a.clear=function(){this.map_.clear()};a.isEmpty=function(){return this.map_.isEmpty()};a.contains=function(d){return this.map_.containsKey(goog.structs.Set.getKey_(d))};a.containsAll=function(d){return goog.structs.every(d,this.contains,this)};
a.intersection=function(d){var e=new goog.structs.Set;d=goog.structs.getValues(d);for(var f=0;f<d.length;f++){var g=d[f];this.contains(g)&&e.add(g)}return e};a.getValues=function(){return this.map_.getValues()};a.clone=function(){return new goog.structs.Set(this)};a.equals=function(d){return this.getCount()==goog.structs.getCount(d)&&this.isSubsetOf(d)};
a.isSubsetOf=function(d){var e=goog.structs.getCount(d);if(this.getCount()>e)return false;if(!(d instanceof goog.structs.Set)&&e>5)d=new goog.structs.Set(d);return goog.structs.every(this,function(f){return goog.structs.contains(d,f)})};a.__iterator__=function(){return this.map_.__iterator__(false)};kemia.model={};kemia.model.Flags={};kemia.model.Flags.ISPLACED=0;kemia.model.Flags.VISITED=1;kemia.model.Flags.ISINRING=2;kemia.model.Flags.MAX_FLAG_INDEX=2;kemia.ring={};kemia.ring.Ring=function(d,e){this.atoms=d;this.bonds=e;for(var f=e=0,g=0,h=d.length;g<h;g++){e+=d[g].coord.x;f+=d[g].coord.y}this.ringCenter=new goog.math.Coordinate(e/d.length,f/d.length);this.flags=new Array(kemia.model.Flags.MAX_FLAG_INDEX+1)};kemia.ring.Ring.prototype.setFlag=function(d,e){this.flags[d]=e};kemia.ring.Hanser=function(){};kemia.ring.Hanser.findRings=function(d,e){var f=[];graph=new kemia.ring.PathGraph(d);for(var g=0,h=d.countAtoms();g<h;g++)for(var j=graph.remove(d.getAtom(g),e),l=0;l<j.length;l++){edge=j[l];atom_ring=edge.atoms;goog.array.removeAt(atom_ring,atom_ring.length-1);for(var q=0,x=atom_ring.length;q<x;q++)atom_ring[q]=d.indexOfAtom(atom_ring[q]);f.push(atom_ring)}goog.array.sort(f);return f};
kemia.ring.Hanser.createRing=function(d,e){for(var f=[],g=0,h=d.length-1;g<h;g++){bond=e.findBond(d[g],d[g+1]);bond!=null&&f.push(bond)}goog.array.removeAt(d,d.length-1);return new kemia.ring.Ring(d,f)};kemia.ring.PathGraph=function(d){this.edges=[];this.atoms=[];for(var e=0,f=d.countBonds();e<f;e++){bond=d.getBond(e);this.edges.push(new kemia.ring.PathEdge([bond.source,bond.target]))}e=0;for(f=d.countAtoms();e<f;e++)this.atoms.push(d.getAtom(e))};
kemia.ring.PathGraph.prototype.remove=function(d,e){var f=this.getEdges(d);result=[];for(var g=0,h=f.length;g<h;g++)f[g].isCycle()&&result.push(f[g]);g=0;for(h=result.length;g<h;g++){goog.array.contains(f,result[g])&&goog.array.remove(f,result[g]);goog.array.contains(this.edges,result[g])&&goog.array.remove(this.edges,result[g])}newEdges=this.spliceEdges(f);g=0;for(h=f.length;g<h;g++)goog.array.contains(this.edges,f[g])&&goog.array.remove(this.edges,f[g]);g=0;for(h=newEdges.length;g<h;g++)!goog.array.contains(this.edges,
newEdges[g])&&newEdges[g].atoms.length<=e+1&&this.edges.push(newEdges[g]);goog.array.remove(this.atoms,d);return result};kemia.ring.PathGraph.prototype.getEdges=function(d){for(var e=[],f=0,g=this.edges.length;f<g;f++){edge=this.edges[f];if(edge.isCycle())goog.array.contains(edge.atoms,d)&&e.push(edge);else{var h=edge.atoms.length-1;if(edge.atoms[0]==d||edge.atoms[h]==d)e.push(edge)}}return e};
kemia.ring.PathGraph.prototype.spliceEdges=function(d){for(var e=[],f=0,g=d.length;f<g;f++)for(var h=f+1;h<g;h++){spliced=d[h].splice(d[f]);spliced!=null&&e.push(spliced)}return e};kemia.ring.PathEdge=function(d){this.atoms=d};kemia.ring.PathEdge.prototype.isCycle=function(){var d=this.atoms.length-1;return this.atoms.length>2&&this.atoms[0]==this.atoms[d]};
kemia.ring.PathEdge.prototype.splice=function(d){intersection=this.getIntersection(d.atoms);newAtoms=[];for(var e=0,f=this.atoms.length;e<f;e++)newAtoms.push(this.atoms[e]);this.atoms[0]==intersection&&newAtoms.reverse();if(d.atoms[0]==intersection){e=1;for(f=d.atoms.length;e<f;e++)newAtoms.push(d.atoms[e])}else for(e=d.atoms.length-2;e>=0;e--)newAtoms.push(d.atoms[e]);if(!this.isRealPath(newAtoms))return null;return new kemia.ring.PathEdge(newAtoms)};
kemia.ring.PathEdge.prototype.isRealPath=function(d){for(var e=1,f=d.length-1;e<f;e++)for(var g=1;g<f;g++)if(e!=g)if(d[e]==d[g])return false;return true};kemia.ring.PathEdge.prototype.getIntersection=function(d){var e=this.atoms.length-1,f=d.length-1;if(this.atoms[e]==d[0]||this.atoms[e]==d[f])return this.atoms[e];if(this.atoms[0]==d[0]||this.atoms[0]==d[f])return this.atoms[0];throw"Couldn't splice - no intersection";};kemia.ring.SSSR={};
(function(){function d(k){for(var n=[],m=0,s=k.length;m<s;m++){var v=k[m];v instanceof Array?n.push(d(v)):n.push(v)}return n}function e(k,n){for(var m=[],s=0;s<n;s++){for(var v=[],u=0;u<n;u++)if(s==u)v.push(0);else k.findBond(k.getAtom(s),k.getAtom(u))?v.push(1):v.push(99999999);m.push(v)}return m}function f(k){for(var n=[],m=0;m<k;m++){for(var s=[],v=0;v<k;v++)s.push([]);n.push(s)}return n}function g(k,n){for(var m=[],s=0;s<n;s++){for(var v=[],u=0;u<n;u++){var w=k.getAtom(s),z=k.getAtom(u);(w=k.findBond(w,
z))?v.push([[k.indexOfBond(w)]]):v.push([])}m.push(v)}return m}function h(k,n,m){if(k.length)k.push(n[0].concat(m[0]));else k[0]=n[0].concat(m[0])}function j(k){var n=k.countAtoms(),m=e(k,n);k=g(k,n);for(var s=f(n),v=0;v<n;v++)for(var u=0;u<n;u++)for(var w=0;w<n;w++){var z=m[u][w],y=m[u][v]+m[v][w],A=k[u][v],B=k[v][w];if(y!=1E8)if(z>y){s[u][w]=z==y+1?d(k[u][w]):[];m[u][w]=y;k[u][w]=[A[0].concat(B[0])]}else if(z==y)A.length&&B.length&&h(k[u][w],A,B);else if(z==y-1)h(s[u][w],A,B);else m[u][w]=m[u][w]}return{D:m,
Pe1:k,Pe2:s}}function l(k,n){return k.Cnum-n.Cnum}function q(k,n,m){for(var s=k.length,v=[],u=0;u<s;u++)for(var w=0;w<s;w++)k[u][w]==0||n[u][w].length==1&&m[u][w].length==0||v.push({Cnum:m[u][w].length?2*(k[u][w]+0.5):2*k[u][w],Pe1:n[u][w],Pe2:m[u][w]});v.sort(l);return v}function x(k,n){for(var m=[],s=0,v=k.length;s<v;s++){var u=n.getBond(k[s]),w=n.indexOfAtom(u.source);u=n.indexOfAtom(u.target);goog.array.contains(m,w)||m.push(w);goog.array.contains(m,u)||m.push(u)}return m}function o(k,n,m,s,v){m=
x(k,m);if(k.length===m.length)kemia.ring.SSSR.isCandidateInSet(m,n,s,v)||n.push(m)}function t(k,n,m){for(var s=[],v=[],u=0,w=m.countAtoms();u<w;u++)v.push(m.getAtom(u).countBonds());var z=goog.array.repeat(0,m.countAtoms());u=0;for(w=k.length;u<w;u++){var y=k[u];if(y.Cnum%2)for(var A=0,B=y.Pe2.length;A<B;A++){var C=y.Pe1[0].concat(y.Pe2[A]);o(C,s,m,v,z);if(s.length==n)return s}else{A=0;for(B=y.Pe1.length-1;A<B;A++){C=y.Pe1[A].concat(y.Pe1[A+1]);o(C,s,m,v,z);if(s.length==n)return s}}}return s}function p(k,
n){for(var m=[k[0]],s=n.getAtom(k[0]),v=0;k.length!=m.length;){v++;if(v>1E3)break;for(var u=1,w=k.length;u<w;u++){var z=n.getAtom(m[m.length-1]),y=n.getAtom(k[u]);if(!goog.array.contains(m,k[u]))if(n.findBond(z,y))m.push(k[u]);else n.findBond(s,y)&&goog.array.insertAt(m,k[u],0)}}return m}kemia.ring.SSSR.isCandidateInSet=function(k,n,m,s){for(var v=0,u=n.length;v<u;v++){var w=n[v];if(k.length>=w.length){for(var z=true,y=0,A=w.length;y<A;y++)goog.array.contains(k,w[y])||(z=false);if(z)return true}y=
0;for(A=k.length;y<A;y++)goog.array.contains(w,k[y])&&s[y]++}n=false;y=0;for(A=k.length;y<A;y++)if(s[k[y]]<m[k[y]]-1)n=true;if(n){y=0;for(A=k.length;y<A;y++)s[k[y]]++;return false}return true};kemia.ring.SSSR.findRings=function(k){var n=k.countBonds()-k.countAtoms()+1;if(!n)return[];var m=j(k),s=q(m.D,m.Pe1,m.Pe2);n=t(s,n,k,m.D);m=0;for(s=n.length;m<s;m++)n[m]=p(n[m],k);return n}})();kemia.ring.RingFinder={};
(function(){function d(h,j){for(var l=[],q=0,x=h.length;q<x;q++)l.push(j.getAtom(h[q]));h=[];q=0;for(x=l.length-1;q<x;q++){bond=j.findBond(l[q],l[q+1]);bond!=null&&h.push(bond)}bond=j.findBond(l[0],l[l.length-1]);bond!=null&&h.push(bond);return new kemia.ring.Ring(l,h)}function e(h,j,l){for(var q=[],x=[],o=0,t=l.countAtoms();o<t;o++)x.push(l.getAtom(o).countBonds());l=goog.array.repeat(0,l.countAtoms());o=0;for(t=h.length;o<t;o++){var p=h[o];if(!kemia.ring.SSSR.isCandidateInSet(p,q,x,l)){q.push(p);
if(q.length==j)return q}}return q}function f(h){var j=h.countAtoms();if(j){var l=goog.array.repeat(false,j);j=goog.array.repeat(false,j);var q=[];h=h.atoms[0];h.depth=0;q.push(h);for(l[0]=true;;){if(!q.length)break;h=q[0];goog.array.removeAt(q,0);for(var x=h.bonds.getValues(),o=0,t=x.length;o<t;o++){var p=x[o],k=p.index;if(!j[k]){j[k]=true;var n=p.otherAtom(h);p=n.index;if(l[p]){p=[];if(h.depth==n.depth){p.push(h);p.push(n)}else{n.isInCycle=true;var m=n.getNeighbors();k=0;for(var s=m.length;k<s;k++){var v=
m[k];v.depth==n.depth-1&&p.push(v)}}for(n=h.depth;;){p[0].isInCycle=true;p[1].isInCycle=true;n--;m=p[0].getNeighbors();k=0;for(s=m.length;k<s;k++)if(m[k].depth==n){p[0]=m[k];break}m=p[1].getNeighbors();k=0;for(s=m.length;k<s;k++)if(m[k].depth==n){p[1]=m[k];break}if(p[0]==p[1]){p[0].isInCycle=true;break}}}else{n.depth=h.depth+1;l[p]=true;q.push(n)}}}}}}function g(h){var j=[],l=h.countAtoms(),q=goog.array.repeat(false,l),x=goog.array.repeat(false,l);l=goog.array.repeat(-1,l);for(var o=0,t=h.countAtoms();o<
t;o++){var p=h.atoms[o];if(!q[p.index])if(p.isInCycle){var k=new kemia.model.Molecule,n=[];n.push(p);q[0]=true;var m=new kemia.model.Atom;m.index2=p.index;l[p.index]=0;for(k.addAtom(m);;){if(!n.length)break;var s=n[0];goog.array.removeAt(n,0);var v=s.bonds.getValues();p=0;for(var u=v.length;p<u;p++){var w=v[p];m=w.index;if(!x[m]){x[m]=true;w=w.otherAtom(s);m=w.index;if(w.isInCycle){if(q[m]){m=h.findBond(s,w);var z=new kemia.model.Bond(k.atoms[l[s.index]],k.atoms[l[w.index]]);z.index2=m.index}else{q[m]=
true;n.push(w);m=new kemia.model.Atom;m.index2=w.index;l[w.index]=k.atoms.length;k.addAtom(m);w=h.findBond(s,w);z=new kemia.model.Bond(k.atoms[l[s.index]],m);z.index2=w.index}k.addBond(z)}}}}p=0;for(u=k.atoms.length;p<u;p++)k.atoms[p].index=p;p=0;for(u=k.bonds.length;p<u;p++)k.bonds[p].index=p;p=k.bonds.length-k.atoms.length+1;u=kemia.ring.Hanser.findRings(k,6);if(u.length>=p){n=e(u,p,k);if(n.length<p)n=kemia.ring.SSSR.findRings(k)}else n=kemia.ring.SSSR.findRings(k);p=0;for(u=n.length;p<u;p++){s=
n[p];v=0;for(m=s.length;v<m;v++)s[v]=k.atoms[s[v]].index2}p=0;for(k=n.length;p<k;p++)j.push(d(n[p],h))}}return j}kemia.ring.RingFinder={};kemia.ring.RingFinder.findRings=function(h){if(!(h.countBonds()-h.countAtoms()+h.fragmentCount))return[];for(var j=0,l=h.atoms.length;j<l;j++)h.atoms[j].index=j;j=0;for(l=h.bonds.length;j<l;j++)h.bonds[j].index=j;f(h);return g(h)}})();kemia.query.DFSMapper={};
(function(){function d(e,f){return e-f}kemia.query.DFSMapper=function(e){function f(o){return o.getAtom(0)}function g(o,t,p){this.type=o;this.query=t;this.queried=p;this.sssr=p.getRings();this.queryPath=[];this.queriedPath=[];this.candidates=[]}function h(o,t){if(o.queryPath.length===o.query.countAtoms()){for(var p=new goog.structs.Map,k=0,n=o.queryPath.length;k<n;k++)p.set(o.query.indexOfAtom(o.queryPath[k]),o.queried.indexOfAtom(o.queriedPath[k]));if(o.type===x.MapUnique){o=p.getValues();o.sort(d);
var m=true;k=0;for(n=t.length;k<n;k++){var s=t[k].getValues();s.sort(d);if(goog.array.equals(o,s))m=false}m&&t.push(p)}else t.push(p)}}function j(o,t,p,k,n,m){if(goog.array.indexOf(o.queryPath,k)!==-1)return false;if(goog.array.indexOf(o.queriedPath,n)!==-1)return false;if(!k.matches(n,o.queried,o.sssr))return false;t=o.query.findBond(t,k);p=o.queried.findBond(p,n);if(!t.matches(p,o.queried,o.sssr))return false;o.queryPath.push(k);o.queriedPath.push(n);h(o,m);return true}function l(o,t,p,k){for(var n=
t.getNeighbors(),m=p.getNeighbors(),s=[],v=0,u=n.length;v<u;v++)for(var w=n[v],z=0,y=m.length;z<y;z++)s.push({queryAtom:t,queryNbr:w,queriedAtom:p,queriedNbr:m[z]});for(o.candidates.length?o.candidates.push(o.candidates[o.candidates.length-1].concat(s)):o.candidates.push(s);o.candidates[o.candidates.length-1].length;){t=o.candidates[o.candidates.length-1].pop();if(j(o,t.queryAtom,t.queriedAtom,t.queryNbr,t.queriedNbr,k)){l(o,t.queryNbr,t.queriedNbr,k);o.queryPath.pop();o.queriedPath.pop();o.candidates.pop()}}}
function q(o,t,p,k,n,m,s){var v=new g(t,p,n),u=n.getAtom(o);if(k.matches(u)){v.queryPath.push(k);v.queriedPath.push(u);l(v,k,u,m)}o++;o<n.countAtoms()?setTimeout(function(){q(o,t,p,k,n,m,s)},0):s(m)}var x={MapFirst:0,MapUnique:1,MapAll:2};this.query=e;this.mapAll=function(o){for(var t=[],p=f(this.query),k=0,n=o.countAtoms();k<n;k++){var m=new g(x.MapAll,this.query,o),s=o.getAtom(k);if(p.matches(s))if(this.query.countAtoms()>1){m.queryPath.push(p);m.queriedPath.push(s);l(m,p,s,t)}else{var v=new goog.structs.Map;
v.set(m.query.indexOfAtom(p),m.queried.indexOfAtom(s));t.push(v)}}return t};this.mapAllCallback=function(o,t){var p=f(this.query);q(0,x.MapAll,this.query,p,o,[],t)};this.mapUnique=function(o){for(var t=[],p=f(this.query),k=0,n=o.countAtoms();k<n;k++){var m=new g(x.MapUnique,this.query,o),s=o.getAtom(k);if(p.matches(s))if(this.query.countAtoms()>1){m.queryPath.push(p);m.queriedPath.push(s);l(m,p,s,t)}else{var v=new goog.structs.Map;v.set(m.query.indexOfAtom(p),m.queried.indexOfAtom(s));t.push(v)}}return t};
this.mapUniqueCallback=function(o,t){var p=f(this.query);q(0,x.MapUnique,this.query,p,o,[],t)};this.mapFirst=function(o){for(var t=[],p=f(this.query),k=0,n=o.countAtoms();k<n;k++){var m=new g(x.MapFirst,this.query,o),s=o.getAtom(k);if(p.matches(s)){if(this.query.countAtoms()>1){m.queryPath.push(p);m.queriedPath.push(s);l(m,p,s,t)}else{o=new goog.structs.Map;o.set(m.query.indexOfAtom(p),m.queried.indexOfAtom(s));return o}if(t.length)return t[0]}}return new goog.structs.Map}}})();kemia.resource={};kemia.resource.Covalence={C:4,Si:4,N:3,P:3,O:2,S:2,H:1};goog.math={};goog.math.Coordinate=function(d,e){this.x=goog.isDef(d)?d:0;this.y=goog.isDef(e)?e:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};if(goog.DEBUG)goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"};goog.math.Coordinate.equals=function(d,e){if(d==e)return true;if(!d||!e)return false;return d.x==e.x&&d.y==e.y};goog.math.Coordinate.distance=function(d,e){var f=d.x-e.x;d=d.y-e.y;return Math.sqrt(f*f+d*d)};
goog.math.Coordinate.squaredDistance=function(d,e){var f=d.x-e.x;d=d.y-e.y;return f*f+d*d};goog.math.Coordinate.difference=function(d,e){return new goog.math.Coordinate(d.x-e.x,d.y-e.y)};goog.math.Coordinate.sum=function(d,e){return new goog.math.Coordinate(d.x+e.x,d.y+e.y)};kemia.model.Atom=function(d,e,f,g,h,j){this.symbol=d;this.coord=new goog.math.Coordinate(e,f);this.bonds=new goog.structs.Set;this.charge=goog.isDef(g)?g:0;this.isotope=goog.isDef(j)?j:0;this.aromatic=goog.isDef(h)?h:false;this.hybridization=null;this.flags=new Array(kemia.model.Flags.MAX_FLAG_INDEX+1)};kemia.model.Atom.prototype.countBonds=function(){return this.bonds.getCount()};
kemia.model.Atom.prototype.hydrogenCount=function(){var d=kemia.resource.Covalence[this.symbol],e=goog.array.reduce(this.bonds.getValues(),function(g,h){return g+h.order},0),f=0;if(d)f=d-e+this.charge;return f};kemia.model.Atom.prototype.getNeighbors=function(){for(var d=this.bonds.getValues(),e=[],f=0,g=d.length;f<g;f++)e.push(d[f].otherAtom(this));return e};kemia.model.Atom.prototype.clone=function(){return new kemia.model.Atom(this.symbol,this.coord.x,this.coord.y,this.charge,this.aromatic,this.isotope)};
kemia.model.Atom.Hybridizations={S:0,SP1:1,SP2:2,SP3:3,PLANAR3:4,SP3D1:5,SP3D2:6,SP3D3:7,SP3D4:8,SP3D5:9};kemia.model.Atom.prototype.setFlag=function(d,e){this.flags[d]=e};kemia.model.Molecule=function(d){this.bonds=[];this.atoms=[];this.name=d?d:"";this.sssr=[];this.mustRecalcSSSR=true;this.fragments=[];this.fragmentCount=0};a=kemia.model.Molecule.prototype;
a.addBond=function(d){var e=this.indexOfAtom(d.source),f=this.indexOfAtom(d.target);if(this.fragments[e]!=this.fragments[f]){var g;if(this.fragments[e]<this.fragments[f]){e=this.fragments[e];g=this.fragments[f]}else{g=this.fragments[e];e=this.fragments[f]}this.fragmentCount--;f=0;for(var h=this.atoms.length;f<h;f++)if(this.fragments[f]==e)this.fragments[f]=g}this.bonds.push(d);d.source.bonds.add(d);d.target.bonds.add(d);d.molecule=this};a.getAtom=function(d){return this.atoms[d]};a.getBond=function(d){return this.bonds[d]};
a.findBond=function(d,e){for(var f=d.bonds.getValues(),g=0,h=f.length;g<h;g++){var j=f[g];if(j.otherAtom(d)==e)return j}return null};a.indexOfAtom=function(d){return goog.array.indexOf(this.atoms,d)};a.indexOfBond=function(d){return goog.array.indexOf(this.bonds,d)};
a.removeAtom=function(d){var e;if(d.constructor==Number)e=this.atoms[d];else if(d.constructor==kemia.model.Atom)e=d;d=e.bonds.getValues();var f=this.bonds;goog.array.forEach(d,function(g){goog.array.remove(f,g)});e.bonds.clear();goog.array.remove(this.atoms,e);e.molecule=undefined};
a.removeBond=function(d){d=d.constructor==Number?this.bonds[d]:d;d.source.bonds.remove(d);d.target.bonds.remove(d);if(d.source.bonds.length==0){goog.array.remove(this.atoms,d.source);d.source.molecule=undefined}if(d.target.bonds.length==0){goog.array.remove(this.atoms,d.target);d.target.molecule=undefined}goog.array.remove(this.bonds,d);d.molecule=undefined;d.source=undefined;d.target=undefined};a.countAtoms=function(){return this.atoms.length};a.countBonds=function(){return this.bonds.length};
a.addAtom=function(d){var e=this.atoms.length;this.fragmentCount++;this.fragments[e]=this.fragmentCount;this.atoms.push(d);d.molecule=this};a.getRings=function(){if(this.mustRecalcSSSR){this.mustRecalcSSSR=false;this.sssr=kemia.ring.RingFinder.findRings(this)}return this.sssr};a.isAtomInRing=function(d){rings=this.getRings();r=0;for(ringCount=rings.length;r<ringCount;r++){a=0;for(atomCount=rings[r].atoms.length;a<atomCount;a++)if(d==rings[r].atoms[a])return true}return false};
a.isBondInRing=function(d){rings=this.getRings();r=0;for(ringCount=rings.length;r<ringCount;r++){b=0;for(bondCount=rings[r].bonds.length;b<bondCount;b++)if(d==rings[r].bonds[b])return true}return false};a.clone=function(){var d=new kemia.model.Molecule(this.name);goog.array.forEach(this.atoms,function(e){d.addAtom(e)});goog.array.forEach(this.bonds,function(e){d.addBond(e)});return d};
a.getFragments=function(){var d=this.clone();if(d.fragmentCount==1)return[d];var e=new goog.structs.Map;goog.array.forEach(d.atoms,function(f){var g=d.fragments[d.indexOfAtom(f)];e.containsKey(g)==false&&e.set(g,new kemia.model.Molecule);e.get(g).addAtom(f)});goog.array.forEach(d.bonds,function(f){var g=d.fragments[d.indexOfAtom(f.source)];e.get(g).addBond(f)});return e.getValues()};
a.getConnectedBondsList=function(d){bondsList=[];bondCount=this.bonds.length;for(i=0;i<bondCount;i++)if(this.bonds[i].source==d||this.bonds[i].target==d)bondsList.push(this.bonds[i]);return bondsList};a.toString=function(){return goog.array.map(this.atoms,function(d){return d.symbol+d.index+d.coord.toString()})};a.getCenter=function(){var d=this.getBoundingBox();return new goog.math.Coordinate((d.left+d.right)/2,(d.top+d.bottom)/2)};
a.getBoundingBox=function(){return goog.math.Box.boundingBox.apply(null,goog.array.map(this.atoms,function(d){return d.coord}))};kemia.model.Bond=function(d,e,f,g,h,j){this.source=d;this.target=e;this.order=goog.isDef(f)?f:kemia.model.Bond.ORDER.SINGLE;this.stereo=goog.isDef(g)?g:kemia.model.Bond.STEREO.NOT_STEREO;this.aromatic=goog.isDef(h)?h:false;this.molecule=goog.isDef(j)?j:null};kemia.model.Bond.prototype.otherAtom=function(d){if(d===this.source)return this.target;if(d===this.target)return this.source;return null};
kemia.model.Bond.prototype.clone=function(){return new kemia.model.Bond(this.source,this.target,this.order,this.stereo,this.aromatic,this.molecule)};kemia.model.Bond.prototype.deepClone=function(){return new kemia.model.Bond(this.source.clone(),this.target.clone(),this.order,this.stereo,this.aromatic,this.molecule)};kemia.model.Bond.ORDER={SINGLE:1,DOUBLE:2,TRIPLE:3,QUADRUPLE:4};kemia.model.Bond.STEREO={NOT_STEREO:10,UP:11,UP_OR_DOWN:12,DOWN:13};goog.math.Box=function(d,e,f,g){this.top=d;this.right=e;this.bottom=f;this.left=g};goog.math.Box.boundingBox=function(){for(var d=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),e=1;e<arguments.length;e++){var f=arguments[e];d.top=Math.min(d.top,f.y);d.right=Math.max(d.right,f.x);d.bottom=Math.max(d.bottom,f.y);d.left=Math.min(d.left,f.x)}return d};goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};
if(goog.DEBUG)goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};goog.math.Box.prototype.contains=function(d){return goog.math.Box.contains(this,d)};goog.math.Box.prototype.expand=function(d,e,f,g){if(goog.isObject(d)){this.top-=d.top;this.right+=d.right;this.bottom+=d.bottom;this.left-=d.left}else{this.top-=d;this.right+=e;this.bottom+=f;this.left-=g}return this};
goog.math.Box.prototype.expandToInclude=function(d){this.left=Math.min(this.left,d.left);this.top=Math.min(this.top,d.top);this.right=Math.max(this.right,d.right);this.bottom=Math.max(this.bottom,d.bottom)};goog.math.Box.equals=function(d,e){if(d==e)return true;if(!d||!e)return false;return d.top==e.top&&d.right==e.right&&d.bottom==e.bottom&&d.left==e.left};
goog.math.Box.contains=function(d,e){if(!d||!e)return false;if(e instanceof goog.math.Box)return e.left>=d.left&&e.right<=d.right&&e.top>=d.top&&e.bottom<=d.bottom;return e.x>=d.left&&e.x<=d.right&&e.y>=d.top&&e.y<=d.bottom};
goog.math.Box.distance=function(d,e){if(e.x>=d.left&&e.x<=d.right){if(e.y>=d.top&&e.y<=d.bottom)return 0;return e.y<d.top?d.top-e.y:e.y-d.bottom}if(e.y>=d.top&&e.y<=d.bottom)return e.x<d.left?d.left-e.x:e.x-d.right;return goog.math.Coordinate.distance(e,new goog.math.Coordinate(e.x<d.left?d.left:d.right,e.y<d.top?d.top:d.bottom))};goog.math.Box.intersects=function(d,e){return d.left<=e.right&&e.left<=d.right&&d.top<=e.bottom&&e.top<=d.bottom};goog.math.Size=function(d,e){this.width=d;this.height=e};goog.math.Size.equals=function(d,e){if(d==e)return true;if(!d||!e)return false;return d.width==e.width&&d.height==e.height};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};if(goog.DEBUG)goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"};a=goog.math.Size.prototype;a.getLongest=function(){return Math.max(this.width,this.height)};
a.getShortest=function(){return Math.min(this.width,this.height)};a.area=function(){return this.width*this.height};a.aspectRatio=function(){return this.width/this.height};a.isEmpty=function(){return!this.area()};a.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};a.fitsInside=function(d){return this.width<=d.width&&this.height<=d.height};a.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
a.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};a.scale=function(d){this.width*=d;this.height*=d;return this};a.scaleToFit=function(d){return this.scale(this.aspectRatio()>d.aspectRatio()?d.width/this.width:d.height/this.height)};goog.math.Rect=function(d,e,f,g){this.left=d;this.top=e;this.width=f;this.height=g};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};goog.math.Rect.prototype.toBox=function(){return new goog.math.Box(this.top,this.left+this.width,this.top+this.height,this.left)};goog.math.Rect.createFromBox=function(d){return new goog.math.Rect(d.left,d.top,d.right-d.left,d.bottom-d.top)};
if(goog.DEBUG)goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};goog.math.Rect.equals=function(d,e){if(d==e)return true;if(!d||!e)return false;return d.left==e.left&&d.width==e.width&&d.top==e.top&&d.height==e.height};
goog.math.Rect.prototype.intersection=function(d){var e=Math.max(this.left,d.left),f=Math.min(this.left+this.width,d.left+d.width);if(e<=f){var g=Math.max(this.top,d.top);d=Math.min(this.top+this.height,d.top+d.height);if(g<=d){this.left=e;this.top=g;this.width=f-e;this.height=d-g;return true}}return false};
goog.math.Rect.intersection=function(d,e){var f=Math.max(d.left,e.left),g=Math.min(d.left+d.width,e.left+e.width);if(f<=g){var h=Math.max(d.top,e.top);d=Math.min(d.top+d.height,e.top+e.height);if(h<=d)return new goog.math.Rect(f,h,g-f,d-h)}return null};goog.math.Rect.intersects=function(d,e){return d.left<=e.left+e.width&&e.left<=d.left+d.width&&d.top<=e.top+e.height&&e.top<=d.top+d.height};goog.math.Rect.prototype.intersects=function(d){return goog.math.Rect.intersects(this,d)};
goog.math.Rect.difference=function(d,e){var f=goog.math.Rect.intersection(d,e);if(!f||!f.height||!f.width)return[d.clone()];f=[];var g=d.top,h=d.height,j=d.left+d.width,l=d.top+d.height,q=e.left+e.width,x=e.top+e.height;if(e.top>d.top){f.push(new goog.math.Rect(d.left,d.top,d.width,e.top-d.top));g=e.top;h-=e.top-d.top}if(x<l){f.push(new goog.math.Rect(d.left,x,d.width,l-x));h=x-g}e.left>d.left&&f.push(new goog.math.Rect(d.left,g,e.left-d.left,h));q<j&&f.push(new goog.math.Rect(q,g,j-q,h));return f};
goog.math.Rect.prototype.difference=function(d){return goog.math.Rect.difference(this,d)};goog.math.Rect.prototype.boundingRect=function(d){var e=Math.max(this.left+this.width,d.left+d.width),f=Math.max(this.top+this.height,d.top+d.height);this.left=Math.min(this.left,d.left);this.top=Math.min(this.top,d.top);this.width=e-this.left;this.height=f-this.top};goog.math.Rect.boundingRect=function(d,e){if(!d||!e)return null;d=d.clone();d.boundingRect(e);return d};
goog.math.Rect.prototype.contains=function(d){return d instanceof goog.math.Rect?this.left<=d.left&&this.left+this.width>=d.left+d.width&&this.top<=d.top&&this.top+this.height>=d.top+d.height:d.x>=this.left&&d.x<=this.left+this.width&&d.y>=this.top&&d.y<=this.top+this.height};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};goog.string={};goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(d,e){return d.lastIndexOf(e,0)==0};goog.string.endsWith=function(d,e){var f=d.length-e.length;return f>=0&&d.indexOf(e,f)==f};goog.string.caseInsensitiveStartsWith=function(d,e){return goog.string.caseInsensitiveCompare(e,d.substr(0,e.length))==0};goog.string.caseInsensitiveEndsWith=function(d,e){return goog.string.caseInsensitiveCompare(e,d.substr(d.length-e.length,e.length))==0};
goog.string.subs=function(d){for(var e=1;e<arguments.length;e++){var f=String(arguments[e]).replace(/\$/g,"$$$$");d=d.replace(/\%s/,f)}return d};goog.string.collapseWhitespace=function(d){return d.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmpty=function(d){return/^[\s\xa0]*$/.test(d)};goog.string.isEmptySafe=function(d){return goog.string.isEmpty(goog.string.makeSafe(d))};goog.string.isBreakingWhitespace=function(d){return!/[^\t\n\r ]/.test(d)};goog.string.isAlpha=function(d){return!/[^a-zA-Z]/.test(d)};
goog.string.isNumeric=function(d){return!/[^0-9]/.test(d)};goog.string.isAlphaNumeric=function(d){return!/[^a-zA-Z0-9]/.test(d)};goog.string.isSpace=function(d){return d==" "};goog.string.isUnicodeChar=function(d){return d.length==1&&d>=" "&&d<="~"||d>="\u0080"&&d<="\ufffd"};goog.string.stripNewlines=function(d){return d.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(d){return d.replace(/(\r\n|\r|\n)/g,"\n")};
goog.string.normalizeWhitespace=function(d){return d.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(d){return d.replace(/\xa0|[ \t]+/g," ")};goog.string.trim=function(d){return d.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(d){return d.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(d){return d.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(d,e){d=String(d).toLowerCase();e=String(e).toLowerCase();return d<e?-1:d==e?0:1};
goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;goog.string.numerateCompare=function(d,e){if(d==e)return 0;if(!d)return-1;if(!e)return 1;for(var f=d.toLowerCase().match(goog.string.numerateCompareRegExp_),g=e.toLowerCase().match(goog.string.numerateCompareRegExp_),h=Math.min(f.length,g.length),j=0;j<h;j++){var l=f[j],q=g[j];if(l!=q){d=parseInt(l,10);if(!isNaN(d)){e=parseInt(q,10);if(!isNaN(e)&&d-e)return d-e}return l<q?-1:1}}if(f.length!=g.length)return f.length-g.length;return d<e?-1:1};
goog.string.encodeUriRegExp_=/^[a-zA-Z0-9\-_.!~*'()]*$/;goog.string.urlEncode=function(d){d=String(d);if(!goog.string.encodeUriRegExp_.test(d))return encodeURIComponent(d);return d};goog.string.urlDecode=function(d){return decodeURIComponent(d.replace(/\+/g," "))};goog.string.newLineToBr=function(d,e){return d.replace(/(\r\n|\r|\n)/g,e?"<br />":"<br>")};
goog.string.htmlEscape=function(d,e){if(e)return d.replace(goog.string.amperRe_,"&amp;").replace(goog.string.ltRe_,"&lt;").replace(goog.string.gtRe_,"&gt;").replace(goog.string.quotRe_,"&quot;");else{if(!goog.string.allRe_.test(d))return d;if(d.indexOf("&")!=-1)d=d.replace(goog.string.amperRe_,"&amp;");if(d.indexOf("<")!=-1)d=d.replace(goog.string.ltRe_,"&lt;");if(d.indexOf(">")!=-1)d=d.replace(goog.string.gtRe_,"&gt;");if(d.indexOf('"')!=-1)d=d.replace(goog.string.quotRe_,"&quot;");return d}};
goog.string.amperRe_=/&/g;goog.string.ltRe_=/</g;goog.string.gtRe_=/>/g;goog.string.quotRe_=/\"/g;goog.string.allRe_=/[&<>\"]/;goog.string.unescapeEntities=function(d){if(goog.string.contains(d,"&"))return"document"in goog.global&&!goog.string.contains(d,"<")?goog.string.unescapeEntitiesUsingDom_(d):goog.string.unescapePureXmlEntities_(d);return d};
goog.string.unescapeEntitiesUsingDom_=function(d){var e=goog.global.document.createElement("a");e.innerHTML=d;e[goog.string.NORMALIZE_FN_]&&e[goog.string.NORMALIZE_FN_]();d=e.firstChild.nodeValue;e.innerHTML="";return d};goog.string.unescapePureXmlEntities_=function(d){return d.replace(/&([^;]+);/g,function(e,f){switch(f){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if(f.charAt(0)=="#"){f=Number("0"+f.substr(1));if(!isNaN(f))return String.fromCharCode(f)}return e}})};
goog.string.NORMALIZE_FN_="normalize";goog.string.whitespaceEscape=function(d,e){return goog.string.newLineToBr(d.replace(/  /g," &#160;"),e)};goog.string.stripQuotes=function(d,e){for(var f=e.length,g=0;g<f;g++){var h=f==1?e:e.charAt(g);if(d.charAt(0)==h&&d.charAt(d.length-1)==h)return d.substring(1,d.length-1)}return d};goog.string.truncate=function(d,e,f){if(f)d=goog.string.unescapeEntities(d);if(d.length>e)d=d.substring(0,e-3)+"...";if(f)d=goog.string.htmlEscape(d);return d};
goog.string.truncateMiddle=function(d,e,f){if(f)d=goog.string.unescapeEntities(d);if(d.length>e){var g=Math.floor(e/2),h=d.length-g;g+=e%2;d=d.substring(0,g)+"..."+d.substring(h)}if(f)d=goog.string.htmlEscape(d);return d};goog.string.jsEscapeCache_={"\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\u000b":"\\x0B",'"':'\\"',"'":"\\'","\\":"\\\\"};
goog.string.quote=function(d){d=String(d);if(d.quote)return d.quote();else{for(var e=['"'],f=0;f<d.length;f++)e[f+1]=goog.string.escapeChar(d.charAt(f));e.push('"');return e.join("")}};goog.string.escapeChar=function(d){if(d in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[d];var e=d,f=d.charCodeAt(0);if(f>31&&f<127)e=d;else{if(f<256){e="\\x";if(f<16||f>256)e+="0"}else{e="\\u";if(f<4096)e+="0"}e+=f.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[d]=e};
goog.string.toMap=function(d){for(var e={},f=0;f<d.length;f++)e[d.charAt(f)]=true;return e};goog.string.contains=function(d,e){return d.indexOf(e)!=-1};goog.string.removeAt=function(d,e,f){var g=d;if(e>=0&&e<d.length&&f>0)g=d.substr(0,e)+d.substr(e+f,d.length-e-f);return g};goog.string.remove=function(d,e){e=new RegExp(goog.string.regExpEscape(e),"");return d.replace(e,"")};goog.string.removeAll=function(d,e){e=new RegExp(goog.string.regExpEscape(e),"g");return d.replace(e,"")};
goog.string.regExpEscape=function(d){return String(d).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(d,e){return(new Array(e+1)).join(d)};goog.string.padNumber=function(d,e,f){d=goog.isDef(f)?d.toFixed(f):String(d);f=d.indexOf(".");if(f==-1)f=d.length;return goog.string.repeat("0",Math.max(0,e-f))+d};goog.string.makeSafe=function(d){return d==null?"":String(d)};goog.string.buildString=function(){return Array.prototype.join.call(arguments,"")};
goog.string.getRandomString=function(){return Math.floor(Math.random()*2147483648).toString(36)+(Math.floor(Math.random()*2147483648)^goog.now()).toString(36)};
goog.string.compareVersions=function(d,e){var f=0;d=goog.string.trim(String(d)).split(".");e=goog.string.trim(String(e)).split(".");for(var g=Math.max(d.length,e.length),h=0;f==0&&h<g;h++){var j=d[h]||"",l=e[h]||"",q=new RegExp("(\\d*)(\\D*)","g"),x=new RegExp("(\\d*)(\\D*)","g");do{var o=q.exec(j)||["","",""],t=x.exec(l)||["","",""];if(o[0].length==0&&t[0].length==0)break;f=o[1].length==0?0:parseInt(o[1],10);var p=t[1].length==0?0:parseInt(t[1],10);f=goog.string.compareElements_(f,p)||goog.string.compareElements_(o[2].length==
0,t[2].length==0)||goog.string.compareElements_(o[2],t[2])}while(f==0)}return f};goog.string.compareElements_=function(d,e){if(d<e)return-1;else if(d>e)return 1;return 0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(d){for(var e=0,f=0;f<d.length;++f){e=31*e+d.charCodeAt(f);e%=goog.string.HASHCODE_MAX_}return e};goog.string.uniqueStringCounter_=Math.random()*2147483648|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(d){var e=Number(d);if(e==0&&goog.string.isEmpty(d))return NaN;return e};goog.debug={};goog.debug.catchErrors=function(d,e,f){f=f||goog.global;var g=f.onerror;f.onerror=function(h,j,l){g&&g(h,j,l);j=String(j).split(/[\/\\]/).pop();d({message:h,fileName:j,line:l});return Boolean(e)}};goog.debug.expose=function(d,e){if(typeof d=="undefined")return"undefined";if(d==null)return"NULL";var f=[];for(var g in d)if(!(!e&&goog.isFunction(d[g]))){var h=g+" = ";try{h+=d[g]}catch(j){h+="*** "+j+" ***"}f.push(h)}return f.join("\n")};
goog.debug.deepExpose=function(d,e){var f=new goog.structs.Set,g=[],h=function(j,l){var q=l+"  ",x=function(p){return p.replace(/\n/g,"\n"+l)};try{if(goog.isDef(j))if(goog.isNull(j))g.push("NULL");else if(goog.isString(j))g.push('"'+x(j)+'"');else if(goog.isFunction(j))g.push(x(String(j)));else if(goog.isObject(j))if(f.contains(j))g.push("*** reference loop detected ***");else{f.add(j);g.push("{");for(var o in j)if(!(!e&&goog.isFunction(j[o]))){g.push("\n");g.push(q);g.push(o+" = ");h(j[o],q)}g.push("\n"+
l+"}")}else g.push(j);else g.push("undefined")}catch(t){g.push("*** "+t+" ***")}};h(d,"");return g.join("")};goog.debug.exposeArray=function(d){for(var e=[],f=0;f<d.length;f++)goog.isArray(d[f])?e.push(goog.debug.exposeArray(d[f])):e.push(d[f]);return"[ "+e.join(", ")+" ]"};
goog.debug.exposeException=function(d,e){try{var f=goog.debug.normalizeErrorObject(d);return"Message: "+goog.string.htmlEscape(f.message)+'\nUrl: <a href="view-source:'+f.fileName+'" target="_new">'+f.fileName+"</a>\nLine: "+f.lineNumber+"\n\nBrowser stack:\n"+goog.string.htmlEscape(f.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+goog.string.htmlEscape(goog.debug.getStacktrace(e)+"-> ")}catch(g){return"Exception trying to expose exception! You win, we lose. "+g}};
goog.debug.normalizeErrorObject=function(d){var e=goog.getObjectByName("window.location.href");return typeof d=="string"?{message:d,name:"Unknown error",lineNumber:"Not available",fileName:e,stack:"Not available"}:!d.lineNumber||!d.fileName||!d.stack?{message:d.message,name:d.name,lineNumber:d.lineNumber||d.line||"Not available",fileName:d.fileName||d.filename||d.sourceURL||e,stack:d.stack||"Not available"}:d};
goog.debug.enhanceError=function(d,e){var f=typeof d=="string"?Error(d):d;if(!f.stack)f.stack=goog.debug.getStacktrace(arguments.callee.caller);if(e){for(var g=0;f["message"+g];)++g;f["message"+g]=String(e)}return f};
goog.debug.getStacktraceSimple=function(d){for(var e=[],f=arguments.callee.caller,g=0;f&&(!d||g<d);){e.push(goog.debug.getFunctionName(f));e.push("()\n");try{f=f.caller}catch(h){e.push("[exception trying to get caller]\n");break}g++;if(g>=goog.debug.MAX_STACK_DEPTH){e.push("[...long stack...]");break}}d&&g>=d?e.push("[...reached max depth limit...]"):e.push("[end]");return e.join("")};goog.debug.MAX_STACK_DEPTH=50;
goog.debug.getStacktrace=function(d){return goog.debug.getStacktraceHelper_(d||arguments.callee.caller,[])};
goog.debug.getStacktraceHelper_=function(d,e){var f=[];if(goog.array.contains(e,d))f.push("[...circular reference...]");else if(d&&e.length<goog.debug.MAX_STACK_DEPTH){f.push(goog.debug.getFunctionName(d)+"(");for(var g=d.arguments,h=0;h<g.length;h++){h>0&&f.push(", ");var j;j=g[h];switch(typeof j){case "object":j=j?"object":"null";break;case "string":j=j;break;case "number":j=String(j);break;case "boolean":j=j?"true":"false";break;case "function":j=(j=goog.debug.getFunctionName(j))?j:"[fn]";break;
case "undefined":default:j=typeof j;break}if(j.length>40)j=j.substr(0,40)+"...";f.push(j)}e.push(d);f.push(")\n");try{f.push(goog.debug.getStacktraceHelper_(d.caller,e))}catch(l){f.push("[exception trying to get caller]\n")}}else d?f.push("[...long stack...]"):f.push("[end]");return f.join("")};goog.debug.getFunctionName=function(d){d=String(d);if(!goog.debug.fnNameCache_[d]){var e=/function ([^\(]+)/.exec(d);goog.debug.fnNameCache_[d]=e?e[1]:"[Anonymous]"}return goog.debug.fnNameCache_[d]};
goog.debug.makeWhitespaceVisible=function(d){return d.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")};goog.debug.fnNameCache_={};goog.debug.LogRecord=function(d,e,f,g,h){this.sequenceNumber_=typeof h=="number"?h:goog.debug.LogRecord.nextSequenceNumber_++;this.time_=g||goog.now();this.level_=d;this.msg_=e;this.loggerName_=f};goog.debug.LogRecord.prototype.exception_=null;goog.debug.LogRecord.prototype.exceptionText_=null;goog.debug.LogRecord.nextSequenceNumber_=0;a=goog.debug.LogRecord.prototype;a.getLoggerName=function(){return this.loggerName_};a.getException=function(){return this.exception_};
a.setException=function(d){this.exception_=d};a.getExceptionText=function(){return this.exceptionText_};a.setExceptionText=function(d){this.exceptionText_=d};a.setLoggerName=function(d){this.loggerName_=d};a.getLevel=function(){return this.level_};a.setLevel=function(d){this.level_=d};a.getMessage=function(){return this.msg_};a.setMessage=function(d){this.msg_=d};a.getMillis=function(){return this.time_};a.setMillis=function(d){this.time_=d};a.getSequenceNumber=function(){return this.sequenceNumber_};goog.debug.Logger=function(d){this.name_=d};goog.debug.Logger.prototype.parent_=null;goog.debug.Logger.prototype.level_=null;goog.debug.Logger.prototype.children_=null;goog.debug.Logger.prototype.handlers_=null;goog.debug.Logger.Level=function(d,e){this.name=d;this.value=e};goog.debug.Logger.Level.prototype.toString=function(){return this.name};goog.debug.Logger.Level.OFF=new goog.debug.Logger.Level("OFF",Infinity);goog.debug.Logger.Level.SHOUT=new goog.debug.Logger.Level("SHOUT",1200);
goog.debug.Logger.Level.SEVERE=new goog.debug.Logger.Level("SEVERE",1E3);goog.debug.Logger.Level.WARNING=new goog.debug.Logger.Level("WARNING",900);goog.debug.Logger.Level.INFO=new goog.debug.Logger.Level("INFO",800);goog.debug.Logger.Level.CONFIG=new goog.debug.Logger.Level("CONFIG",700);goog.debug.Logger.Level.FINE=new goog.debug.Logger.Level("FINE",500);goog.debug.Logger.Level.FINER=new goog.debug.Logger.Level("FINER",400);goog.debug.Logger.Level.FINEST=new goog.debug.Logger.Level("FINEST",300);
goog.debug.Logger.Level.ALL=new goog.debug.Logger.Level("ALL",0);goog.debug.Logger.Level.PREDEFINED_LEVELS=[goog.debug.Logger.Level.OFF,goog.debug.Logger.Level.SHOUT,goog.debug.Logger.Level.SEVERE,goog.debug.Logger.Level.WARNING,goog.debug.Logger.Level.INFO,goog.debug.Logger.Level.CONFIG,goog.debug.Logger.Level.FINE,goog.debug.Logger.Level.FINER,goog.debug.Logger.Level.FINEST,goog.debug.Logger.Level.ALL];goog.debug.Logger.Level.predefinedLevelsCache_=null;
goog.debug.Logger.Level.createPredefinedLevelsCache_=function(){goog.debug.Logger.Level.predefinedLevelsCache_={};for(var d=0,e;e=goog.debug.Logger.Level.PREDEFINED_LEVELS[d];d++){goog.debug.Logger.Level.predefinedLevelsCache_[e.value]=e;goog.debug.Logger.Level.predefinedLevelsCache_[e.name]=e}};
goog.debug.Logger.Level.getPredefinedLevel=function(d){goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_();return goog.debug.Logger.Level.predefinedLevelsCache_[d]||null};
goog.debug.Logger.Level.getPredefinedLevelByValue=function(d){goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_();if(d in goog.debug.Logger.Level.predefinedLevelsCache_)return goog.debug.Logger.Level.predefinedLevelsCache_[d];for(var e=0;e<goog.debug.Logger.Level.PREDEFINED_LEVELS.length;++e){var f=goog.debug.Logger.Level.PREDEFINED_LEVELS[e];if(f.value<=d)return f}return null};goog.debug.Logger.getLogger=function(d){return goog.debug.LogManager.getLogger(d)};
a=goog.debug.Logger.prototype;a.getName=function(){return this.name_};a.addHandler=function(d){if(!this.handlers_)this.handlers_=[];this.handlers_.push(d)};a.removeHandler=function(d){return!!this.handlers_&&goog.array.remove(this.handlers_,d)};a.getParent=function(){return this.parent_};a.getChildren=function(){if(!this.children_)this.children_={};return this.children_};a.setLevel=function(d){this.level_=d};a.getLevel=function(){return this.level_};
a.getEffectiveLevel=function(){if(this.level_)return this.level_;if(this.parent_)return this.parent_.getEffectiveLevel();return null};a.isLoggable=function(d){if(this.level_)return d.value>=this.level_.value;if(this.parent_)return this.parent_.isLoggable(d);return false};a.log=function(d,e,f){this.isLoggable(d)&&this.doLogRecord_(this.getLogRecord(d,e,f))};
a.getLogRecord=function(d,e,f){var g=new goog.debug.LogRecord(d,String(e),this.name_);if(f){g.setException(f);g.setExceptionText(goog.debug.exposeException(f,arguments.callee.caller))}return g};a.shout=function(d,e){this.log(goog.debug.Logger.Level.SHOUT,d,e)};a.severe=function(d,e){this.log(goog.debug.Logger.Level.SEVERE,d,e)};a.warning=function(d,e){this.log(goog.debug.Logger.Level.WARNING,d,e)};a.info=function(d,e){this.log(goog.debug.Logger.Level.INFO,d,e)};
a.config=function(d,e){this.log(goog.debug.Logger.Level.CONFIG,d,e)};a.fine=function(d,e){this.log(goog.debug.Logger.Level.FINE,d,e)};a.finer=function(d,e){this.log(goog.debug.Logger.Level.FINER,d,e)};a.finest=function(d,e){this.log(goog.debug.Logger.Level.FINEST,d,e)};a.logRecord=function(d){this.isLoggable(d.getLevel())&&this.doLogRecord_(d)};a.doLogRecord_=function(d){for(var e=this;e;){e.callPublish_(d);e=e.getParent()}};a.callPublish_=function(d){if(this.handlers_)for(var e=0,f;f=this.handlers_[e];e++)f(d)};
a.setParent_=function(d){this.parent_=d};a.addChild_=function(d,e){this.getChildren()[d]=e};goog.debug.LogManager={};goog.debug.LogManager.loggers_={};goog.debug.LogManager.rootLogger_=null;goog.debug.LogManager.initialize=function(){if(!goog.debug.LogManager.rootLogger_){goog.debug.LogManager.rootLogger_=new goog.debug.Logger("");goog.debug.LogManager.loggers_[""]=goog.debug.LogManager.rootLogger_;goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG)}};
goog.debug.LogManager.getLoggers=function(){return goog.debug.LogManager.loggers_};goog.debug.LogManager.getRoot=function(){goog.debug.LogManager.initialize();return goog.debug.LogManager.rootLogger_};goog.debug.LogManager.getLogger=function(d){goog.debug.LogManager.initialize();return goog.debug.LogManager.loggers_[d]||goog.debug.LogManager.createLogger_(d)};
goog.debug.LogManager.createFunctionForCatchErrors=function(d){return function(e){(d||goog.debug.LogManager.getRoot()).severe("Error: "+e.message+" ("+e.fileName+" @ Line: "+e.line+")")}};goog.debug.LogManager.createLogger_=function(d){var e=new goog.debug.Logger(d),f=d.lastIndexOf("."),g=d.substr(0,f);f=d.substr(f+1);g=goog.debug.LogManager.getLogger(g);g.addChild_(f,e);e.setParent_(g);return goog.debug.LogManager.loggers_[d]=e};kemia.model.Reaction=function(){this.header="";this.reactants=[];this.products=[];this.arrows=[];this.pluses=[];this.conditionsText=this.reagentsText=""};a=kemia.model.Reaction.prototype;a.addReactant=function(d){this.reactants.push(d);d.reaction=this};a.addProduct=function(d){this.products.push(d);d.reaction=this};a.isReactant=function(d){return goog.array.contains(this.reactants,d)};a.isProduct=function(d){return goog.array.contains(this.products,d)};
a.removeMolecule=function(d){if(goog.array.contains(this.reactants,d)){goog.array.remove(this.reactants,d);d.reaction=undefined}else if(goog.array.contains(this.products,d)){goog.array.remove(this.products,d);d.reaction=undefined}};a.addArrow=function(d){this.arrows.push(d);d.reaction=this};a.removeArrow=function(d){goog.array.remove(this.arrows,d);d.reaction=undefined};a.addPlus=function(d){this.pluses.push(d);d.reaction=this};
a.removePlus=function(d){goog.array.remove(this.pluses,d);d.reaction=undefined};a.removeArrowOrPlus=function(d){if(goog.array.contains(this.arrows,d))this.removeArrow(d);else goog.array.contains(this.pluses,d)&&this.removePlus(d)};a.generatePlusCoords=function(d){var e;goog.array.forEach(d,function(f){e&&this.addPlus(this.center([e,f]));e=f},this)};
a.generateArrowCoords=function(d,e){d=this.boundingBox(d);e=this.boundingBox(e);this.addArrow(new goog.math.Coordinate((d.right+e.left)/2,(d.top+e.bottom)/2))};a.boundingBox=function(d){d=goog.array.flatten(goog.array.map(d,function(e){return e.atoms}));d=goog.array.map(d,function(e){return e.coord});return goog.math.Box.boundingBox.apply(null,d)};a.center=function(d){d=this.boundingBox(d);return new goog.math.Coordinate((d.left+d.right)/2,(d.top+d.bottom)/2)};
a.removeOverlap=function(){var d=goog.array.concat(this.reactants,this.products),e;goog.array.forEach(d,function(f){var g=goog.math.Rect.createFromBox(this.boundingBox([f]));if(e){goog.math.Rect.intersection(e,g)&&this.translateMolecule(f,new goog.math.Coordinate(4+e.left+e.width-g.left,0));e.boundingRect(goog.math.Rect.createFromBox(this.boundingBox([f])))}else e=g},this)};a.translateMolecule=function(d,e){goog.array.forEach(d.atoms,function(f){f.coord=goog.math.Coordinate.sum(f.coord,e)});return d};
a.rotateMolecule=function(d,e,f){var g=kemia.graphics.AffineTransform.getRotateInstance(goog.math.toRadians(e),f.x,f.y);goog.array.forEach(d.atoms,function(h){h.coord=g.transformCoords([h.coord])[0]});return d};kemia.io={};kemia.io.smiles={};kemia.io.smiles.SmilesParser={};kemia.io.smiles.SmilesParser.BondType={NONE:"NONE",SINGLE_BOND:"-",DOUBLE_BOND:"=",TRIPLE_BOND:"#",QUAD_BOND:"$",AROMATIC_BOND:":",ANY:"~"};kemia.io.smiles.SmilesParser.BondStereo={NONE:"NONE",CLOCKWISE:"@",COUNTER_CLOCKWISE:"@@"};
kemia.io.smiles.SmilesParser.punctuation={nobond:".",openbranch:"(",closebranch:")",singlebond:kemia.io.smiles.SmilesParser.BondType.SINGLE_BOND,doublebond:kemia.io.smiles.SmilesParser.BondType.DOUBLE_BOND,triplebond:kemia.io.smiles.SmilesParser.BondType.TRIPLE_BOND,quadbond:kemia.io.smiles.SmilesParser.BondType.QUAD_BOND,aromaticbond:kemia.io.smiles.SmilesParser.BondType.AROMATIC_BOND,ringclosure:"%",cis:"/",trans:"\\"};kemia.io.smiles.SmilesParser.smiPattern=new RegExp(/\[[^[]+\]|Br|B|Cl|C|N|F|O|P]|S|c|n|o|s|-|=|#|%[0-9][0-9]|[0-9]|\(|\)|./g);
kemia.io.smiles.SmilesParser.atomPattern=new RegExp(/^\[([0-9]*)([A-Z][a-z]?|c|n|o|se|s|as)(@|@@)?(H)?([0-9])?([+-][\d]?)?\]$/);kemia.io.smiles.SmilesParser.specialAtoms={C:1,c:1,N:1,n:1,O:1,o:1,S:1,s:1,P:1,F:1,Br:1,Cl:1,I:1,B:1};kemia.io.smiles.SmilesParser.aromaticAtoms={c:1,n:1,o:1,s:1,as:1,se:1};
kemia.io.smiles.SmilesParser.parse=function(d){items=d.match(this.smiPattern);for(var e=new kemia.model.Molecule(d),f=0,g,h=kemia.io.smiles.SmilesParser.BondType.NONE,j=[],l=[],q="",x=[],o=0;o<items.length;o++){var t=items[o];if(t!=this.punctuation.nobond)if(t==this.punctuation.openbranch)j.push(g);else if(t==this.punctuation.closebranch)if(j.length)g=j.pop();else q=" unbalanced parens";else if(t==this.punctuation.singlebond)h=kemia.io.smiles.SmilesParser.BondType.SINGLE_BOND;else if(t==this.punctuation.doublebond)h=
kemia.io.smiles.SmilesParser.BondType.DOUBLE_BOND;else if(t==this.punctuation.triplebond)h=kemia.io.smiles.SmilesParser.BondType.TRIPLE_BOND;else if(t==this.punctuation.quadbond)h=kemia.io.smiles.SmilesParser.BondType.QUAD_BOND;else if(t==this.punctuation.aromaticbond)h=kemia.io.smiles.SmilesParser.BondType.AROMATIC_BOND;else if(t[0]==this.punctuation.ringclosure){ringid=parseInt(t[1]+t[2]);if(ring_atom=l[ringid]){e.addBond(this.createBond(h,g,ring_atom));h=kemia.io.smiles.SmilesParser.BondType.NONE;
l[ringid]=null}else l[ringid]=g}else if(t!=this.punctuation.cis)if(t!=this.punctuation.trans)if(isNaN(ringid=parseInt(t))){smi_atom=this.parseAtom(t,x);if(smi_atom.symbol){f+=1;t=new kemia.model.Atom(smi_atom.symbol,0,0,smi_atom.charge,smi_atom.aromatic,smi_atom.isotope);if(g){e.addBond(this.createBond(h,g,t));h=kemia.io.smiles.SmilesParser.BondType.NONE}e.addAtom(t);if(smi_atom.stereo!="NONE"){x.push(e.indexOfAtom(t));x.push(smi_atom.stereo);x.push(smi_atom.chiralHydrogenNeighbour)}g=t}else q=" unknown atom "+
t}else if(ring_atom=l[ringid]){e.addBond(this.createBond(h,g,ring_atom));h=kemia.io.smiles.SmilesParser.BondType.NONE;l[ringid]=null}else l[ringid]=g;if(q)throw new Error(d+q);}this.setChiralCenters(e,x);return this.sanityCheck(j,l,h)?e:null};kemia.io.smiles.SmilesParser.sanityCheck=function(d,e,f){if(d.length)throw new Error(smi+" unbalanced parens");for(d=0;d<e.length;++d)if(e[d])throw new Error(smi+" unclosed rings");if(f!=this.BondType.NONE)throw new Error(smi+" unpaired bond "+f);return true};
kemia.io.smiles.SmilesParser.parseAtom=function(d){var e={isotope:null,symbol:null,stereo:kemia.io.smiles.SmilesParser.BondStereo.NONE,hcount:null,charge:null,aromatic:false,chiralHydrogenNeighbour:false},f=this.atomPattern.exec(d);if(f){e.isotope=f[1];if(this.periodicTable[f[2]])e.symbol=f[2];if(f[3]==kemia.io.smiles.SmilesParser.BondStereo.CLOCKWISE||f[3]==kemia.io.smiles.SmilesParser.BondStereo.COUNTER_CLOCKWISE){e.stereo=f[3];if(f[4]=="H")e.chiralHydrogenNeighbour=true}else e.stereo=kemia.io.smiles.SmilesParser.BondStereo.NONE;
if(f[4]=="H")e.hcount=f[5]?f[5]:1;e.charge=f[6]=="+"?1:f[6]=="-"?-1:parseInt(f[6])}else if(this.specialAtoms[d])e.symbol=d;if(this.aromaticAtoms[e.symbol]){e.aromatic=true;e.symbol=e.symbol.length==1?e.symbol.toUpperCase():e.symbol[0].toUpperCase()+e.symbol[1]}return e};
kemia.io.smiles.SmilesParser.createBond=function(d,e,f){var g=d;if(d==kemia.io.smiles.SmilesParser.BondType.NONE)g=e.aromatic&&f.aromatic?kemia.io.smiles.SmilesParser.BondType.AROMATIC_BOND:kemia.io.smiles.SmilesParser.BondType.SINGLE_BOND;switch(g){case kemia.io.smiles.SmilesParser.BondType.SINGLE_BOND:return new kemia.model.Bond(e,f,kemia.model.Bond.ORDER.SINGLE);case kemia.io.smiles.SmilesParser.BondType.DOUBLE_BOND:return new kemia.model.Bond(e,f,kemia.model.Bond.ORDER.DOUBLE);case kemia.io.smiles.SmilesParser.BondType.TRIPLE_BOND:return new kemia.model.Bond(e,
f,kemia.model.Bond.ORDER.TRIPLE);case kemia.io.smiles.SmilesParser.BondType.AROMATIC_BOND:d=new kemia.model.Bond(e,f);d.aromatic=true;return d;case kemia.io.smiles.SmilesParser.BondType.ANY:default:throw new Error("invalid bond type/stereo ["+d+"]/["+stereo+"]");}};
kemia.io.smiles.SmilesParser.setChiralCenters=function(d,e){c=0;for(centers=e.length;c<centers;c++){atIndex=e[c];chiralAtom=d.getAtom(atIndex);if(chiralAtom!=undefined){var f=e[++c];++c;var g=[],h=0,j=null;goog.array.forEach(d.atoms,function(q){bond_=d.findBond(chiralAtom,q);if(bond_!=null&&bond_!=undefined){if(bond_.source!=chiralAtom){bond_.source=chiralAtom;bond_.target=q}h++;d.isBondInRing(bond_)||g.push(bond_)}});var l=g.length;if((h==3||h==4)&&l>0){bondidx=0;if(h==3&&l>1||h==4&&l>2)bondidx=
1;j=g[bondidx];j.stereo=f==kemia.io.smiles.SmilesParser.BondStereo.CLOCKWISE?kemia.model.Bond.STEREO.UP:kemia.model.Bond.STEREO.DOWN}if(h==4&&l>1){bondidx=1;if(l==4)bondidx=3;else if(l==4)bondidx=2;j=g[bondidx];j.stereo=f==kemia.io.smiles.SmilesParser.BondStereo.CLOCKWISE?kemia.model.Bond.STEREO.DOWN:kemia.model.Bond.STEREO.UP}}}};
kemia.io.smiles.SmilesParser.periodicTable={H:{number:1,name:"Hydrogen"},He:{number:2,name:"Helium"},Li:{number:3,name:"Lithium"},Be:{number:4,name:"Beryllium"},B:{number:5,name:"Boron"},C:{number:6,name:"Carbon"},c:{number:6,name:"Carbon"},N:{number:7,name:"Nitrogen"},n:{number:7,name:"Nitrogen"},O:{number:8,name:"Oxygen"},o:{number:8,name:"Oxygen"},F:{number:9,name:"Fluorine"},Ne:{number:10,name:"Neon"},Na:{number:11,name:"Sodium"},Mg:{number:12,name:"Magnesium"},Al:{number:13,name:"Aluminium"},
Si:{number:14,name:"Silicon"},P:{number:15,name:"Phosphorus"},S:{number:16,name:"Sulfur"},s:{number:16,name:"Sulfur"},Cl:{number:17,name:"Chlorine"},Ar:{number:18,name:"Argon"},K:{number:19,name:"Potassium"},Ca:{number:20,name:"Calcium"},Sc:{number:21,name:"Scandium"},Ti:{number:22,name:"Titanium"},V:{number:23,name:"Vanadium"},Cr:{number:24,name:"Chromium"},Mn:{number:25,name:"Manganese"},Fe:{number:26,name:"Iron"},Co:{number:27,name:"Cobalt"},Ni:{number:28,name:"Nickel"},Cu:{number:29,name:"Copper"},
Zn:{number:30,name:"Zinc"},Ga:{number:31,name:"Gallium"},Ge:{number:32,name:"Germanium"},As:{number:33,name:"Arsenic"},as:{number:33,name:"Arsenic"},Se:{number:34,name:"Selenium"},se:{number:34,name:"Selenium"},Br:{number:35,name:"Bromine"},Kr:{number:36,name:"Krypton"},Rb:{number:37,name:"Rubidium"},Sr:{number:38,name:"Strontium"},Y:{number:39,name:"Yttrium"},Zr:{number:40,name:"Zirconium"},Nb:{number:41,name:"Niobium"},Mo:{number:42,name:"Molybdenum"},Tc:{number:43,name:"Technetium"},Ru:{number:44,
name:"Ruthenium"},Rh:{number:45,name:"Rhodium"},Pd:{number:46,name:"Palladium"},Ag:{number:47,name:"Silver"},Cd:{number:48,name:"Cadmium"},In:{number:49,name:"Indium"},Sn:{number:50,name:"Tin"},Sb:{number:51,name:"Antimony"},Te:{number:52,name:"Tellurium"},I:{number:53,name:"Iodine"},Xe:{number:54,name:"Xenon"},Cs:{number:55,name:"Caesium"},Ba:{number:56,name:"Barium"},La:{number:57,name:"Lanthanum"},Ce:{number:58,name:"Cerium"},Pr:{number:59,name:"Praseodymium"},Nd:{number:60,name:"Neodymium"},Pm:{number:61,
name:"Promethium"},Sm:{number:62,name:"Samarium"},Eu:{number:63,name:"Europium"},Gd:{number:64,name:"Gadolinium"},Tb:{number:65,name:"Terbium"},Dy:{number:66,name:"Dysprosium"},Ho:{number:67,name:"Holmium"},Er:{number:68,name:"Erbium"},Tm:{number:69,name:"Thulium"},Yb:{number:70,name:"Ytterbium"},Lu:{number:71,name:"Lutetium"},Hf:{number:72,name:"Hafnium"},Ta:{number:73,name:"Tantalum"},W:{number:74,name:"Tungsten"},Re:{number:75,name:"Rhenium"},Os:{number:76,name:"Osmium"},Ir:{number:77,name:"Iridium"},
Pt:{number:78,name:"Platinum"},Au:{number:79,name:"Gold"},Hg:{number:80,name:"Mercury"},Tl:{number:81,name:"Thallium"},Pb:{number:82,name:"Lead"},Bi:{number:83,name:"Bismuth"},Po:{number:84,name:"Polonium"},At:{number:85,name:"Astatine"},Rn:{number:86,name:"Radon"},Fr:{number:87,name:"Francium"},Ra:{number:88,name:"Radium"},Ac:{number:89,name:"Actinium"},Th:{number:90,name:"Thorium"},Pa:{number:91,name:"Protactinium"},U:{number:92,name:"Uranium"},Np:{number:93,name:"Neptunium"},Pu:{number:94,name:"Plutonium"},
Am:{number:95,name:"Americium"},Cm:{number:96,name:"Curium"},Bk:{number:97,name:"Berkelium"},Cf:{number:98,name:"Californium"},Es:{number:99,name:"Einsteinium"},Fm:{number:100,name:"Fermium"},Md:{number:101,name:"Mendelevium"},No:{number:102,name:"Nobelium"},Lr:{number:103,name:"Lawrencium"},Rf:{number:104,name:"Rutherfordium"},Db:{number:105,name:"Dubnium"},Sg:{number:106,name:"Seaborgium"},Bh:{number:107,name:"Bohrium"},Hs:{number:108,name:"Hassium"},Mt:{number:109,name:"Meitnerium"},Ds:{number:110,
name:"Darmstadtium"},Rg:{number:111,name:"Roentgenium"},Cn:{number:112,name:"Copernicium"}};kemia.query.MoleculeCompiler={};(function(){kemia.query.MoleculeCompiler={};kemia.query.MoleculeCompiler.compile=function(d){for(var e=new kemia.query.Query,f=0,g=d.countAtoms();f<g;f++){var h=new kemia.query.QueryAtom;h.symbols.push(d.getAtom(f).symbol);e.addAtom(h)}f=0;for(g=d.countBonds();f<g;f++){h=d.bonds[f];var j=e.getAtom(d.indexOfAtom(h.source)),l=e.getAtom(d.indexOfAtom(h.target));j=new kemia.query.QueryBond(j,l);j.orders.push(h.order);e.addBond(j)}return e}})();kemia.query.SmilesCompiler={};(function(){kemia.query.SmilesCompiler={};kemia.query.SmilesCompiler.compile=function(d){d=kemia.io.smiles.SmilesParser.parse(d);return kemia.query.MoleculeCompiler.compile(d)}})();
