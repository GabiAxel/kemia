var aa=this;function t(d,f,e){d=d.split(".");e=e||aa;!(d[0]in e)&&e.execScript&&e.execScript("var "+d[0]);for(var g;d.length&&(g=d.shift());)if(!d.length&&f!==undefined)e[g]=f;else e=e[g]?e[g]:(e[g]={})}
function ba(d){var f=typeof d;if(f=="object")if(d){if(d instanceof Array||!(d instanceof Object)&&Object.prototype.toString.call(d)=="[object Array]"||typeof d.length=="number"&&typeof d.splice!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("splice"))return"array";if(!(d instanceof Object)&&(Object.prototype.toString.call(d)=="[object Function]"||typeof d.call!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("call")))return"function"}else return"null";
else if(f=="function"&&typeof d.call=="undefined")return"object";return f}function v(d){var f=ba(d);return f=="array"||f=="object"&&typeof d.length=="number"}function w(d){return typeof d=="string"}function ca(d){if(d.hasOwnProperty&&d.hasOwnProperty(x))return d[x];d[x]||(d[x]=++da);return d[x]}var x="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),da=0;var z=Array.prototype,A=z.indexOf?function(d,f,e){return z.indexOf.call(d,f,e)}:function(d,f,e){e=e==null?0:e<0?Math.max(0,d.length+e):e;if(w(d)){if(!w(f)||f.length!=1)return-1;return d.indexOf(f,e)}for(e=e;e<d.length;e++)if(e in d&&d[e]===f)return e;return-1},ea=z.forEach?function(d,f,e){z.forEach.call(d,f,e)}:function(d,f,e){for(var g=d.length,j=w(d)?d.split(""):d,h=0;h<g;h++)h in j&&f.call(e,j[h],h,d)},fa=z.map?function(d,f,e){return z.map.call(d,f,e)}:function(d,f,e){for(var g=d.length,j=new Array(g),
h=w(d)?d.split(""):d,m=0;m<g;m++)if(m in h)j[m]=f.call(e,h[m],m,d);return j};function ga(d,f,e){ha(d,e,0,f)}function B(d,f){f=A(d,f);var e;if(e=f>=0)C(d,f);return e}function C(d,f){return z.splice.call(d,f,1).length==1}function ha(d){return z.splice.apply(d,ia(arguments,1))}function ia(d,f,e){return arguments.length<=2?z.slice.call(d,f):z.slice.call(d,f,e)}
function ja(d,f,e){if(!v(d)||!v(f)||d.length!=f.length)return false;var g=d.length;e=e||ka;for(var j=0;j<g;j++)if(!e(d[j],f[j]))return false;return true}function la(d,f){return d>f?1:d<f?-1:0}function ka(d,f){return d===f}function D(d,f){for(var e=[],g=0;g<f;g++)e[g]=d;return e};function E(d){var f=[],e=0;for(var g in d)f[e++]=d[g];return f};function ma(d){if(typeof d.j=="function")return d.j();if(w(d))return d.split("");if(v(d)){for(var f=[],e=d.length,g=0;g<e;g++)f.push(d[g]);return f}return E(d)};function F(d){this.k={};this.d=[];var f=arguments.length;if(f>1){if(f%2)throw Error("Uneven number of arguments");for(var e=0;e<f;e+=2)G(this,arguments[e],arguments[e+1])}else d&&this.J(d)}F.prototype.u=0;F.prototype.V=0;F.prototype.G=function(){return this.u};F.prototype.j=function(){H(this);for(var d=[],f=0;f<this.d.length;f++)d.push(this.k[this.d[f]]);return d};
F.prototype.remove=function(d){if(Object.prototype.hasOwnProperty.call(this.k,d)){delete this.k[d];this.u--;this.V++;this.d.length>2*this.u&&H(this);return true}return false};function H(d){if(d.u!=d.d.length){for(var f=0,e=0;f<d.d.length;){var g=d.d[f];if(Object.prototype.hasOwnProperty.call(d.k,g))d.d[e++]=g;f++}d.d.length=e}if(d.u!=d.d.length){var j={};for(e=f=0;f<d.d.length;){g=d.d[f];if(!Object.prototype.hasOwnProperty.call(j,g)){d.d[e++]=g;j[g]=1}f++}d.d.length=e}}
function G(d,f,e){if(!Object.prototype.hasOwnProperty.call(d.k,f)){d.u++;d.d.push(f);d.V++}d.k[f]=e}F.prototype.J=function(d){var f;if(d instanceof F){H(d);f=d.d.concat();d=d.j()}else{f=[];var e=0;for(var g in d)f[e++]=g;f=f;d=E(d)}for(e=0;e<f.length;e++)G(this,f[e],d[e])};function I(d){this.k=new F;d&&this.J(d)}function J(d){var f=typeof d;return f=="object"&&d||f=="function"?"o"+ca(d):f.substr(0,1)+d}I.prototype.G=function(){return this.k.G()};I.prototype.add=function(d){G(this.k,J(d),d)};I.prototype.J=function(d){d=ma(d);for(var f=d.length,e=0;e<f;e++)this.add(d[e])};I.prototype.remove=function(d){return this.k.remove(J(d))};I.prototype.j=function(){return this.k.j()};function na(d,f){this.a=d;this.b=f;for(var e=f=0,g=0,j=d.length;g<j;g++){f+=d[g].K.x;e+=d[g].K.y}this.qc=new K(f/d.length,e/d.length);this.Y=new Array(3)};function L(d){this.a=d}function oa(d){var f=d.a.length-1;return d.a.length>2&&d.a[0]==d.a[f]}
L.prototype.splice=function(d){var f;var e=d.a;f=this.a.length-1;var g=e.length-1;if(this.a[f]==e[0]||this.a[f]==e[g])f=this.a[f];else if(this.a[0]==e[0]||this.a[0]==e[g])f=this.a[0];else throw"Couldn't splice - no intersection";e=[];g=0;for(var j=this.a.length;g<j;g++)e.push(this.a[g]);this.a[0]==f&&e.reverse();if(d.a[0]==f){g=1;for(j=d.a.length;g<j;g++)e.push(d.a[g])}else for(g=d.a.length-2;g>=0;g--)e.push(d.a[g]);a:{d=1;for(f=e.length-1;d<f;d++)for(g=1;g<f;g++)if(d!=g)if(e[d]==e[g]){d=false;break a}d=
true}if(!d)return null;return new L(e)};function pa(d){this.n=[];this.a=[];for(var f=0,e=d.q();f<e;f++){bond=d.b[f];this.n.push(new L([bond.source,bond.target]))}f=0;for(e=d.a.length;f<e;f++)this.a.push(d.c(f))}
pa.prototype.remove=function(d,f){for(var e=[],g=0,j=this.n.length;g<j;g++){var h=this.n[g];if(oa(h))A(h.a,d)>=0&&e.push(h);else{var m=h.a.length-1;if(h.a[0]==d||h.a[m]==d)e.push(h)}}g=[];h=0;for(m=e.length;h<m;h++)oa(e[h])&&g.push(e[h]);h=0;for(m=g.length;h<m;h++){A(e,g[h])>=0&&B(e,g[h]);A(this.n,g[h])>=0&&B(this.n,g[h])}j=[];h=0;for(m=e.length;h<m;h++)for(var l=h+1;l<m;l++){var k=e[l].splice(e[h]);k!=null&&j.push(k)}h=0;for(m=e.length;h<m;h++)A(this.n,e[h])>=0&&B(this.n,e[h]);h=0;for(m=j.length;h<
m;h++)!(A(this.n,j[h])>=0)&&j[h].a.length<=f+1&&this.n.push(j[h]);B(this.a,d);return g};function qa(d){for(var f=[],e=0,g=d.length;e<g;e++){var j=d[e];j instanceof Array?f.push(qa(j)):f.push(j)}return f}function ra(d,f,e){if(d.length)d.push(f[0].concat(e[0]));else d[0]=f[0].concat(e[0])}function sa(d,f){return d.Cnum-f.Cnum}
function M(d,f,e,g){for(var j=0,h=f.length;j<h;j++){var m=f[j];if(d.length>=m.length){for(var l=true,k=0,n=m.length;k<n;k++)A(d,m[k])>=0||(l=false);if(l)return true}k=0;for(n=d.length;k<n;k++)A(m,d[k])>=0&&g[k]++}f=false;k=0;for(n=d.length;k<n;k++)if(g[d[k]]<e[d[k]]-1)f=true;if(f){k=0;for(n=d.length;k<n;k++)g[d[k]]++;return false}return true}function ta(d,f){for(var e=[],g=0,j=d.length;g<j;g++){var h=f.b[d[g]],m=f.e(h.source);h=f.e(h.target);A(e,m)>=0||e.push(m);A(e,h)>=0||e.push(h)}return e}
function ua(d,f){for(var e=[d[0]],g=f.c(d[0]),j=0;d.length!=e.length;){j++;if(j>1E3)break;for(var h=1,m=d.length;h<m;h++){var l=f.c(e[e.length-1]),k=f.c(d[h]);if(!(A(e,d[h])>=0))if(f.g(l,k))e.push(d[h]);else f.g(g,k)&&ga(e,d[h],0)}}return e}
function O(d){var f=d.q()-d.a.length+1;if(!f)return[];var e;e=d.a.length;for(var g=[],j=0;j<e;j++){for(var h=[],m=0;m<e;m++)if(j==m)h.push(0);else d.g(d.c(j),d.c(m))?h.push(1):h.push(99999999);g.push(h)}j=[];for(h=0;h<e;h++){m=[];for(var l=0;l<e;l++){var k=d.g(d.c(h),d.c(l));k?m.push([[A(d.b,k)]]):m.push([])}j.push(m)}h=[];for(m=0;m<e;m++){l=[];for(k=0;k<e;k++)l.push([]);h.push(l)}for(m=0;m<e;m++)for(l=0;l<e;l++)for(k=0;k<e;k++){var n=g[l][k],q=g[l][m]+g[m][k],o=j[l][m],p=j[m][k];if(q!=1E8)if(n>q){h[l][k]=
n==q+1?qa(j[l][k]):[];g[l][k]=q;j[l][k]=[o[0].concat(p[0])]}else if(n==q)o.length&&p.length&&ra(j[l][k],o,p);else if(n==q-1)ra(h[l][k],o,p);else g[l][k]=g[l][k]}e={D:g,Pe1:j,Pe2:h};g=e.D;j=e.Pe1;h=e.Pe2;m=g.length;e=[];for(l=0;l<m;l++)for(k=0;k<m;k++)g[l][k]==0||j[l][k].length==1&&h[l][k].length==0||e.push({Cnum:h[l][k].length?2*(g[l][k]+0.5):2*g[l][k],Pe1:j[l][k],Pe2:h[l][k]});e.sort(sa);a:{g=[];j=[];h=0;for(m=d.a.length;h<m;h++)j.push(d.c(h).q());l=[];for(h=0;h<d.a.length;h++)l[h]=0;h=0;for(m=e.length;h<
m;h++){k=e[h];if(k.Cnum%2){n=0;for(q=k.Pe2.length;n<q;n++){o=o=k.Pe1[0].concat(k.Pe2[n]);p=ta(o,d);if(o.length===p.length)M(p,g,j,l)||g.push(p);if(g.length==f){f=g;break a}}}else{n=0;for(q=k.Pe1.length-1;n<q;n++){o=o=k.Pe1[n].concat(k.Pe1[n+1]);p=ta(o,d);if(o.length===p.length)M(p,g,j,l)||g.push(p);if(g.length==f){f=g;break a}}}}f=g}e=0;for(g=f.length;e<g;e++)f[e]=ua(f[e],d);return f}t("kemia.ring.SSSR.findRings",O,void 0);function va(d,f){for(var e=[],g=0,j=d.length;g<j;g++)e.push(f.c(d[g]));d=[];g=0;for(j=e.length-1;g<j;g++){var h=f.g(e[g],e[g+1]);h!=null&&d.push(h)}h=f.g(e[0],e[e.length-1]);h!=null&&d.push(h);return new na(e,d)}
function wa(d){if(!(d.q()-d.a.length+d.F))return[];for(var f=0,e=d.a.length;f<e;f++)d.a[f].index=f;f=0;for(e=d.b.length;f<e;f++)d.b[f].index=f;if(e=d.a.length){f=D(false,e);e=D(false,e);var g=[],j=d.a[0];j.m=0;g.push(j);for(f[0]=true;;){if(!g.length)break;j=g[0];C(g,0);for(var h=j.b.j(),m=0,l=h.length;m<l;m++){var k=h[m],n=k.index;if(!e[n]){e[n]=true;var q=P(k,j);k=q.index;if(f[k]){k=[];if(j.m==q.m){k.push(j);k.push(q)}else{q.B=true;var o=q.v();n=0;for(var p=o.length;n<p;n++){var s=o[n];s.m==q.m-
1&&k.push(s)}}for(q=j.m;;){k[0].B=true;k[1].B=true;q--;o=k[0].v();n=0;for(p=o.length;n<p;n++)if(o[n].m==q){k[0]=o[n];break}o=k[1].v();n=0;for(p=o.length;n<p;n++)if(o[n].m==q){k[1]=o[n];break}if(k[0]==k[1]){k[0].B=true;break}}}else{q.m=j.m+1;f[k]=true;g.push(q)}}}}}f=[];j=d.a.length;e=D(false,j);g=D(false,j);j=D(-1,j);h=0;for(m=d.a.length;h<m;h++){k=d.a[h];if(!e[k.index])if(k.B){l=new Q;p=[];p.push(k);e[0]=true;s=new R;s.H=k.index;j[k.index]=0;for(l.s(s);;){if(!p.length)break;q=p[0];C(p,0);o=q.b.j();
k=0;for(n=o.length;k<n;k++){var u=o[k];s=u.index;if(!g[s]){g[s]=true;u=P(u,q);s=u.index;if(u.B){if(e[s]){s=d.g(q,u);var y=new S(l.a[j[q.index]],l.a[j[u.index]]);y.H=s.index}else{e[s]=true;p.push(u);s=new R;s.H=u.index;j[u.index]=l.a.length;l.s(s);u=d.g(q,u);y=new S(l.a[j[q.index]],s);y.H=u.index}l.o(y)}}}}k=0;for(n=l.a.length;k<n;k++)l.a[k].index=k;k=0;for(n=l.b.length;k<n;k++)l.b[k].index=k;k=l.b.length-l.a.length+1;n=[];p=new pa(l);q=0;for(o=l.a.length;q<o;q++){s=p.remove(l.c(q),6);for(u=0;u<s.length;u++){y=
s[u].a;C(y,y.length-1);for(var N=0,Da=y.length;N<Da;N++)y[N]=y[N];n.push(y)}}z.sort.call(n,la);if(n.length>=k){a:{p=[];q=[];o=0;for(s=l.a.length;o<s;o++)q.push(l.c(o).q());u=D(0,l.a.length);o=0;for(s=n.length;o<s;o++){y=n[o];if(!M(y,p,q,u)){p.push(y);if(p.length==k){p=p;break a}}}p=p}if(p.length<k)p=O(l)}else p=O(l);k=0;for(n=p.length;k<n;k++){q=p[k];o=0;for(s=q.length;o<s;o++)q[o]=l.a[q[o]].H}k=0;for(l=p.length;k<l;k++)f.push(va(p[k],d))}}return f};function K(d,f){this.x=d!==undefined?d:0;this.y=f!==undefined?f:0}K.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function R(d,f,e,g,j,h){this.f=d!==undefined?d:"C";this.K=new K(f!==undefined?f:0,e!==undefined?e:0);this.b=new I;this.A=g!==undefined?g:0;this.L=h!==undefined?h:0;this.p=j!==undefined?j:false;this.oc=null;this.Y=new Array(3)}t("kemia.model.Atom",R,void 0);R.prototype.q=function(){return this.b.G()};R.prototype.v=function(){for(var d=this.b.j(),f=[],e=0,g=d.length;e<g;e++)f.push(P(d[e],this));return f};function Q(d){this.b=[];this.a=[];this.name=d?d:"";this.I=[];this.R=true;this.i=[];this.F=0}t("kemia.model.Molecule",Q,void 0);Q.prototype.o=function(d){var f=this.e(d.source),e=this.e(d.target);if(this.i[f]!=this.i[e]){var g;if(this.i[f]<this.i[e]){f=this.i[f];g=this.i[e]}else{g=this.i[f];f=this.i[e]}this.F--;e=0;for(var j=this.a.length;e<j;e++)if(this.i[e]==f)this.i[e]=g}this.b.push(d);d.source.b.add(d);d.target.b.add(d);d.Q=this};t("kemia.model.Molecule.prototype.addBond",Q.prototype.o,void 0);
Q.prototype.c=function(d){return this.a[d]};Q.prototype.g=function(d,f){for(var e=d.b.j(),g=0,j=e.length;g<j;g++){var h=e[g];if(P(h,d)==f)return h}return null};Q.prototype.e=function(d){return A(this.a,d)};Q.prototype.q=function(){return this.b.length};Q.prototype.s=function(d){var f=this.a.length;this.F++;this.i[f]=this.F;this.a.push(d);d.Q=this};t("kemia.model.Molecule.prototype.addAtom",Q.prototype.s,void 0);function xa(d){if(d.R){d.R=false;d.I=wa(d)}return d.I}
Q.prototype.toString=function(){return fa(this.a,function(d){return d.f+d.index+d.K.toString()}).toString()};function S(d,f,e,g,j,h){this.source=d;this.target=f;this.S=e!==undefined?e:T;this.t=g!==undefined?g:ya;this.p=j!==undefined?j:false;this.Q=h!==undefined?h:null}t("kemia.model.Bond",S,void 0);function P(d,f){if(f===d.source)return d.target;if(f===d.target)return d.source;return null}var T=1,ya=10;var za=3;za=3;
function Aa(d,f,e,g){switch(d){case 1:switch(f){case 0:return new S(e,g);case 1:return new S(e,g,T,11);case 4:return new S(e,g,T,12);case 6:return new S(e,g,T,13);default:throw new Error("invalid bond type/stereo ["+d+"]/["+f+"]");}case 2:return new S(e,g,2);case za:return new S(e,g,3);case 4:d=new S(e,g);d.p=true;return d;case 5:throw new Error("type not implemented ["+d+"]");case 6:throw new Error("type not implemented ["+d+"]");case 7:throw new Error("type not implemented ["+d+"]");case 8:throw new Error("type not implemented ["+
d+"]");default:throw new Error("invalid bond type/stereo ["+d+"]/["+f+"]");}}
function Ba(d){d=d.split(d.indexOf("\r\n")>0?"\r\n":"\n");for(var f=new Q(d[0]),e=parseInt(d[3].substr(0,3),10),g=parseInt(d[3].substr(3,3),10),j=1;j<=e;j++){var h=d[j+3],m=h.substr(30,4).replace(/(^\s*)|(\s*$)/g,""),l=parseFloat(h.substr(0,10)),k=parseFloat(h.substr(10,10));h=parseInt(h.substr(36,3),10);var n=0;if(h!=0)if(h==1)n=3;else if(h==2)n=2;else if(h==3)n=1;else if(h!=4)if(h==5)n=-1;else if(h==6)n=-2;else if(h==7)n=-3;h=new R(m,l,k,n);f.s(h)}for(j=1;j<=g;j++){h=d[j+3+e];n=f.c(parseInt(h.substr(0,
3),10)-1);m=f.c(parseInt(h.substr(3,3),10)-1);h=Aa(parseInt(h.substr(6,3),10),parseInt(h.substr(9,3),10),n,m);f.o(h)}j=4+e+g;e=d.length;for(g=false;;){h=d[j++];if(j==e||h.indexOf("M  END")>=0)break;if(h.indexOf("M  CHG")>=0){if(!g){n=0;for(g=f.a.length;n<g;n++)f.c(n).A=0;g=true}m=parseInt(h.substr(6,3),10);for(l=0;l<m;l++){k=parseInt(h.substr(10+8*l,3),10);n=parseInt(h.substr(14+8*l,3),10);f.c(k-1).A=n}}}return f}t("kemia.io.mdl.readMolfile",Ba,void 0);t("kemia.io.mdl.readMolfile",Ba,void 0);function Ca(d,f,e){this.type=d;this.h=f;this.w=e;this.I=xa(e);this.r=[];this.z=[];this.l=[]};function U(d){this.h=d}t("kemia.query.DFSMapper",U,void 0);function Ea(d,f){if(d.r.length===d.h.a.length){for(var e=new F,g=0,j=d.r.length;g<j;g++)G(e,d.h.e(d.r[g]),d.w.e(d.z[g]));if(d.type===1){d=e.j();d.sort(function(l,k){return l-k});var h=true;g=0;for(j=f.length;g<j;g++){var m=f[g].j();m.sort(function(l,k){return l-k});if(ja(d,m))h=false}h&&f.push(e)}else f.push(e)}}
function V(d,f,e,g){for(var j=f.v(),h=e.v(),m=[],l=0,k=j.length;l<k;l++)for(var n=j[l],q=0,o=h.length;q<o;q++)m.push({ea:f,U:n,da:e,T:h[q]});for(d.l.length?d.l.push(d.l[d.l.length-1].concat(m)):d.l.push(m);d.l[d.l.length-1].length;){f=d.l[d.l.length-1].pop();m=f.ea;h=f.da;e=f.U;j=f.T;if(A(d.r,e)!==-1)e=false;else if(A(d.z,j)!==-1)e=false;else if(e.C(j,d.w,d.I)){m=d.h.g(m,e);h=d.w.g(h,j);if(m.C(h,d.w)){d.r.push(e);d.z.push(j);Ea(d,g);e=true}else e=false}else e=false;if(e){V(d,f.U,f.T,g);d.r.pop();
d.z.pop();d.l.pop()}}}U.prototype.aa=function(d){for(var f=[],e=this.h.c(0),g=0,j=d.a.length;g<j;g++){var h=new Ca(1,this.h,d),m=d.c(g);if(e.C(m))if(this.h.a.length>1){h.r.push(e);h.z.push(m);V(h,e,m,f)}else{var l=new F;G(l,h.h.e(e),h.w.e(m));f.push(l)}}return f};t("kemia.query.DFSMapper.prototype.mapUnique",U.prototype.aa,void 0);F.prototype.getCount=F.prototype.G;
U.prototype.$=function(d){for(var f=[],e=this.h.c(0),g=0,j=d.a.length;g<j;g++){var h=new Ca(0,this.h,d),m=d.c(g);if(e.C(m)){if(this.h.a.length>1){h.r.push(e);h.z.push(m);V(h,e,m,f)}else{d=new F;G(d,h.h.e(e),h.w.e(m));return d}if(f.length)return f[0]}}return new F};t("kemia.query.DFSMapper.prototype.mapFirst",U.prototype.$,void 0);var Fa=new RegExp(/\[[^[]+\]|Br|B|Cl|C|N|F|O|P]|S|c|n|o|s|-|=|#|%[0-9][0-9]|[0-9]|\(|\)|./g),Ga=new RegExp(/^\[([0-9]*)([A-Z][a-z]?|c|n|o|se|s|as)(@|@@)?(H)?([0-9])?([+-][\d]?)?\]$/),Ha=["C","c","N","n","O","o","S","s","P","F","Br","Cl","I","B"],Ia={X:1,ba:1,ca:1,fa:1,W:1,ga:1};
function Ja(d){for(var f=d.match(Fa),e=new Q(d),g=0,j,h="NONE",m=[],l=[],k="",n=[],q=0;q<f.length;q++){var o=f[q];if(o!=".")if(o=="(")m.push(j);else if(o==")")if(m.length)j=m.pop();else k=" unbalanced parens";else if(o=="-")h="-";else if(o=="=")h="=";else if(o=="#")h="#";else if(o=="$")h="$";else if(o==":")h=":";else if(o[0]=="%"){ringid=parseInt(o[1]+o[2],10);if(ring_atom=l[ringid]){e.o(W(h,j,ring_atom));h="NONE";l[ringid]=null}else l[ringid]=j}else if(o!="/")if(o!="\\")if(isNaN(ringid=parseInt(o,
10))){var p={L:null,f:null,t:"NONE",Z:null,A:null,p:false,P:false},s=Ga.exec(o);if(s){p.L=s[1];if(Ka[s[2]])p.f=s[2];if(s[3]=="@"||s[3]=="@@"){p.t=s[3];if(s[4]=="H")p.P=true}else p.t="NONE";if(s[4]=="H")p.Z=s[5]?s[5]:1;p.A=s[6]=="+"?1:s[6]=="-"?-1:parseInt(s[6],10)}else if(A(Ha,o)>=0)p.f=o;if(Ia[p.f]){p.p=true;p.f=p.f.length==1?p.f.toUpperCase():p.f[0].toUpperCase()+p.f[1]}smi_atom=p;if(smi_atom.f){g+=1;o=new R(smi_atom.f,0,0,smi_atom.A,smi_atom.p,smi_atom.L);if(j){e.o(W(h,j,o));h="NONE"}e.s(o);if(smi_atom.t!=
"NONE"){n.push(e.e(o));n.push(smi_atom.t);n.push(smi_atom.P)}j=o}else k=" unknown atom "+o}else if(ring_atom=l[ringid]){e.o(W(h,j,ring_atom));h="NONE";l[ringid]=null}else l[ringid]=j;if(k)throw new Error(d+k);}La(e,n);if(m.length)throw new Error(smi+" unbalanced parens");for(d=0;d<l.length;++d)if(l[d])throw new Error(smi+" unclosed rings");if(h!="NONE")throw new Error(smi+" unpaired bond "+h);return e}t("kemia.io.smiles.SmilesParser.parse",Ja,void 0);
function W(d,f,e){var g=d;if(d=="NONE")g=f.p&&e.p?":":"-";switch(g){case "-":return new S(f,e,T);case "=":return new S(f,e,2);case "#":return new S(f,e,3);case ":":d=new S(f,e);d.p=true;return d;case "~":default:throw new Error("invalid bond type/stereo ["+d+"]/["+stereo+"]");}}
function La(d,f){c=0;for(centers=f.length;c<centers;c++){var e=d.c(f[c]);if(e!=undefined){var g=f[++c];++c;var j=[],h=0,m=null;ea(d.a,function(k){bond_=d.g(e,k);if(bond_!=null&&bond_!=undefined){if(bond_.source!=e){bond_.source=e;bond_.target=k}h++;a:{k=bond_;rings=xa(d);r=0;for(ringCount=rings.length;r<ringCount;r++){b=0;for(bondCount=rings[r].b.length;b<bondCount;b++)if(k==rings[r].b[b]){k=true;break a}}k=false}k||j.push(bond_)}});var l=j.length;if((h==3||h==4)&&l>0){bondidx=0;if(h==3&&l>1||h==
4&&l>2)bondidx=1;m=j[bondidx];m.t=g=="@"?11:13}if(h==4&&l>1){bondidx=1;if(l==4)bondidx=3;else if(l==4)bondidx=2;m=j[bondidx];m.t=g=="@"?13:11}}}}
var Ka={Wa:{number:1,name:"Hydrogen"},Xa:{number:2,name:"Helium"},hb:{number:3,name:"Lithium"},sa:{number:4,name:"Beryllium"},qa:{number:5,name:"Boron"},xa:{number:6,name:"Carbon"},X:{number:6,name:"Carbon"},pb:{number:7,name:"Nitrogen"},ba:{number:7,name:"Nitrogen"},xb:{number:8,name:"Oxygen"},ca:{number:8,name:"Oxygen"},Pa:{number:9,name:"Fluorine"},tb:{number:10,name:"Neon"},qb:{number:11,name:"Sodium"},lb:{number:12,name:"Magnesium"},ka:{number:13,name:"Aluminium"},Vb:{number:14,name:"Silicon"},
zb:{number:15,name:"Phosphorus"},Qb:{number:16,name:"Sulfur"},fa:{number:16,name:"Sulfur"},Ca:{number:17,name:"Chlorine"},ma:{number:18,name:"Argon"},eb:{number:19,name:"Potassium"},ya:{number:20,name:"Calcium"},Sb:{number:21,name:"Scandium"},dc:{number:22,name:"Titanium"},hc:{number:23,name:"Vanadium"},Ga:{number:24,name:"Chromium"},mb:{number:25,name:"Manganese"},Qa:{number:26,name:"Iron"},Fa:{number:27,name:"Cobalt"},ub:{number:28,name:"Nickel"},Ia:{number:29,name:"Copper"},mc:{number:30,name:"Zinc"},
Ta:{number:31,name:"Gallium"},Va:{number:32,name:"Germanium"},na:{number:33,name:"Arsenic"},W:{number:33,name:"Arsenic"},Tb:{number:34,name:"Selenium"},ga:{number:34,name:"Selenium"},wa:{number:35,name:"Bromine"},fb:{number:36,name:"Krypton"},Jb:{number:37,name:"Rubidium"},Yb:{number:38,name:"Strontium"},kc:{number:39,name:"Yttrium"},nc:{number:40,name:"Zirconium"},rb:{number:41,name:"Niobium"},nb:{number:42,name:"Molybdenum"},ac:{number:43,name:"Technetium"},Pb:{number:44,name:"Ruthenium"},Nb:{number:45,
name:"Rhodium"},Cb:{number:46,name:"Palladium"},ja:{number:47,name:"Silver"},za:{number:48,name:"Cadmium"},cb:{number:49,name:"Indium"},Xb:{number:50,name:"Tin"},Rb:{number:51,name:"Antimony"},bc:{number:52,name:"Tellurium"},bb:{number:53,name:"Iodine"},jc:{number:54,name:"Xenon"},Ha:{number:55,name:"Caesium"},ra:{number:56,name:"Barium"},gb:{number:57,name:"Lanthanum"},Aa:{number:58,name:"Cerium"},Fb:{number:59,name:"Praseodymium"},sb:{number:60,name:"Neodymium"},Db:{number:61,name:"Promethium"},
Wb:{number:62,name:"Samarium"},Oa:{number:63,name:"Europium"},Ua:{number:64,name:"Gadolinium"},$b:{number:65,name:"Terbium"},La:{number:66,name:"Dysprosium"},$a:{number:67,name:"Holmium"},Ma:{number:68,name:"Erbium"},fc:{number:69,name:"Thulium"},lc:{number:70,name:"Ytterbium"},jb:{number:71,name:"Lutetium"},Ya:{number:72,name:"Hafnium"},Zb:{number:73,name:"Tantalum"},ic:{number:74,name:"Tungsten"},Kb:{number:75,name:"Rhenium"},yb:{number:76,name:"Osmium"},db:{number:77,name:"Iridium"},Gb:{number:78,
name:"Platinum"},pa:{number:79,name:"Gold"},Za:{number:80,name:"Mercury"},ec:{number:81,name:"Thallium"},Bb:{number:82,name:"Lead"},ua:{number:83,name:"Bismuth"},Eb:{number:84,name:"Polonium"},oa:{number:85,name:"Astatine"},Ob:{number:86,name:"Radon"},Sa:{number:87,name:"Francium"},Ib:{number:88,name:"Radium"},ia:{number:89,name:"Actinium"},cc:{number:90,name:"Thorium"},Ab:{number:91,name:"Protactinium"},gc:{number:92,name:"Uranium"},wb:{number:93,name:"Neptunium"},Hb:{number:94,name:"Plutonium"},
la:{number:95,name:"Americium"},Da:{number:96,name:"Curium"},va:{number:97,name:"Berkelium"},Ba:{number:98,name:"Californium"},Na:{number:99,name:"Einsteinium"},Ra:{number:100,name:"Fermium"},kb:{number:101,name:"Mendelevium"},vb:{number:102,name:"Nobelium"},ib:{number:103,name:"Lawrencium"},Lb:{number:104,name:"Rutherfordium"},Ja:{number:105,name:"Dubnium"},Ub:{number:106,name:"Seaborgium"},ta:{number:107,name:"Bohrium"},ab:{number:108,name:"Hassium"},ob:{number:109,name:"Meitnerium"},Ka:{number:110,
name:"Darmstadtium"},Mb:{number:111,name:"Roentgenium"},Ea:{number:112,name:"Copernicium"}};function X(){this.a=[];this.b=[];this.pc=false}X.prototype.e=function(d){return A(this.a,d)};X.prototype.c=function(d){return this.a[d]};X.prototype.s=function(d){this.a.push(d)};X.prototype.o=function(d){d.source.M.push(d.target);d.target.M.push(d.source);this.b.push(d)};X.prototype.g=function(d,f){for(var e=0,g=this.b.length;e<g;e++){var j=this.b[e];if(d===j.source&&f===j.target||f===j.source&&d===j.target)return j}return null};function Y(){this.O=[];this.ha=0;this.M=[]}Y.prototype.C=function(d){var f=true;if(this.O.length)if(A(this.O,d.f)===-1)f=false;d=this.ha<=d.q();return f&&d};Y.prototype.v=function(){return this.M};function Ma(d,f){this.N=[];this.source=d;this.target=f}Ma.prototype.C=function(d){if(!this.N.length)return true;if(A(this.N,d.S)!==-1)return true;return false};function Z(){}t("kemia.query.MoleculeCompiler",Z,void 0);Z.prototype.compile=function(d){for(var f=new X,e=0,g=d.a.length;e<g;e++){var j=new Y;j.O.push(d.c(e).f);f.s(j)}e=0;for(g=d.q();e<g;e++){j=d.b[e];var h=f.c(d.e(j.source)),m=f.c(d.e(j.target));h=new Ma(h,m);h.N.push(j.S);f.o(h)}return f};t("kemia.query.MoleculeCompiler.prototype.compile",Z.prototype.compile,void 0);function $(){}t("kemia.query.SmilesCompiler",$,void 0);$.prototype.compile=function(d){d=Ja(d);return(new Z).compile(d)};t("kemia.query.SmilesCompiler.prototype.compile",$.prototype.compile,void 0);
