var a;
function w(d){var e=typeof d;if(e=="object")if(d){if(d instanceof Array||!(d instanceof Object)&&Object.prototype.toString.call(d)=="[object Array]"||typeof d.length=="number"&&typeof d.splice!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("splice"))return"array";if(!(d instanceof Object)&&(Object.prototype.toString.call(d)=="[object Function]"||typeof d.call!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("call")))return"function"}else return"null";else if(e==
"function"&&typeof d.call=="undefined")return"object";return e}function y(d){return typeof d=="string"}function aa(d){if(d.hasOwnProperty&&d.hasOwnProperty(z))return d[z];d[z]||(d[z]=++ba);return d[z]}var z="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),ba=0;var A,B,C={};
(function(){C=function(){this.a=[];this.b=[];this.Z=false};C.prototype.l=function(d){return D(this.a,d)};C.prototype.c=function(d){return this.a[d]};C.prototype.p=function(d){this.a.push(d)};C.prototype.n=function(d){d.source.B.push(d.target);d.target.B.push(d.source);this.b.push(d)};C.prototype.j=function(d,e){for(var f=0,g=this.b.length;f<g;f++){var m=this.b[f];if(d===m.source&&e===m.target||e===m.source&&d===m.target)return m}return null};A=function(){this.Q=[];this.na=0;this.B=[]};A.prototype.t=
function(){return this.B};B=function(d,e){this.P=[];this.source=d;this.target=e}})();var E=Array.prototype,D=E.indexOf?function(d,e,f){return E.indexOf.call(d,e,f)}:function(d,e,f){f=f==null?0:f<0?Math.max(0,d.length+f):f;if(y(d)){if(!y(e)||e.length!=1)return-1;return d.indexOf(e,f)}for(f=f;f<d.length;f++)if(f in d&&d[f]===e)return f;return-1},ca=E.map?function(d,e,f){return E.map.call(d,e,f)}:function(d,e,f){for(var g=d.length,m=new Array(g),h=y(d)?d.split(""):d,q=0;q<g;q++)if(q in h)m[q]=e.call(f,h[q],q,d);return m};function da(d,e,f){ea(d,f,0,e)}
function F(d,e){e=D(d,e);var f;if(f=e>=0)G(d,e);return f}function G(d,e){return E.splice.call(d,e,1).length==1}function ea(d){return E.splice.apply(d,fa(arguments,1))}function fa(d,e,f){return arguments.length<=2?E.slice.call(d,e):E.slice.call(d,e,f)}function ga(d,e){return d>e?1:d<e?-1:0}function H(d,e){for(var f=[],g=0;g<e;g++)f[g]=d;return f};function I(d){var e=[],f=0;for(var g in d)e[f++]=d[g];return e};function ha(d){if(typeof d.k=="function")return d.k();if(y(d))return d.split("");var e=w(d);if(e=="array"||e=="object"&&typeof d.length=="number"){e=[];for(var f=d.length,g=0;g<f;g++)e.push(d[g]);return e}return I(d)};function J(d){this.f={};this.d=[];var e=arguments.length;if(e>1){if(e%2)throw Error("Uneven number of arguments");for(var f=0;f<e;f+=2)K(this,arguments[f],arguments[f+1])}else d&&this.w(d)}a=J.prototype;a.o=0;a.K=0;a.A=function(){return this.o};a.k=function(){L(this);for(var d=[],e=0;e<this.d.length;e++)d.push(this.f[this.d[e]]);return d};a.remove=function(d){if(Object.prototype.hasOwnProperty.call(this.f,d)){delete this.f[d];this.o--;this.K++;this.d.length>2*this.o&&L(this);return true}return false};
function L(d){if(d.o!=d.d.length){for(var e=0,f=0;e<d.d.length;){var g=d.d[e];if(Object.prototype.hasOwnProperty.call(d.f,g))d.d[f++]=g;e++}d.d.length=f}if(d.o!=d.d.length){var m={};for(f=e=0;e<d.d.length;){g=d.d[e];if(!Object.prototype.hasOwnProperty.call(m,g)){d.d[f++]=g;m[g]=1}e++}d.d.length=f}}function K(d,e,f){if(!Object.prototype.hasOwnProperty.call(d.f,e)){d.o++;d.d.push(e);d.K++}d.f[e]=f}
J.prototype.w=function(d){var e;if(d instanceof J){L(d);e=d.d.concat();d=d.k()}else{e=[];var f=0;for(var g in d)e[f++]=g;e=e;d=I(d)}for(f=0;f<e.length;f++)K(this,e[f],d[f])};function M(d){this.f=new J;d&&this.w(d)}function N(d){var e=typeof d;return e=="object"&&d||e=="function"?"o"+aa(d):e.substr(0,1)+d}a=M.prototype;a.A=function(){return this.f.A()};a.add=function(d){K(this.f,N(d),d)};a.w=function(d){d=ha(d);for(var e=d.length,f=0;f<e;f++)this.add(d[f])};a.remove=function(d){return this.f.remove(N(d))};a.k=function(){return this.f.k()};function ia(d,e){this.a=d;this.b=e;for(var f=e=0,g=0,m=d.length;g<m;g++){e+=d[g].z.x;f+=d[g].z.y}this.ea=new O(e/d.length,f/d.length);this.M=new Array(3)};function P(d){this.i=[];this.a=[];for(var e=0,f=d.m();e<f;e++){bond=d.b[e];this.i.push(new Q([bond.source,bond.target]))}e=0;for(f=d.a.length;e<f;e++)this.a.push(d.c(e))}
P.prototype.remove=function(d,e){for(var f=[],g=0,m=this.i.length;g<m;g++){edge=this.i[g];if(R(edge))D(edge.a,d)>=0&&f.push(edge);else{var h=edge.a.length-1;if(edge.a[0]==d||edge.a[h]==d)f.push(edge)}}result=[];g=0;for(m=f.length;g<m;g++)R(f[g])&&result.push(f[g]);g=0;for(m=result.length;g<m;g++){D(f,result[g])>=0&&F(f,result[g]);D(this.i,result[g])>=0&&F(this.i,result[g])}g=[];m=0;for(h=f.length;m<h;m++)for(var q=m+1;q<h;q++){spliced=f[q].splice(f[m]);spliced!=null&&g.push(spliced)}newEdges=g;g=
0;for(m=f.length;g<m;g++)D(this.i,f[g])>=0&&F(this.i,f[g]);g=0;for(m=newEdges.length;g<m;g++)!(D(this.i,newEdges[g])>=0)&&newEdges[g].a.length<=e+1&&this.i.push(newEdges[g]);F(this.a,d);return result};function Q(d){this.a=d}function R(d){var e=d.a.length-1;return d.a.length>2&&d.a[0]==d.a[e]}
Q.prototype.splice=function(d){var e=d.a,f=this.a.length-1,g=e.length-1;if(this.a[f]==e[0]||this.a[f]==e[g])intersection=this.a[f];else if(this.a[0]==e[0]||this.a[0]==e[g])intersection=this.a[0];else throw"Couldn't splice - no intersection";newAtoms=[];e=0;for(f=this.a.length;e<f;e++)newAtoms.push(this.a[e]);this.a[0]==intersection&&newAtoms.reverse();if(d.a[0]==intersection){e=1;for(f=d.a.length;e<f;e++)newAtoms.push(d.a[e])}else for(e=d.a.length-2;e>=0;e--)newAtoms.push(d.a[e]);a:{d=1;for(e=newAtoms.length-
1;d<e;d++)for(f=1;f<e;f++)if(d!=f)if(newAtoms[d]==newAtoms[f]){d=false;break a}d=true}if(!d)return null;return new Q(newAtoms)};var S,T;
(function(){function d(h){for(var q=[],s=0,n=h.length;s<n;s++){var l=h[s];l instanceof Array?q.push(d(l)):q.push(l)}return q}function e(h,q,s){if(h.length)h.push(q[0].concat(s[0]));else h[0]=q[0].concat(s[0])}function f(h,q){return h.C-q.C}function g(h,q){for(var s=[],n=0,l=h.length;n<l;n++){var j=q.b[h[n]],p=q.l(j.source);j=q.l(j.target);D(s,p)>=0||s.push(p);D(s,j)>=0||s.push(j)}return s}function m(h,q){for(var s=[h[0]],n=q.c(h[0]),l=0;h.length!=s.length;){l++;if(l>1E3)break;for(var j=1,p=h.length;j<
p;j++){var o=q.c(s[s.length-1]),k=q.c(h[j]);if(!(D(s,h[j])>=0))if(q.j(o,k))s.push(h[j]);else q.j(n,k)&&da(s,h[j],0)}}return s}S=function(h,q,s,n){for(var l=0,j=q.length;l<j;l++){var p=q[l];if(h.length>=p.length){for(var o=true,k=0,t=p.length;k<t;k++)D(h,p[k])>=0||(o=false);if(o)return true}k=0;for(t=h.length;k<t;k++)D(p,h[k])>=0&&n[k]++}q=false;k=0;for(t=h.length;k<t;k++)if(n[h[k]]<s[h[k]]-1)q=true;if(q){k=0;for(t=h.length;k<t;k++)n[h[k]]++;return false}return true};T=function(h){var q=h.m()-h.a.length+
1;if(!q)return[];var s;s=h.a.length;for(var n=[],l=0;l<s;l++){for(var j=[],p=0;p<s;p++)if(l==p)j.push(0);else h.j(h.c(l),h.c(p))?j.push(1):j.push(99999999);n.push(j)}l=[];for(j=0;j<s;j++){p=[];for(var o=0;o<s;o++){var k=h.j(h.c(j),h.c(o));k?p.push([[D(h.b,k)]]):p.push([])}l.push(p)}j=[];for(p=0;p<s;p++){o=[];for(k=0;k<s;k++)o.push([]);j.push(o)}for(p=0;p<s;p++)for(o=0;o<s;o++)for(k=0;k<s;k++){var t=n[o][k],u=n[o][p]+n[p][k],v=l[o][p],x=l[p][k];if(u!=1E8)if(t>u){j[o][k]=t==u+1?d(l[o][k]):[];n[o][k]=
u;l[o][k]=[v[0].concat(x[0])]}else if(t==u)v.length&&x.length&&e(l[o][k],v,x);else if(t==u-1)e(j[o][k],v,x);else n[o][k]=n[o][k]}s={D:n,Pe1:l,Pe2:j};n=s.R;l=s.r;j=s.F;p=n.length;s=[];for(o=0;o<p;o++)for(k=0;k<p;k++)n[o][k]==0||l[o][k].length==1&&j[o][k].length==0||s.push({Cnum:j[o][k].length?2*(n[o][k]+0.5):2*n[o][k],Pe1:l[o][k],Pe2:j[o][k]});s.sort(f);a:{n=[];l=[];j=0;for(p=h.a.length;j<p;j++)l.push(h.c(j).m());o=H(0,h.a.length);j=0;for(p=s.length;j<p;j++){k=s[j];if(k.C%2){t=0;for(u=k.F.length;t<
u;t++){v=v=k.r[0].concat(k.F[t]);x=g(v,h);if(v.length===x.length)S(x,n,l,o)||n.push(x);if(n.length==q){q=n;break a}}}else{t=0;for(u=k.r.length-1;t<u;t++){v=v=k.r[t].concat(k.r[t+1]);x=g(v,h);if(v.length===x.length)S(x,n,l,o)||n.push(x);if(n.length==q){q=n;break a}}}}q=n}s=0;for(n=q.length;s<n;s++)q[s]=m(q[s],h);return q}})();var U={};
(function(){function d(e,f){for(var g=[],m=0,h=e.length;m<h;m++)g.push(f.c(e[m]));e=[];m=0;for(h=g.length-1;m<h;m++){bond=f.j(g[m],g[m+1]);bond!=null&&e.push(bond)}bond=f.j(g[0],g[g.length-1]);bond!=null&&e.push(bond);return new ia(g,e)}U={};U.X=function(e){if(!(e.m()-e.a.length+e.s))return[];for(var f=0,g=e.a.length;f<g;f++)e.a[f].index=f;f=0;for(g=e.b.length;f<g;f++)e.b[f].index=f;if(g=e.a.length){f=H(false,g);g=H(false,g);var m=[],h=e.a[0];h.h=0;m.push(h);for(f[0]=true;;){if(!m.length)break;h=
m[0];G(m,0);for(var q=h.b.k(),s=0,n=q.length;s<n;s++){var l=q[s],j=l.index;if(!g[j]){g[j]=true;var p=V(l,h);l=p.index;if(f[l]){l=[];if(h.h==p.h){l.push(h);l.push(p)}else{p.q=true;var o=p.t();j=0;for(var k=o.length;j<k;j++){var t=o[j];t.h==p.h-1&&l.push(t)}}for(p=h.h;;){l[0].q=true;l[1].q=true;p--;o=l[0].t();j=0;for(k=o.length;j<k;j++)if(o[j].h==p){l[0]=o[j];break}o=l[1].t();j=0;for(k=o.length;j<k;j++)if(o[j].h==p){l[1]=o[j];break}if(l[0]==l[1]){l[0].q=true;break}}}else{p.h=h.h+1;f[l]=true;m.push(p)}}}}}f=
[];h=e.a.length;g=H(false,h);m=H(false,h);h=H(-1,h);q=0;for(s=e.a.length;q<s;q++){l=e.a[q];if(!g[l.index])if(l.q){n=new W;k=[];k.push(l);g[0]=true;t=new X;t.u=l.index;h[l.index]=0;for(n.p(t);;){if(!k.length)break;p=k[0];G(k,0);o=p.b.k();l=0;for(j=o.length;l<j;l++){var u=o[l];t=u.index;if(!m[t]){m[t]=true;u=V(u,p);t=u.index;if(u.q){if(g[t]){t=e.j(p,u);var v=new Y(n.a[h[p.index]],n.a[h[u.index]]);v.u=t.index}else{g[t]=true;k.push(u);t=new X;t.u=u.index;h[u.index]=n.a.length;n.p(t);u=e.j(p,u);v=new Y(n.a[h[p.index]],
t);v.u=u.index}n.n(v)}}}}l=0;for(j=n.a.length;l<j;l++)n.a[l].index=l;l=0;for(j=n.b.length;l<j;l++)n.b[l].index=l;l=n.b.length-n.a.length+1;j=[];graph=new P(n);k=0;for(p=n.a.length;k<p;k++){o=graph.remove(n.c(k),6);for(t=0;t<o.length;t++){edge=o[t];atom_ring=edge.a;G(atom_ring,atom_ring.length-1);u=0;for(v=atom_ring.length;u<v;u++)atom_ring[u]=n.l(atom_ring[u]);j.push(atom_ring)}}E.sort.call(j,ga);if(j.length>=l){a:{k=[];p=[];o=0;for(t=n.a.length;o<t;o++)p.push(n.c(o).m());u=H(0,n.a.length);o=0;for(t=
j.length;o<t;o++){v=j[o];if(!S(v,k,p,u)){k.push(v);if(k.length==l){k=k;break a}}}k=k}if(k.length<l)k=T(n)}else k=T(n);l=0;for(j=k.length;l<j;l++){p=k[l];o=0;for(t=p.length;o<t;o++)p[o]=n.a[p[o]].u}l=0;for(n=k.length;l<n;l++)f.push(d(k[l],e))}}return f}})();function O(d,e){this.x=d!==undefined?d:0;this.y=e!==undefined?e:0}O.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function X(d,e,f,g,m,h){this.v=d;this.z=new O(e,f);this.b=new M;this.L=g!==undefined?g:0;this.N=h!==undefined?h:0;this.G=m!==undefined?m:false;this.Y=null;this.M=new Array(3)}X.prototype.m=function(){return this.b.A()};X.prototype.t=function(){for(var d=this.b.k(),e=[],f=0,g=d.length;f<g;f++)e.push(V(d[f],this));return e};function W(d){this.b=[];this.a=[];this.name=d?d:"";this.ka=[];this.$=true;this.e=[];this.s=0}a=W.prototype;a.n=function(d){var e=this.l(d.source),f=this.l(d.target);if(this.e[e]!=this.e[f]){var g;if(this.e[e]<this.e[f]){e=this.e[e];g=this.e[f]}else{g=this.e[e];e=this.e[f]}this.s--;f=0;for(var m=this.a.length;f<m;f++)if(this.e[f]==e)this.e[f]=g}this.b.push(d);d.source.b.add(d);d.target.b.add(d);d.I=this};a.c=function(d){return this.a[d]};
a.j=function(d,e){for(var f=d.b.k(),g=0,m=f.length;g<m;g++){var h=f[g];if(V(h,d)==e)return h}return null};a.l=function(d){return D(this.a,d)};a.m=function(){return this.b.length};a.p=function(d){var e=this.a.length;this.s++;this.e[e]=this.s;this.a.push(d);d.I=this};a.toString=function(){return ca(this.a,function(d){return d.v+d.index+d.z.toString()})};function Y(d,e,f,g,m,h){this.source=d;this.target=e;this.O=f!==undefined?f:ja;this.J=g!==undefined?g:ka;this.G=m!==undefined?m:false;this.I=h!==undefined?h:null}function V(d,e){if(e===d.source)return d.target;if(e===d.target)return d.source;return null}var ja=1,ka=10;function la(d){items=d.match(this.ja);for(var e=new W(d),f=0,g,m="NONE",h=[],q=[],s="",n=[],l=0;l<items.length;l++){var j=items[l];if(j!=this.g.aa)if(j==this.g.ba)h.push(g);else if(j==this.g.V)if(h.length)g=h.pop();else s=" unbalanced parens";else if(j==this.g.ia)m="-";else if(j==this.g.W)m="=";else if(j==this.g.ma)m="#";else if(j==this.g.da)m="$";else if(j==this.g.S)m=":";else if(j[0]==this.g.fa){ringid=parseInt(j[1]+j[2]);if(ring_atom=q[ringid]){e.n(this.H(m,g,ring_atom));m="NONE";q[ringid]=null}else q[ringid]=
g}else if(j!=this.g.U)if(j!=this.g.la)if(isNaN(ringid=parseInt(j))){smi_atom=this.ca(j,n);if(smi_atom.v){f+=1;j=new X(smi_atom.v,0,0,smi_atom.L,smi_atom.G,smi_atom.N);if(g){e.n(this.H(m,g,j));m="NONE"}e.p(j);if(smi_atom.J!="NONE"){n.push(e.l(j));n.push(smi_atom.J);n.push(smi_atom.T)}g=j}else s=" unknown atom "+j}else if(ring_atom=q[ringid]){e.n(this.H(m,g,ring_atom));m="NONE";q[ringid]=null}else q[ringid]=g;if(s)throw new Error(d+s);}this.ha(e,n);return this.ga(h,q,m)?e:null};var Z={};(function(){Z={};Z.compile=function(d){for(var e=new C,f=0,g=d.a.length;f<g;f++){var m=new A;m.Q.push(d.c(f).v);e.p(m)}f=0;for(g=d.m();f<g;f++){m=d.b[f];var h=e.c(d.l(m.source)),q=e.c(d.l(m.target));h=new B(h,q);h.P.push(m.O);e.n(h)}return e}})();var $={};(function(){$={};$.compile=function(d){d=la(d);return Z.compile(d)}})();
