function t(d){return function(){return this[d]}}var u=this;function w(d,f,e){d=d.split(".");e=e||u;!(d[0]in e)&&e.execScript&&e.execScript("var "+d[0]);for(var g;d.length&&(g=d.shift());)if(!d.length&&f!==undefined)e[g]=f;else e=e[g]?e[g]:(e[g]={})}
function aa(d){var f=typeof d;if(f=="object")if(d){if(d instanceof Array||!(d instanceof Object)&&Object.prototype.toString.call(d)=="[object Array]"||typeof d.length=="number"&&typeof d.splice!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("splice"))return"array";if(!(d instanceof Object)&&(Object.prototype.toString.call(d)=="[object Function]"||typeof d.call!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("call")))return"function"}else return"null";
else if(f=="function"&&typeof d.call=="undefined")return"object";return f}function x(d){var f=aa(d);return f=="array"||f=="object"&&typeof d.length=="number"}function y(d){return typeof d=="string"}function ba(d){if(d.hasOwnProperty&&d.hasOwnProperty(A))return d[A];d[A]||(d[A]=++ca);return d[A]}var A="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),ca=0;
function da(d,f){var e=f||u;if(arguments.length>2){var g=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(j,g);return d.apply(e,j)}}else return function(){return d.apply(e,arguments)}};var B=Array.prototype,C=B.indexOf?function(d,f,e){return B.indexOf.call(d,f,e)}:function(d,f,e){e=e==null?0:e<0?Math.max(0,d.length+e):e;if(y(d)){if(!y(f)||f.length!=1)return-1;return d.indexOf(f,e)}for(e=e;e<d.length;e++)if(e in d&&d[e]===f)return e;return-1},ea=B.forEach?function(d,f,e){B.forEach.call(d,f,e)}:function(d,f,e){for(var g=d.length,j=y(d)?d.split(""):d,h=0;h<g;h++)h in j&&f.call(e,j[h],h,d)},fa=B.map?function(d,f,e){return B.map.call(d,f,e)}:function(d,f,e){for(var g=d.length,j=new Array(g),
h=y(d)?d.split(""):d,m=0;m<g;m++)if(m in h)j[m]=f.call(e,h[m],m,d);return j};function ga(d,f,e,g){if(d.reduce)return g?d.reduce(da(f,g),e):d.reduce(f,e);var j=e;ea(d,function(h,m){j=f.call(g,j,h,m,d)});return j}function ha(d,f,e){ia(d,e,0,f)}function D(d,f){f=C(d,f);var e;if(e=f>=0)E(d,f);return e}function E(d,f){return B.splice.call(d,f,1).length==1}function ia(d){return B.splice.apply(d,ja(arguments,1))}function ja(d,f,e){return arguments.length<=2?B.slice.call(d,f):B.slice.call(d,f,e)}
function ka(d,f,e){if(!x(d)||!x(f)||d.length!=f.length)return false;var g=d.length;e=e||la;for(var j=0;j<g;j++)if(!e(d[j],f[j]))return false;return true}function ma(d,f){return d>f?1:d<f?-1:0}function la(d,f){return d===f}function F(d,f){for(var e=[],g=0;g<f;g++)e[g]=d;return e};function na(d){var f=[],e=0;for(var g in d)f[e++]=d[g];return f};function oa(d){if(typeof d.i=="function")return d.i();if(y(d))return d.split("");if(x(d)){for(var f=[],e=d.length,g=0;g<e;g++)f.push(d[g]);return f}return na(d)};function G(d){this.l={};this.e=[];var f=arguments.length;if(f>1){if(f%2)throw Error("Uneven number of arguments");for(var e=0;e<f;e+=2)H(this,arguments[e],arguments[e+1])}else d&&this.aa(d)}G.prototype.G=0;G.prototype.na=0;G.prototype.X=t("G");G.prototype.i=function(){I(this);for(var d=[],f=0;f<this.e.length;f++)d.push(this.l[this.e[f]]);return d};G.prototype.remove=function(d){if(Object.prototype.hasOwnProperty.call(this.l,d)){delete this.l[d];this.G--;this.na++;this.e.length>2*this.G&&I(this);return true}return false};
function I(d){if(d.G!=d.e.length){for(var f=0,e=0;f<d.e.length;){var g=d.e[f];if(Object.prototype.hasOwnProperty.call(d.l,g))d.e[e++]=g;f++}d.e.length=e}if(d.G!=d.e.length){var j={};for(e=f=0;f<d.e.length;){g=d.e[f];if(!Object.prototype.hasOwnProperty.call(j,g)){d.e[e++]=g;j[g]=1}f++}d.e.length=e}}function H(d,f,e){if(!Object.prototype.hasOwnProperty.call(d.l,f)){d.G++;d.e.push(f);d.na++}d.l[f]=e}
G.prototype.aa=function(d){var f;if(d instanceof G){I(d);f=d.e.concat();d=d.i()}else{f=[];var e=0;for(var g in d)f[e++]=g;f=f;d=na(d)}for(e=0;e<f.length;e++)H(this,f[e],d[e])};function J(d){this.l=new G;d&&this.aa(d)}function pa(d){var f=typeof d;return f=="object"&&d||f=="function"?"o"+ba(d):f.substr(0,1)+d}J.prototype.X=function(){return this.l.X()};J.prototype.add=function(d){H(this.l,pa(d),d)};J.prototype.aa=function(d){d=oa(d);for(var f=d.length,e=0;e<f;e++)this.add(d[e])};J.prototype.remove=function(d){return this.l.remove(pa(d))};J.prototype.i=function(){return this.l.i()};function qa(d,f){this.a=d;this.b=f;for(var e=f=0,g=0,j=d.length;g<j;g++){f+=d[g].ba.x;e+=d[g].ba.y}this.Aa=new K(f/d.length,e/d.length);this.oa=new Array(3)};function L(d){this.a=d}function ra(d){var f=d.a.length-1;return d.a.length>2&&d.a[0]==d.a[f]}
L.prototype.splice=function(d){var f;var e=d.a;f=this.a.length-1;var g=e.length-1;if(this.a[f]==e[0]||this.a[f]==e[g])f=this.a[f];else if(this.a[0]==e[0]||this.a[0]==e[g])f=this.a[0];else throw"Couldn't splice - no intersection";e=[];g=0;for(var j=this.a.length;g<j;g++)e.push(this.a[g]);this.a[0]==f&&e.reverse();if(d.a[0]==f){g=1;for(j=d.a.length;g<j;g++)e.push(d.a[g])}else for(g=d.a.length-2;g>=0;g--)e.push(d.a[g]);a:{d=1;for(f=e.length-1;d<f;d++)for(g=1;g<f;g++)if(d!=g)if(e[d]==e[g]){d=false;break a}d=
true}if(!d)return null;return new L(e)};function sa(d){this.r=[];this.a=[];for(var f=0,e=d.p();f<e;f++){bond=d.b[f];this.r.push(new L([bond.source,bond.target]))}f=0;for(e=d.a.length;f<e;f++)this.a.push(d.d(f))}
sa.prototype.remove=function(d,f){for(var e=[],g=0,j=this.r.length;g<j;g++){var h=this.r[g];if(ra(h))C(h.a,d)>=0&&e.push(h);else{var m=h.a.length-1;if(h.a[0]==d||h.a[m]==d)e.push(h)}}g=[];h=0;for(m=e.length;h<m;h++)ra(e[h])&&g.push(e[h]);h=0;for(m=g.length;h<m;h++){C(e,g[h])>=0&&D(e,g[h]);C(this.r,g[h])>=0&&D(this.r,g[h])}j=[];h=0;for(m=e.length;h<m;h++)for(var l=h+1;l<m;l++){var k=e[l].splice(e[h]);k!=null&&j.push(k)}h=0;for(m=e.length;h<m;h++)C(this.r,e[h])>=0&&D(this.r,e[h]);h=0;for(m=j.length;h<
m;h++)!(C(this.r,j[h])>=0)&&j[h].a.length<=f+1&&this.r.push(j[h]);D(this.a,d);return g};function ta(d){for(var f=[],e=0,g=d.length;e<g;e++){var j=d[e];j instanceof Array?f.push(ta(j)):f.push(j)}return f}function ua(d,f,e){if(d.length)d.push(f[0].concat(e[0]));else d[0]=f[0].concat(e[0])}function va(d,f){return d.Cnum-f.Cnum}
function M(d,f,e,g){for(var j=0,h=f.length;j<h;j++){var m=f[j];if(d.length>=m.length){for(var l=true,k=0,n=m.length;k<n;k++)C(d,m[k])>=0||(l=false);if(l)return true}k=0;for(n=d.length;k<n;k++)C(m,d[k])>=0&&g[k]++}f=false;k=0;for(n=d.length;k<n;k++)if(g[d[k]]<e[d[k]]-1)f=true;if(f){k=0;for(n=d.length;k<n;k++)g[d[k]]++;return false}return true}function wa(d,f){for(var e=[],g=0,j=d.length;g<j;g++){var h=f.b[d[g]],m=f.g(h.source);h=f.g(h.target);C(e,m)>=0||e.push(m);C(e,h)>=0||e.push(h)}return e}
function xa(d,f){for(var e=[d[0]],g=f.d(d[0]),j=0;d.length!=e.length;){j++;if(j>1E3)break;for(var h=1,m=d.length;h<m;h++){var l=f.d(e[e.length-1]),k=f.d(d[h]);if(!(C(e,d[h])>=0))if(f.h(l,k))e.push(d[h]);else f.h(g,k)&&ha(e,d[h],0)}}return e}
function N(d){var f=d.p()-d.a.length+1;if(!f)return[];var e;e=d.a.length;for(var g=[],j=0;j<e;j++){for(var h=[],m=0;m<e;m++)if(j==m)h.push(0);else d.h(d.d(j),d.d(m))?h.push(1):h.push(99999999);g.push(h)}j=[];for(h=0;h<e;h++){m=[];for(var l=0;l<e;l++){var k=d.h(d.d(h),d.d(l));k?m.push([[C(d.b,k)]]):m.push([])}j.push(m)}h=[];for(m=0;m<e;m++){l=[];for(k=0;k<e;k++)l.push([]);h.push(l)}for(m=0;m<e;m++)for(l=0;l<e;l++)for(k=0;k<e;k++){var n=g[l][k],q=g[l][m]+g[m][k],o=j[l][m],p=j[m][k];if(q!=1E8)if(n>q){h[l][k]=
n==q+1?ta(j[l][k]):[];g[l][k]=q;j[l][k]=[o[0].concat(p[0])]}else if(n==q)o.length&&p.length&&ua(j[l][k],o,p);else if(n==q-1)ua(h[l][k],o,p);else g[l][k]=g[l][k]}e={D:g,Pe1:j,Pe2:h};g=e.D;j=e.Pe1;h=e.Pe2;m=g.length;e=[];for(l=0;l<m;l++)for(k=0;k<m;k++)g[l][k]==0||j[l][k].length==1&&h[l][k].length==0||e.push({Cnum:h[l][k].length?2*(g[l][k]+0.5):2*g[l][k],Pe1:j[l][k],Pe2:h[l][k]});e.sort(va);a:{g=[];j=[];h=0;for(m=d.a.length;h<m;h++)j.push(d.d(h).p());l=[];for(h=0;h<d.a.length;h++)l[h]=0;h=0;for(m=e.length;h<
m;h++){k=e[h];if(k.Cnum%2){n=0;for(q=k.Pe2.length;n<q;n++){o=o=k.Pe1[0].concat(k.Pe2[n]);p=wa(o,d);if(o.length===p.length)M(p,g,j,l)||g.push(p);if(g.length==f){f=g;break a}}}else{n=0;for(q=k.Pe1.length-1;n<q;n++){o=o=k.Pe1[n].concat(k.Pe1[n+1]);p=wa(o,d);if(o.length===p.length)M(p,g,j,l)||g.push(p);if(g.length==f){f=g;break a}}}}f=g}e=0;for(g=f.length;e<g;e++)f[e]=xa(f[e],d);return f}w("kemia.ring.SSSR.findRings",N,void 0);function ya(d,f){for(var e=[],g=0,j=d.length;g<j;g++)e.push(f.d(d[g]));d=[];g=0;for(j=e.length-1;g<j;g++){var h=f.h(e[g],e[g+1]);h!=null&&d.push(h)}h=f.h(e[0],e[e.length-1]);h!=null&&d.push(h);return new qa(e,d)}
function za(d){if(!(d.p()-d.a.length+d.T))return[];for(var f=0,e=d.a.length;f<e;f++)d.a[f].index=f;f=0;for(e=d.b.length;f<e;f++)d.b[f].index=f;if(e=d.a.length){f=F(false,e);e=F(false,e);var g=[],j=d.a[0];j.q=0;g.push(j);for(f[0]=true;;){if(!g.length)break;j=g[0];E(g,0);for(var h=j.b.i(),m=0,l=h.length;m<l;m++){var k=h[m],n=k.index;if(!e[n]){e[n]=true;var q=P(k,j);k=q.index;if(f[k]){k=[];if(j.q==q.q){k.push(j);k.push(q)}else{q.Q=true;var o=q.J();n=0;for(var p=o.length;n<p;n++){var s=o[n];s.q==q.q-
1&&k.push(s)}}for(q=j.q;;){k[0].Q=true;k[1].Q=true;q--;o=k[0].J();n=0;for(p=o.length;n<p;n++)if(o[n].q==q){k[0]=o[n];break}o=k[1].J();n=0;for(p=o.length;n<p;n++)if(o[n].q==q){k[1]=o[n];break}if(k[0]==k[1]){k[0].Q=true;break}}}else{q.q=j.q+1;f[k]=true;g.push(q)}}}}}f=[];j=d.a.length;e=F(false,j);g=F(false,j);j=F(-1,j);h=0;for(m=d.a.length;h<m;h++){k=d.a[h];if(!e[k.index])if(k.Q){l=new Q;p=[];p.push(k);e[0]=true;s=new R;s.Z=k.index;j[k.index]=0;for(l.w(s);;){if(!p.length)break;q=p[0];E(p,0);o=q.b.i();
k=0;for(n=o.length;k<n;k++){var v=o[k];s=v.index;if(!g[s]){g[s]=true;v=P(v,q);s=v.index;if(v.Q){if(e[s]){s=d.h(q,v);var z=new S(l.a[j[q.index]],l.a[j[v.index]]);z.Z=s.index}else{e[s]=true;p.push(v);s=new R;s.Z=v.index;j[v.index]=l.a.length;l.w(s);v=d.h(q,v);z=new S(l.a[j[q.index]],s);z.Z=v.index}l.t(z)}}}}k=0;for(n=l.a.length;k<n;k++)l.a[k].index=k;k=0;for(n=l.b.length;k<n;k++)l.b[k].index=k;k=l.b.length-l.a.length+1;n=[];p=new sa(l);q=0;for(o=l.a.length;q<o;q++){s=p.remove(l.d(q),6);for(v=0;v<s.length;v++){z=
s[v].a;E(z,z.length-1);for(var O=0,Ga=z.length;O<Ga;O++)z[O]=z[O];n.push(z)}}B.sort.call(n,ma);if(n.length>=k){a:{p=[];q=[];o=0;for(s=l.a.length;o<s;o++)q.push(l.d(o).p());v=F(0,l.a.length);o=0;for(s=n.length;o<s;o++){z=n[o];if(!M(z,p,q,v)){p.push(z);if(p.length==k){p=p;break a}}}p=p}if(p.length<k)p=N(l)}else p=N(l);k=0;for(n=p.length;k<n;k++){q=p[k];o=0;for(s=q.length;o<s;o++)q[o]=l.a[q[o]].Z}k=0;for(l=p.length;k<l;k++)f.push(ya(p[k],d))}}return f}w("kemia.ring.RingFinder.findRings",za,void 0);var Aa={C:4,Si:4,N:3,P:3,O:2,S:2,H:1};function K(d,f){this.x=d!==undefined?d:0;this.y=f!==undefined?f:0}K.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function R(d,f,e,g,j,h){this.f=d!==undefined?d:"C";this.ba=new K(f!==undefined?f:0,e!==undefined?e:0);this.b=new J;this.z=g!==undefined?g:0;this.ca=h!==undefined?h:0;this.u=j!==undefined?j:false;this.ya=null;this.oa=new Array(3)}w("kemia.model.Atom",R,void 0);R.prototype.qa=t("f");w("kemia.model.Atom.prototype.getSymbol",R.prototype.qa,void 0);R.prototype.pa=t("z");w("kemia.model.Atom.prototype.getCharge",R.prototype.pa,void 0);R.prototype.p=function(){return this.b.X()};
R.prototype.sa=function(){var d=Aa[this.f],f=this.b.i();f=ga(f,function(g,j){return g+j.ea},0);var e=0;if(d)e=d-f+this.z;return e};w("kemia.model.Atom.prototype.hydrogenCount",R.prototype.sa,void 0);R.prototype.J=function(){for(var d=this.b.i(),f=[],e=0,g=d.length;e<g;e++)f.push(P(d[e],this));return f};function Q(d){this.b=[];this.a=[];this.name=d?d:"";this.$=[];this.ka=true;this.k=[];this.T=0}w("kemia.model.Molecule",Q,void 0);Q.prototype.t=function(d){var f=this.g(d.source),e=this.g(d.target);if(this.k[f]!=this.k[e]){var g;if(this.k[f]<this.k[e]){f=this.k[f];g=this.k[e]}else{g=this.k[f];f=this.k[e]}this.T--;e=0;for(var j=this.a.length;e<j;e++)if(this.k[e]==f)this.k[e]=g}this.b.push(d);d.source.b.add(d);d.target.b.add(d);d.ja=this};w("kemia.model.Molecule.prototype.addBond",Q.prototype.t,void 0);
Q.prototype.d=function(d){return this.a[d]};w("kemia.model.Molecule.prototype.getAtom",Q.prototype.d,void 0);Q.prototype.h=function(d,f){for(var e=d.b.i(),g=0,j=e.length;g<j;g++){var h=e[g];if(P(h,d)==f)return h}return null};Q.prototype.g=function(d){return C(this.a,d)};Q.prototype.ia=function(){return this.a.length};w("kemia.model.Molecule.prototype.countAtoms",Q.prototype.ia,void 0);Q.prototype.p=function(){return this.b.length};w("kemia.model.Molecule.prototype.countBonds",Q.prototype.p,void 0);
Q.prototype.w=function(d){var f=this.a.length;this.T++;this.k[f]=this.T;this.a.push(d);d.ja=this};w("kemia.model.Molecule.prototype.addAtom",Q.prototype.w,void 0);function Ba(d){if(d.ka){d.ka=false;d.$=za(d)}return d.$}Q.prototype.toString=function(){return fa(this.a,function(d){return d.f+d.index+d.ba.toString()}).toString()};function S(d,f,e,g,j,h){this.source=d;this.target=f;this.ea=e!==undefined?e:T;this.A=g!==undefined?g:Ca;this.u=j!==undefined?j:false;this.ja=h!==undefined?h:null}w("kemia.model.Bond",S,void 0);function P(d,f){if(f===d.source)return d.target;if(f===d.target)return d.source;return null}var T=1,Ca=10;var Da=3;Da=3;
function Ea(d,f,e,g){switch(d){case 1:switch(f){case 0:return new S(e,g);case 1:return new S(e,g,T,11);case 4:return new S(e,g,T,12);case 6:return new S(e,g,T,13);default:throw new Error("invalid bond type/stereo ["+d+"]/["+f+"]");}case 2:return new S(e,g,2);case Da:return new S(e,g,3);case 4:d=new S(e,g);d.u=true;return d;case 5:throw new Error("type not implemented ["+d+"]");case 6:throw new Error("type not implemented ["+d+"]");case 7:throw new Error("type not implemented ["+d+"]");case 8:throw new Error("type not implemented ["+
d+"]");default:throw new Error("invalid bond type/stereo ["+d+"]/["+f+"]");}}
function Fa(d){d=d.split(d.indexOf("\r\n")>0?"\r\n":"\n");for(var f=new Q(d[0]),e=parseInt(d[3].substr(0,3),10),g=parseInt(d[3].substr(3,3),10),j=1;j<=e;j++){var h=d[j+3],m=h.substr(30,4).replace(/(^\s*)|(\s*$)/g,""),l=parseFloat(h.substr(0,10)),k=parseFloat(h.substr(10,10));h=parseInt(h.substr(36,3),10);var n=0;if(h!=0)if(h==1)n=3;else if(h==2)n=2;else if(h==3)n=1;else if(h!=4)if(h==5)n=-1;else if(h==6)n=-2;else if(h==7)n=-3;h=new R(m,l,k,n);f.w(h)}for(j=1;j<=g;j++){h=d[j+3+e];n=f.d(parseInt(h.substr(0,
3),10)-1);m=f.d(parseInt(h.substr(3,3),10)-1);h=Ea(parseInt(h.substr(6,3),10),parseInt(h.substr(9,3),10),n,m);f.t(h)}j=4+e+g;e=d.length;for(g=false;;){h=d[j++];if(j==e||h.indexOf("M  END")>=0)break;if(h.indexOf("M  CHG")>=0){if(!g){n=0;for(g=f.a.length;n<g;n++)f.d(n).z=0;g=true}m=parseInt(h.substr(6,3),10);for(l=0;l<m;l++){k=parseInt(h.substr(10+8*l,3),10);n=parseInt(h.substr(14+8*l,3),10);f.d(k-1).z=n}}}return f}w("kemia.io.mdl.readMolfile",Fa,void 0);w("kemia.io.mdl.readMolfile",Fa,void 0);function Ha(d,f,e){this.type=d;this.j=f;this.L=e;this.$=Ba(e);this.v=[];this.M=[];this.m=[]};function U(d){this.j=d}w("kemia.query.DFSMapper",U,void 0);function Ia(d,f){if(d.v.length===d.j.a.length){for(var e=new G,g=0,j=d.v.length;g<j;g++)H(e,d.j.g(d.v[g]),d.L.g(d.M[g]));if(d.type===1){d=e.i();d.sort(function(l,k){return l-k});var h=true;g=0;for(j=f.length;g<j;g++){var m=f[g].i();m.sort(function(l,k){return l-k});if(ka(d,m))h=false}h&&f.push(e)}else f.push(e)}}
function V(d,f,e,g){for(var j=f.J(),h=e.J(),m=[],l=0,k=j.length;l<k;l++)for(var n=j[l],q=0,o=h.length;q<o;q++)m.push({wa:f,ma:n,va:e,la:h[q]});for(d.m.length?d.m.push(d.m[d.m.length-1].concat(m)):d.m.push(m);d.m[d.m.length-1].length;){f=d.m[d.m.length-1].pop();m=f.wa;h=f.va;e=f.ma;j=f.la;if(C(d.v,e)!==-1)e=false;else if(C(d.M,j)!==-1)e=false;else if(e.R(j,d.L,d.$)){m=d.j.h(m,e);h=d.L.h(h,j);if(m.R(h,d.L)){d.v.push(e);d.M.push(j);Ia(d,g);e=true}else e=false}else e=false;if(e){V(d,f.ma,f.la,g);d.v.pop();
d.M.pop();d.m.pop()}}}U.prototype.ua=function(d){for(var f=[],e=this.j.d(0),g=0,j=d.a.length;g<j;g++){var h=new Ha(1,this.j,d),m=d.d(g);if(e.R(m))if(this.j.a.length>1){h.v.push(e);h.M.push(m);V(h,e,m,f)}else{var l=new G;H(l,h.j.g(e),h.L.g(m));f.push(l)}}return f};w("kemia.query.DFSMapper.prototype.mapUnique",U.prototype.ua,void 0);G.prototype.getCount=G.prototype.X;
U.prototype.ta=function(d){for(var f=[],e=this.j.d(0),g=0,j=d.a.length;g<j;g++){var h=new Ha(0,this.j,d),m=d.d(g);if(e.R(m)){if(this.j.a.length>1){h.v.push(e);h.M.push(m);V(h,e,m,f)}else{d=new G;H(d,h.j.g(e),h.L.g(m));return d}if(f.length)return f[0]}}return new G};w("kemia.query.DFSMapper.prototype.mapFirst",U.prototype.ta,void 0);var Ja=new RegExp(/\[[^[]+\]|Br|B|Cl|C|N|F|O|P]|S|c|n|o|s|-|=|#|%[0-9][0-9]|[0-9]|\(|\)|./g),Ka=new RegExp(/^\[([0-9]*)([A-Z][a-z]?|c|n|o|se|s|as)(@|@@)?(H)?([0-9])?([+-][\d]?)?\]$/),La=["C","c","N","n","O","o","S","s","P","F","Br","Cl","I","B"],Ma=["c","n","o","s","as","se"];
function Na(d){for(var f=d.match(Ja),e=new Q(d),g=0,j,h="NONE",m=[],l=[],k="",n=[],q=0;q<f.length;q++){var o=f[q];if(o!=".")if(o=="(")m.push(j);else if(o==")")if(m.length)j=m.pop();else k=" unbalanced parens";else if(o=="-")h="-";else if(o=="=")h="=";else if(o=="#")h="#";else if(o=="$")h="$";else if(o==":")h=":";else if(o[0]=="%"){ringid=parseInt(o[1]+o[2],10);if(ring_atom=l[ringid]){e.t(W(h,j,ring_atom));h="NONE";l[ringid]=null}else l[ringid]=j}else if(o!="/")if(o!="\\")if(isNaN(ringid=parseInt(o,
10))){var p={ca:null,symbol:null,A:"NONE",ra:null,z:null,u:false,ha:false},s=Ka.exec(o);if(s){p.ca=s[1];if(Oa[s[2]])p.f=s[2];if(s[3]=="@"||s[3]=="@@"){p.A=s[3];if(s[4]=="H")p.ha=true}else p.A="NONE";if(s[4]=="H")p.ra=s[5]?s[5]:1;p.z=s[6]=="+"?1:s[6]=="-"?-1:parseInt(s[6],10)}else if(C(La,o)>=0)p.f=o;if(C(Ma,p.f)>=0){p.u=true;p.f=p.f.length==1?p.f.toUpperCase():p.f[0].toUpperCase()+p.f[1]}smi_atom=p;if(smi_atom.f){g+=1;o=new R(smi_atom.f,0,0,smi_atom.z,smi_atom.u,smi_atom.ca);if(j){e.t(W(h,j,o));h=
"NONE"}e.w(o);if(smi_atom.A!="NONE"){n.push(e.g(o));n.push(smi_atom.A);n.push(smi_atom.ha)}j=o}else k=" unknown atom "+o}else if(ring_atom=l[ringid]){e.t(W(h,j,ring_atom));h="NONE";l[ringid]=null}else l[ringid]=j;if(k)throw new Error(d+k);}Pa(e,n);if(m.length)throw new Error(smi+" unbalanced parens");for(d=0;d<l.length;++d)if(l[d])throw new Error(smi+" unclosed rings");if(h!="NONE")throw new Error(smi+" unpaired bond "+h);return e}w("kemia.io.smiles.SmilesParser.parse",Na,void 0);
function W(d,f,e){var g=d;if(d=="NONE")g=f.u&&e.u?":":"-";switch(g){case "-":return new S(f,e,T);case "=":return new S(f,e,2);case "#":return new S(f,e,3);case ":":d=new S(f,e);d.u=true;return d;case "~":default:throw new Error("invalid bond type/stereo ["+d+"]/["+stereo+"]");}}
function Pa(d,f){c=0;for(centers=f.length;c<centers;c++){var e=d.d(f[c]);if(e!=undefined){var g=f[++c];++c;var j=[],h=0,m=null;ea(d.a,function(k){bond_=d.h(e,k);if(bond_!=null&&bond_!=undefined){if(bond_.source!=e){bond_.source=e;bond_.target=k}h++;a:{k=bond_;rings=Ba(d);r=0;for(ringCount=rings.length;r<ringCount;r++){b=0;for(bondCount=rings[r].b.length;b<bondCount;b++)if(k==rings[r].b[b]){k=true;break a}}k=false}k||j.push(bond_)}});var l=j.length;if((h==3||h==4)&&l>0){bondidx=0;if(h==3&&l>1||h==
4&&l>2)bondidx=1;m=j[bondidx];m.A=g=="@"?11:13}if(h==4&&l>1){bondidx=1;if(l==4)bondidx=3;else if(l==4)bondidx=2;m=j[bondidx];m.A=g=="@"?13:11}}}}
var Oa={H:{number:1,name:"Hydrogen"},He:{number:2,name:"Helium"},Li:{number:3,name:"Lithium"},Be:{number:4,name:"Beryllium"},B:{number:5,name:"Boron"},C:{number:6,name:"Carbon"},c:{number:6,name:"Carbon"},N:{number:7,name:"Nitrogen"},n:{number:7,name:"Nitrogen"},O:{number:8,name:"Oxygen"},o:{number:8,name:"Oxygen"},F:{number:9,name:"Fluorine"},Ne:{number:10,name:"Neon"},Na:{number:11,name:"Sodium"},Mg:{number:12,name:"Magnesium"},Al:{number:13,name:"Aluminium"},Si:{number:14,name:"Silicon"},P:{number:15,
name:"Phosphorus"},S:{number:16,name:"Sulfur"},s:{number:16,name:"Sulfur"},Cl:{number:17,name:"Chlorine"},Ar:{number:18,name:"Argon"},K:{number:19,name:"Potassium"},Ca:{number:20,name:"Calcium"},Sc:{number:21,name:"Scandium"},Ti:{number:22,name:"Titanium"},V:{number:23,name:"Vanadium"},Cr:{number:24,name:"Chromium"},Mn:{number:25,name:"Manganese"},Fe:{number:26,name:"Iron"},Co:{number:27,name:"Cobalt"},Ni:{number:28,name:"Nickel"},Cu:{number:29,name:"Copper"},Zn:{number:30,name:"Zinc"},Ga:{number:31,
name:"Gallium"},Ge:{number:32,name:"Germanium"},As:{number:33,name:"Arsenic"},as:{number:33,name:"Arsenic"},Se:{number:34,name:"Selenium"},se:{number:34,name:"Selenium"},Br:{number:35,name:"Bromine"},Kr:{number:36,name:"Krypton"},Rb:{number:37,name:"Rubidium"},Sr:{number:38,name:"Strontium"},Y:{number:39,name:"Yttrium"},Zr:{number:40,name:"Zirconium"},Nb:{number:41,name:"Niobium"},Mo:{number:42,name:"Molybdenum"},Tc:{number:43,name:"Technetium"},Ru:{number:44,name:"Ruthenium"},Rh:{number:45,name:"Rhodium"},
Pd:{number:46,name:"Palladium"},Ag:{number:47,name:"Silver"},Cd:{number:48,name:"Cadmium"},In:{number:49,name:"Indium"},Sn:{number:50,name:"Tin"},Sb:{number:51,name:"Antimony"},Te:{number:52,name:"Tellurium"},I:{number:53,name:"Iodine"},Xe:{number:54,name:"Xenon"},Cs:{number:55,name:"Caesium"},Ba:{number:56,name:"Barium"},La:{number:57,name:"Lanthanum"},Ce:{number:58,name:"Cerium"},Pr:{number:59,name:"Praseodymium"},Nd:{number:60,name:"Neodymium"},Pm:{number:61,name:"Promethium"},Sm:{number:62,name:"Samarium"},
Eu:{number:63,name:"Europium"},Gd:{number:64,name:"Gadolinium"},Tb:{number:65,name:"Terbium"},Dy:{number:66,name:"Dysprosium"},Ho:{number:67,name:"Holmium"},Er:{number:68,name:"Erbium"},Tm:{number:69,name:"Thulium"},Yb:{number:70,name:"Ytterbium"},Lu:{number:71,name:"Lutetium"},Hf:{number:72,name:"Hafnium"},Ta:{number:73,name:"Tantalum"},W:{number:74,name:"Tungsten"},Re:{number:75,name:"Rhenium"},Os:{number:76,name:"Osmium"},Ir:{number:77,name:"Iridium"},Pt:{number:78,name:"Platinum"},Au:{number:79,
name:"Gold"},Hg:{number:80,name:"Mercury"},Tl:{number:81,name:"Thallium"},Pb:{number:82,name:"Lead"},Bi:{number:83,name:"Bismuth"},Po:{number:84,name:"Polonium"},At:{number:85,name:"Astatine"},Rn:{number:86,name:"Radon"},Fr:{number:87,name:"Francium"},Ra:{number:88,name:"Radium"},Ac:{number:89,name:"Actinium"},Th:{number:90,name:"Thorium"},Pa:{number:91,name:"Protactinium"},U:{number:92,name:"Uranium"},Np:{number:93,name:"Neptunium"},Pu:{number:94,name:"Plutonium"},Am:{number:95,name:"Americium"},
Cm:{number:96,name:"Curium"},Bk:{number:97,name:"Berkelium"},Cf:{number:98,name:"Californium"},Es:{number:99,name:"Einsteinium"},Fm:{number:100,name:"Fermium"},Md:{number:101,name:"Mendelevium"},No:{number:102,name:"Nobelium"},Lr:{number:103,name:"Lawrencium"},Rf:{number:104,name:"Rutherfordium"},Db:{number:105,name:"Dubnium"},Sg:{number:106,name:"Seaborgium"},Bh:{number:107,name:"Bohrium"},Hs:{number:108,name:"Hassium"},Mt:{number:109,name:"Meitnerium"},Ds:{number:110,name:"Darmstadtium"},Rg:{number:111,
name:"Roentgenium"},Cn:{number:112,name:"Copernicium"}};function X(){this.a=[];this.b=[];this.za=false}X.prototype.ia=function(){return this.a.length};X.prototype.g=function(d){return C(this.a,d)};X.prototype.d=function(d){return this.a[d]};X.prototype.w=function(d){this.a.push(d)};X.prototype.t=function(d){d.source.da.push(d.target);d.target.da.push(d.source);this.b.push(d)};X.prototype.h=function(d,f){for(var e=0,g=this.b.length;e<g;e++){var j=this.b[e];if(d===j.source&&f===j.target||f===j.source&&d===j.target)return j}return null};function Y(){this.ga=[];this.xa=0;this.da=[]}Y.prototype.R=function(d){var f=true;if(this.ga.length)if(C(this.ga,d.f)===-1)f=false;d=this.xa<=d.p();return f&&d};Y.prototype.J=t("da");function Qa(d,f){this.fa=[];this.source=d;this.target=f}Qa.prototype.R=function(d){if(!this.fa.length)return true;if(C(this.fa,d.ea)!==-1)return true;return false};function Z(){}w("kemia.query.MoleculeCompiler",Z,void 0);Z.prototype.compile=function(d){for(var f=new X,e=0,g=d.a.length;e<g;e++){var j=new Y;j.ga.push(d.d(e).f);f.w(j)}e=0;for(g=d.p();e<g;e++){j=d.b[e];var h=f.d(d.g(j.source)),m=f.d(d.g(j.target));h=new Qa(h,m);h.fa.push(j.ea);f.t(h)}return f};w("kemia.query.MoleculeCompiler.prototype.compile",Z.prototype.compile,void 0);function $(){}w("kemia.query.SmilesCompiler",$,void 0);$.prototype.compile=function(d){d=Na(d);return(new Z).compile(d)};w("kemia.query.SmilesCompiler.prototype.compile",$.prototype.compile,void 0);
