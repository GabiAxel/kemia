var q=this;function s(d,e,f){d=d.split(".");f=f||q;!(d[0]in f)&&f.execScript&&f.execScript("var "+d[0]);for(var g;d.length&&(g=d.shift());)if(!d.length&&e!==undefined)f[g]=e;else f=f[g]?f[g]:(f[g]={})}
function t(d){var e=typeof d;if(e=="object")if(d){if(d instanceof Array||!(d instanceof Object)&&Object.prototype.toString.call(d)=="[object Array]"||typeof d.length=="number"&&typeof d.splice!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("splice"))return"array";if(!(d instanceof Object)&&(Object.prototype.toString.call(d)=="[object Function]"||typeof d.call!="undefined"&&typeof d.propertyIsEnumerable!="undefined"&&!d.propertyIsEnumerable("call")))return"function"}else return"null";
else if(e=="function"&&typeof d.call=="undefined")return"object";return e}function u(d){var e=t(d);return e=="array"||e=="object"&&typeof d.length=="number"}function w(d){return typeof d=="string"}function x(d){if(d.hasOwnProperty&&d.hasOwnProperty(z))return d[z];d[z]||(d[z]=++A);return d[z]}var z="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),A=0;var B=Array.prototype,C=B.indexOf?function(d,e,f){return B.indexOf.call(d,e,f)}:function(d,e,f){f=f==null?0:f<0?Math.max(0,d.length+f):f;if(w(d)){if(!w(e)||e.length!=1)return-1;return d.indexOf(e,f)}for(f=f;f<d.length;f++)if(f in d&&d[f]===e)return f;return-1},D=B.forEach?function(d,e,f){B.forEach.call(d,e,f)}:function(d,e,f){for(var g=d.length,h=w(d)?d.split(""):d,j=0;j<g;j++)j in h&&e.call(f,h[j],j,d)},E=B.map?function(d,e,f){return B.map.call(d,e,f)}:function(d,e,f){for(var g=d.length,h=new Array(g),
j=w(d)?d.split(""):d,k=0;k<g;k++)if(k in j)h[k]=e.call(f,j[k],k,d);return h};function aa(d,e,f){if(!u(d)||!u(e)||d.length!=e.length)return false;var g=d.length;f=f||ba;for(var h=0;h<g;h++)if(!f(d[h],e[h]))return false;return true}function ba(d,e){return d===e};function F(d){var e=[],f=0;for(var g in d)e[f++]=d[g];return e};function ca(d){if(typeof d.j=="function")return d.j();if(w(d))return d.split("");if(u(d)){for(var e=[],f=d.length,g=0;g<f;g++)e.push(d[g]);return e}return F(d)};function G(d){this.k={};this.c=[];var e=arguments.length;if(e>1){if(e%2)throw Error("Uneven number of arguments");for(var f=0;f<e;f+=2)H(this,arguments[f],arguments[f+1])}else d&&this.A(d)}G.prototype.t=0;G.prototype.ba=0;G.prototype.w=function(){return this.t};G.prototype.j=function(){I(this);for(var d=[],e=0;e<this.c.length;e++)d.push(this.k[this.c[e]]);return d};
function I(d){if(d.t!=d.c.length){for(var e=0,f=0;e<d.c.length;){var g=d.c[e];if(Object.prototype.hasOwnProperty.call(d.k,g))d.c[f++]=g;e++}d.c.length=f}if(d.t!=d.c.length){var h={};for(f=e=0;e<d.c.length;){g=d.c[e];if(!Object.prototype.hasOwnProperty.call(h,g)){d.c[f++]=g;h[g]=1}e++}d.c.length=f}}function H(d,e,f){if(!Object.prototype.hasOwnProperty.call(d.k,e)){d.t++;d.c.push(e);d.ba++}d.k[e]=f}
G.prototype.A=function(d){var e;if(d instanceof G){I(d);e=d.c.concat();d=d.j()}else{e=[];var f=0;for(var g in d)e[f++]=g;e=e;d=F(d)}for(f=0;f<e.length;f++)H(this,e[f],d[f])};function J(d){this.k=new G;d&&this.A(d)}function da(d){var e=typeof d;return e=="object"&&d||e=="function"?"o"+x(d):e.substr(0,1)+d}J.prototype.w=function(){return this.k.w()};J.prototype.add=function(d){H(this.k,da(d),d)};J.prototype.A=function(d){d=ca(d);for(var e=d.length,f=0;f<e;f++)this.add(d[f])};J.prototype.j=function(){return this.k.j()};function ea(d){if(!(d.s()-d.a.length+d.v))return[];for(var e=0,f=d.a.length;e<f;e++)d.a[e].index=e;e=0;for(f=d.b.length;e<f;e++)d.b[e].index=e;detectRingAtoms(d);return createRingSystems(d)};function K(d,e,f){this.type=d;this.f=e;this.o=f;this.z=L(f);this.l=[];this.p=[];this.h=[]};function M(d){this.f=d}s("kemia.query.DFSMapper",M,void 0);function fa(d,e){if(d.l.length===d.f.a.length){for(var f=new G,g=0,h=d.l.length;g<h;g++)H(f,d.f.e(d.l[g]),d.o.e(d.p[g]));if(d.type===1){d=f.j();d.sort(function(l,n){return l-n});var j=true;g=0;for(h=e.length;g<h;g++){var k=e[g].j();k.sort(function(l,n){return l-n});if(aa(d,k))j=false}j&&e.push(f)}else e.push(f)}}
function N(d,e,f,g){for(var h=e.D(),j=f.D(),k=[],l=0,n=h.length;l<n;l++)for(var y=h[l],v=0,m=j.length;v<m;v++)k.push({Y:e,O:y,X:f,N:j[v]});for(d.h.length?d.h.push(d.h[d.h.length-1].concat(k)):d.h.push(k);d.h[d.h.length-1].length;){e=d.h[d.h.length-1].pop();k=e.Y;j=e.X;f=e.O;h=e.N;if(C(d.l,f)!==-1)f=false;else if(C(d.p,h)!==-1)f=false;else if(f.r(h,d.o,d.z)){k=d.f.u(k,f);j=d.o.u(j,h);if(k.r(j,d.o)){d.l.push(f);d.p.push(h);fa(d,g);f=true}else f=false}else f=false;if(f){N(d,e.O,e.N,g);d.l.pop();d.p.pop();
d.h.pop()}}}M.prototype.U=function(d){for(var e=[],f=this.f.i(0),g=0,h=d.a.length;g<h;g++){var j=new K(1,this.f,d),k=d.i(g);if(f.r(k))if(this.f.a.length>1){j.l.push(f);j.p.push(k);N(j,f,k,e)}else{var l=new G;H(l,j.f.e(f),j.o.e(k));e.push(l)}}return e};s("kemia.query.DFSMapper.prototype.mapUnique",M.prototype.U,void 0);G.prototype.getCount=G.prototype.w;
M.prototype.T=function(d){for(var e=[],f=this.f.i(0),g=0,h=d.a.length;g<h;g++){var j=new K(0,this.f,d),k=d.i(g);if(f.r(k)){if(this.f.a.length>1){j.l.push(f);j.p.push(k);N(j,f,k,e)}else{d=new G;H(d,j.f.e(f),j.o.e(k));return d}if(e.length)return e[0]}}return new G};s("kemia.query.DFSMapper.prototype.mapFirst",M.prototype.T,void 0);function O(d,e){this.x=d!==undefined?d:0;this.y=e!==undefined?e:0}O.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function P(d,e,f,g,h,j){this.d=symbol!==undefined?d:"C";this.R=new O(e!==undefined?e:0,f!==undefined?f:0);this.b=new J;this.C=g!==undefined?g:0;this.F=j!==undefined?j:0;this.m=h!==undefined?h:false;this.jc=null;this.ic=new Array(3)}P.prototype.s=function(){return this.b.w()};P.prototype.D=function(){for(var d=this.b.j(),e=[],f=0,g=d.length;f<g;f++)e.push(Q(d[f],this));return e};function R(d){this.b=[];this.a=[];this.name=d?d:"";this.z=[];this.L=true;this.g=[];this.v=0}R.prototype.q=function(d){var e=this.e(d.source),f=this.e(d.target);if(this.g[e]!=this.g[f]){var g;if(this.g[e]<this.g[f]){e=this.g[e];g=this.g[f]}else{g=this.g[e];e=this.g[f]}this.v--;f=0;for(var h=this.a.length;f<h;f++)if(this.g[f]==e)this.g[f]=g}this.b.push(d);d.source.b.add(d);d.target.b.add(d);d.K=this};R.prototype.i=function(d){return this.a[d]};
R.prototype.u=function(d,e){for(var f=d.b.j(),g=0,h=f.length;g<h;g++){var j=f[g];if(Q(j,d)==e)return j}return null};R.prototype.e=function(d){return C(this.a,d)};R.prototype.s=function(){return this.b.length};R.prototype.B=function(d){var e=this.a.length;this.v++;this.g[e]=this.v;this.a.push(d);d.K=this};function L(d){if(d.L){d.L=false;d.z=ea(d)}return d.z}R.prototype.toString=function(){return E(this.a,function(d){return d.d+d.index+d.R.toString()}).toString()};function S(d,e,f,g,h,j){this.source=d;this.target=e;this.M=f!==undefined?f:T;this.n=g!==undefined?g:ga;this.m=h!==undefined?h:false;this.K=j!==undefined?j:null}function Q(d,e){if(e===d.source)return d.target;if(e===d.target)return d.source;return null}var T=1,ga=10;var ha=new RegExp(/\[[^[]+\]|Br|B|Cl|C|N|F|O|P]|S|c|n|o|s|-|=|#|%[0-9][0-9]|[0-9]|\(|\)|./g),ia=new RegExp(/^\[([0-9]*)([A-Z][a-z]?|c|n|o|se|s|as)(@|@@)?(H)?([0-9])?([+-][\d]?)?\]$/),ja=["C","c","N","n","O","o","S","s","P","F","Br","Cl","I","B"],ka={Q:1,V:1,W:1,Z:1,P:1,$:1};
function U(d){for(var e=d.match(ha),f=new R(d),g=0,h,j="NONE",k=[],l=[],n="",y=[],v=0;v<e.length;v++){var m=e[v];if(m!=".")if(m=="(")k.push(h);else if(m==")")if(k.length)h=k.pop();else n=" unbalanced parens";else if(m=="-")j="-";else if(m=="=")j="=";else if(m=="#")j="#";else if(m=="$")j="$";else if(m==":")j=":";else if(m[0]=="%"){ringid=parseInt(m[1]+m[2],10);if(ring_atom=l[ringid]){f.q(V(j,h,ring_atom));j="NONE";l[ringid]=null}else l[ringid]=h}else if(m!="/")if(m!="\\")if(isNaN(ringid=parseInt(m,
10))){var o={F:null,d:null,n:"NONE",S:null,C:null,m:false,J:false},p=ia.exec(m);if(p){o.F=p[1];if(la[p[2]])o.d=p[2];if(p[3]=="@"||p[3]=="@@"){o.n=p[3];if(p[4]=="H")o.J=true}else o.n="NONE";if(p[4]=="H")o.S=p[5]?p[5]:1;o.C=p[6]=="+"?1:p[6]=="-"?-1:parseInt(p[6],10)}else if(C(ja,m)>=0)o.d=m;if(ka[o.d]){o.m=true;o.d=o.d.length==1?o.d.toUpperCase():o.d[0].toUpperCase()+o.d[1]}smi_atom=o;if(smi_atom.d){g+=1;m=new P(smi_atom.d,0,0,smi_atom.C,smi_atom.m,smi_atom.F);if(h){f.q(V(j,h,m));j="NONE"}f.B(m);if(smi_atom.n!=
"NONE"){y.push(f.e(m));y.push(smi_atom.n);y.push(smi_atom.J)}h=m}else n=" unknown atom "+m}else if(ring_atom=l[ringid]){f.q(V(j,h,ring_atom));j="NONE";l[ringid]=null}else l[ringid]=h;if(n)throw new Error(d+n);}ma(f,y);if(k.length)throw new Error(smi+" unbalanced parens");for(d=0;d<l.length;++d)if(l[d])throw new Error(smi+" unclosed rings");if(j!="NONE")throw new Error(smi+" unpaired bond "+j);return f}s("kemia.io.smiles.SmilesParser.parse",U,void 0);
function V(d,e,f){var g=d;if(d=="NONE")g=e.m&&f.m?":":"-";switch(g){case "-":return new S(e,f,T);case "=":return new S(e,f,2);case "#":return new S(e,f,3);case ":":d=new S(e,f);d.m=true;return d;case "~":default:throw new Error("invalid bond type/stereo ["+d+"]/["+stereo+"]");}}
function ma(d,e){c=0;for(centers=e.length;c<centers;c++){var f=d.i(e[c]);if(f!=undefined){var g=e[++c];++c;var h=[],j=0,k=null;D(d.a,function(n){bond_=d.u(f,n);if(bond_!=null&&bond_!=undefined){if(bond_.source!=f){bond_.source=f;bond_.target=n}j++;a:{n=bond_;rings=L(d);r=0;for(ringCount=rings.length;r<ringCount;r++){b=0;for(bondCount=rings[r].b.length;b<bondCount;b++)if(n==rings[r].b[b]){n=true;break a}}n=false}n||h.push(bond_)}});var l=h.length;if((j==3||j==4)&&l>0){bondidx=0;if(j==3&&l>1||j==4&&
l>2)bondidx=1;k=h[bondidx];k.n=g=="@"?11:13}if(j==4&&l>1){bondidx=1;if(l==4)bondidx=3;else if(l==4)bondidx=2;k=h[bondidx];k.n=g=="@"?13:11}}}}
var la={Qa:{number:1,name:"Hydrogen"},Ra:{number:2,name:"Helium"},bb:{number:3,name:"Lithium"},ma:{number:4,name:"Beryllium"},ka:{number:5,name:"Boron"},ra:{number:6,name:"Carbon"},Q:{number:6,name:"Carbon"},jb:{number:7,name:"Nitrogen"},V:{number:7,name:"Nitrogen"},rb:{number:8,name:"Oxygen"},W:{number:8,name:"Oxygen"},Ja:{number:9,name:"Fluorine"},nb:{number:10,name:"Neon"},kb:{number:11,name:"Sodium"},fb:{number:12,name:"Magnesium"},ea:{number:13,name:"Aluminium"},Pb:{number:14,name:"Silicon"},
tb:{number:15,name:"Phosphorus"},Kb:{number:16,name:"Sulfur"},Z:{number:16,name:"Sulfur"},wa:{number:17,name:"Chlorine"},ga:{number:18,name:"Argon"},Za:{number:19,name:"Potassium"},sa:{number:20,name:"Calcium"},Mb:{number:21,name:"Scandium"},Yb:{number:22,name:"Titanium"},bc:{number:23,name:"Vanadium"},Aa:{number:24,name:"Chromium"},gb:{number:25,name:"Manganese"},Ka:{number:26,name:"Iron"},za:{number:27,name:"Cobalt"},ob:{number:28,name:"Nickel"},Ca:{number:29,name:"Copper"},gc:{number:30,name:"Zinc"},
Na:{number:31,name:"Gallium"},Pa:{number:32,name:"Germanium"},ha:{number:33,name:"Arsenic"},P:{number:33,name:"Arsenic"},Nb:{number:34,name:"Selenium"},$:{number:34,name:"Selenium"},qa:{number:35,name:"Bromine"},$a:{number:36,name:"Krypton"},Db:{number:37,name:"Rubidium"},Sb:{number:38,name:"Strontium"},ec:{number:39,name:"Yttrium"},hc:{number:40,name:"Zirconium"},lb:{number:41,name:"Niobium"},hb:{number:42,name:"Molybdenum"},Vb:{number:43,name:"Technetium"},Jb:{number:44,name:"Ruthenium"},Hb:{number:45,
name:"Rhodium"},wb:{number:46,name:"Palladium"},da:{number:47,name:"Silver"},ta:{number:48,name:"Cadmium"},Xa:{number:49,name:"Indium"},Rb:{number:50,name:"Tin"},Lb:{number:51,name:"Antimony"},Wb:{number:52,name:"Tellurium"},Wa:{number:53,name:"Iodine"},dc:{number:54,name:"Xenon"},Ba:{number:55,name:"Caesium"},la:{number:56,name:"Barium"},ab:{number:57,name:"Lanthanum"},ua:{number:58,name:"Cerium"},zb:{number:59,name:"Praseodymium"},mb:{number:60,name:"Neodymium"},xb:{number:61,name:"Promethium"},
Qb:{number:62,name:"Samarium"},Ia:{number:63,name:"Europium"},Oa:{number:64,name:"Gadolinium"},Ub:{number:65,name:"Terbium"},Fa:{number:66,name:"Dysprosium"},Ua:{number:67,name:"Holmium"},Ga:{number:68,name:"Erbium"},$b:{number:69,name:"Thulium"},fc:{number:70,name:"Ytterbium"},db:{number:71,name:"Lutetium"},Sa:{number:72,name:"Hafnium"},Tb:{number:73,name:"Tantalum"},cc:{number:74,name:"Tungsten"},Eb:{number:75,name:"Rhenium"},sb:{number:76,name:"Osmium"},Ya:{number:77,name:"Iridium"},Ab:{number:78,
name:"Platinum"},ja:{number:79,name:"Gold"},Ta:{number:80,name:"Mercury"},Zb:{number:81,name:"Thallium"},vb:{number:82,name:"Lead"},oa:{number:83,name:"Bismuth"},yb:{number:84,name:"Polonium"},ia:{number:85,name:"Astatine"},Ib:{number:86,name:"Radon"},Ma:{number:87,name:"Francium"},Cb:{number:88,name:"Radium"},ca:{number:89,name:"Actinium"},Xb:{number:90,name:"Thorium"},ub:{number:91,name:"Protactinium"},ac:{number:92,name:"Uranium"},qb:{number:93,name:"Neptunium"},Bb:{number:94,name:"Plutonium"},
fa:{number:95,name:"Americium"},xa:{number:96,name:"Curium"},pa:{number:97,name:"Berkelium"},va:{number:98,name:"Californium"},Ha:{number:99,name:"Einsteinium"},La:{number:100,name:"Fermium"},eb:{number:101,name:"Mendelevium"},pb:{number:102,name:"Nobelium"},cb:{number:103,name:"Lawrencium"},Fb:{number:104,name:"Rutherfordium"},Da:{number:105,name:"Dubnium"},Ob:{number:106,name:"Seaborgium"},na:{number:107,name:"Bohrium"},Va:{number:108,name:"Hassium"},ib:{number:109,name:"Meitnerium"},Ea:{number:110,
name:"Darmstadtium"},Gb:{number:111,name:"Roentgenium"},ya:{number:112,name:"Copernicium"}};function W(){this.a=[];this.b=[];this.kc=false}W.prototype.e=function(d){return C(this.a,d)};W.prototype.i=function(d){return this.a[d]};W.prototype.B=function(d){this.a.push(d)};W.prototype.q=function(d){d.source.G.push(d.target);d.target.G.push(d.source);this.b.push(d)};W.prototype.u=function(d,e){for(var f=0,g=this.b.length;f<g;f++){var h=this.b[f];if(d===h.source&&e===h.target||e===h.source&&d===h.target)return h}return null};function X(){this.I=[];this.aa=0;this.G=[]}X.prototype.r=function(d){var e=true;if(this.I.length)if(C(this.I,d.d)===-1)e=false;d=this.aa<=d.s();return e&&d};X.prototype.D=function(){return this.G};function Y(d,e){this.H=[];this.source=d;this.target=e}Y.prototype.r=function(d){if(!this.H.length)return true;if(C(this.H,d.M)!==-1)return true;return false};function Z(){}s("kemia.query.MoleculeCompiler",Z,void 0);Z.prototype.compile=function(d){for(var e=new W,f=0,g=d.a.length;f<g;f++){var h=new X;h.I.push(d.i(f).d);e.B(h)}f=0;for(g=d.s();f<g;f++){h=d.b[f];var j=e.i(d.e(h.source)),k=e.i(d.e(h.target));j=new Y(j,k);j.H.push(h.M);e.q(j)}return e};s("kemia.query.MoleculeCompiler.prototype.compile",Z.prototype.compile,void 0);function $(){}s("kemia.query.SmilesCompiler",$,void 0);$.prototype.compile=function(d){d=U(d);return(new Z).compile(d)};s("kemia.query.SmilesCompiler.prototype.compile",$.prototype.compile,void 0);
